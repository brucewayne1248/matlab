\chapter{Modellierung des Doppelpendels}
\label{ch:modellbildung}



Die Grundlage für die nichtlineare Zustandsbeobachtung des inversen Doppelpendels bilden die dynamischen Bewegungsgleichungen des Systems, welche in diesem Kapitel hergeleitet werden. Die Differentialgleichungen werden mithilfe des Lagrange-Formalismus ermittelt. Dafür wird zunächst eine mechanische Modellierung des Systems vergenommen. \\\\
%
Der generelle Aufbau des inversen Doppelpendels mit den relevanten, physikalischen Größen kann Bild~\ref{fig:DPskizze} entnommen werden. Das mechatronische System besteht aus einem Wagen auf einer Linearführung, zwei miteinander gekoppelten Stäben sowie einem Motor, welcher das Drehmoment $ M_{\mathrm{Motor}} $ zum Ansteuern des Wagens liefert. Durch die Umsetzung des Motormoments resultiert eine Antriebskraft $ F_\mathrm{a} $ auf den Wagen sowie eine entgegengesetzte Reibkraft der Linearführung $ F_\mathrm{r} $. Beide Pendelstäbe sind rotatorisch miteinander gelagert, sodass sie Bewegungen nur in der $ x $-$ y $-Ebene durchführen können. Für die Modellierung werden die Winkellagen $ \varphi_i $, die Längen $ \ell_i $, die Gewichte $ m_i $, die Dämpfungskonstanten $ d_i $ sowie die Massenträgheitsmomente um den Schwerpunkt $ J^\mathrm{S}_i $ der Pendel benötigt.
Für die Anwendung des Lagrange-Formalismus~
%
\begin{equation}
	\label{eq:lagrange}
	\frac{	\mathrm{d}}{\mathrm{d}t} \frac{\partial L}{\partial \dot{\bm{q}}} - \frac{\partial L }{\partial \bm{q}} = \bm{Q}_\mathrm{n.k.}
\end{equation}

ist eine energetische Betrachtung des Systems nötig. In~\eqref{eq:lagrange} repräsentieren $ \bm{q} $ die generalisierten Koordinaten, $ \dot{\bm{q}} $ ihre zeitlichen Ableitungen und $ \bm{Q}_\mathrm{n.k.} $ auftretende nicht konservative Kräfte. Im vorliegenden Fall werden die generalisierten Koordinaten $ x(t) $, $ \varphi_1(t)$ und $ \varphi_2(t) $ verwendet, da diese Variablen den Freiheitsgraden des Systems entsprechen. Diese Größen hängen von der Zeit ab, jedoch wird aus Gründen der Übersichtlichkeit die Zeitabhängigkeit in diesem Kapitel vorausgesetzt und im Folgenden nicht explizit aufgeführt. Die Lagrange-Funktion~
%
\begin{equation}
	L = T- U
	\label{eq:lagrangeFunktion}
\end{equation}

setzt sich aus der kinetischen Energie $T$ und der potentiellen Energie $L$ des Systems zusammen. Die kinetische Energie 
\begin{figure}[!t]
	\centering{
		\resizebox{125mm}{!}{\input{skizzen/dp.pdf_tex}}
		\caption{Skizze des inversen Doppelpendels}
		\label{fig:DPskizze}
	}
\end{figure}
\begin{equation}
	\label{eq:energieKin}
	T = \frac{1}{2} \sum_{i = 0}^{3} m_{i} v_{i}^{2} 
	+ \frac{1}{2} \sum_{i = 1}^{2} J_{i}^{S} \varphi_{i}^2  
\end{equation}

besteht aus der translatorischen Bewegungsenergie der Schwerpunkte und der Rotationsenergie der Pendelstäbe. Die Trägheiten der Pendel werden über das Massenträgheitsmoment eines dünnen Stabes um den Schwerpunkt mit 
\begin{equation}
	J_{i}^{\mathrm{S}} = \frac{1}{12} m_{i} \ell_{i}^2
	\label{eq:massentraegheitsmoment}
\end{equation}

approximiert. Bei der Modellierung des Doppelpendels ist die Betrachtung von vier Schwerpunkten, die Bild~\ref{fig:DPskizze} zu entnehmen sind, notwendig. Neben den Schwerpunkten des Wagens und der beiden Pendel, die über die Indizes 0, 1 und 2 verfügen, ist noch das Verbindungsgelenk der Stäbe zu beachten. Das Gewicht des Gelenks ist so hoch, dass es bei der Modellierung berücksichtigt wird und nicht vernachlässigt werden kann. Das Gelenk wird als Punktmasse behandelt und mit dem Index 3 versehen. Damit werden die Positionen der Massen 
%
\begin{align*}
	x_0 &= x, &
	y_0 &= 0, \\
	x_1 &= x_0 - \tfrac{1}{2} \ell_1 \sin(\varphi_1), & 
	y_1 &= \tfrac{1}{2}\ell_1 \cos(\varphi_1), \\
	x_2 &= x_0 -\ell_1 \sin(\varphi_1) -\tfrac{1}{2}\ell_2\sin(\varphi_2), &
	y_2 &= \ell_1 \cos(\varphi_1) + \tfrac{1}{2}\ell_2\cos(\varphi_2), \\
	x_3 & =x_0-\ell_1\sin(\varphi_1),  &
	y_3 &= \ell_1\cos(\varphi_1) %\text{.} 
\end{align*}

bestimmt. Zur Ermittlung der Schwerpunktgeschwindigkeiten werden die zeitlichen Ableitungen
%
\begin{align*}
	\dot{x}_0 &= \dot{x}, &
	\dot{y}_0 &= 0, \\
	\dot{x}_1 &= \dot{x}_0 - \tfrac{1}{2} \ell_1 \cos(\varphi_1) \dot{\varphi}_1, &
	\dot{y}_1 &= -\tfrac{1}{2} \ell_1 \sin(\varphi_1) \dot{\varphi}_1, \\
	\dot{x}_2 &= \dot{x}_0 - \ell_1 \cos(\varphi_1) \dot{\varphi}_1 -\tfrac{1}{2}\ell_2\cos(\varphi_2) \dot{\varphi}_2, & \dot{y}_2 &= -\ell_1 \sin(\varphi_1) \dot{\varphi}_1 - \tfrac{1}{2} \ell_2 \sin(\varphi_2) \dot{\varphi}_2, \\ 
	\dot{x}_3 &= \dot{x}_0 - \ell_1\cos(\varphi_1) \dot{\varphi}_1, &
	\dot{y}_3 &= -\ell_1 \sin(\varphi_1) \dot{\varphi}_1
\end{align*}

berechnet. Die Ermittlung der Gesamtgeschwindigkeit in der $ x $-$ y $-Ebene unter Berücksichtigung von $ \dot{x}_0 = \dot{x} $ ist über eine Betragsbildung möglich und liefert
%
\begin{align*}
	v_0^2 &= \dot{x}_0^2 + \dot{y}_0^2 = \dot{x}^2, \\
	v_1^2 &= \dot{x}_1^2 + \dot{y}_1^2 = \dot{x}^2 -\ell_1\cos(\varphi_1) \dot{x}_1 \dot{\varphi}_1 
	+ \tfrac{1}{4} \ell_1^2 \dot{\varphi}_1^2, \\
	v_2^2 &= \dot{x}_2^2 + \dot{y}_2^2 \\
	&= \dot{x}^2 + \ell_1 \dot{\varphi}_1^2 + \tfrac{1}{4} \ell_2^2 \dot{\varphi}_2^2
	- 2 \dot{x}^2 \ell_1 \cos(\varphi_1) \dot{\varphi}_1 - \ell_2 \dot{x} \cos(\varphi_2) \dot{\varphi}_2
	+ \ell_1 \ell_2 \cos(\varphi_1-\varphi_2) \dot{\varphi}_1 \dot{\varphi}_2, \\
	v_3^2 &= \dot{x}_3^2 + \dot{y}_3^2 = \dot{x}^2 - 2 \ell_1 \cos(\varphi_1) \dot{x} \dot{\varphi}_1 + \ell_1^2 \dot{\varphi}_1 \text{.} 
\end{align*}

Somit ergibt sich die kinetische Energie des Systems gemäß~\eqref{eq:energieKin} zu
%
\begin{align}
	\label{eq:energieKinTotal}
	\begin{split}
	T &= \frac{1}{2} (m_0 v_0^2 + m_1 v_1^2 + m_2 v_2^2 + m_3 v_3^2+ J_1^\mathrm{S} \varphi_1^2 + J_2^\mathrm{S} \varphi_2^2)  \\
	&= \frac{1}{2} \Big( (m_0 + m_1 + m_2 + m_3) \dot{x}^2 + (\tfrac{1}{4} m_1 + m_2 + m_3) \ell_1^2 \dot{\varphi}_1^2  \\
	 &-(m_1 + 2m_2 + 2m_3 ) \ell_1 \dot{x} \cos(\varphi_1) \dot{\varphi}_1 
	+ m_2 (\tfrac{1}{4} \ell_2^2 \dot{\varphi}_2^2 - \ell_2 \dot{x} \cos(\varphi_2) \dot{\varphi}_2 )  \\
	&+ \ell_1 \ell_2 \cos(\varphi_1-\varphi_2)\dot{\varphi}_1\dot{\varphi}_2 + J_1^\mathrm{S} \dot{\varphi}_1^2
	+ J_2^\mathrm{S} \dot{\varphi}_2^2	\Big) \text{.}
	\end{split}
\end{align}

Die potentielle Energie des Systems lässt sich im vorliegenden Fall auf das Höhenpotential
\begin{equation}
\label{eq:energiePot}
U = g\sum_{i  = 0}^{3}  m_{i}  y_{i}  
\end{equation} 

beschränken. Das Nullniveau des Potentials wird auf die Höhe des Wagens  $ y_0 $ gelegt. Somit lautet die potentielle Energie 
\begin{equation}
\label{eq:energiePotTotal}
U = g \Big( (\tfrac{1}{2} m_1 + m_2 + m_3 ) \ell_1 \cos(\varphi_1) + \tfrac{1}{2} m_2 \ell_2 \cos(\varphi_2) \Big) \text{.}
\end{equation}

Mithilfe von~\eqref{eq:energieKinTotal} und~\eqref{eq:energiePotTotal} werden die Lagrange-Gleichungen 2. Art 
%
\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial L }{\partial \dot{x}} - \frac{\partial L }{\partial x} &= F_\mathrm{a} - F_\mathrm{r} 	\label{eq:lagrangeX}  \\
	\frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial L }{\partial \dot{\varphi}_1} - \frac{\partial L }{\partial \varphi_1} &= d_\mathrm{2} (\dot{\varphi}_2 - \dot{\varphi}_1) - d_\mathrm{1} \dot{\varphi}_1 \label{eq:lagrangePhi1} \\	
	\frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial L }{\partial \dot{\varphi}_2} - \frac{\partial L }{\partial \varphi_2} &= -d_\mathrm{2} (\dot{\varphi}_2 - \dot{\varphi}_1 ) \text{.} \label{eq:lagrangePhi2}
\end{align}

aufgestellt. Die nicht-konservativen Kräfte auf der rechten Seite der Gleichungen sind Kräfte, die sich nicht aus einem generalisierten Potential $ P(\bm{q},\bm{\dot{q}}) $ ableiten lassen können. Nicht-konservative Kräfte treten beim Energieaustausch des Systems mit der Umgebung auf. Im vorliegenden Fall sind die Antriebskraft des Motors, die Reibung zwischen der Linearführung und dem Wagen sowie die Dämpfungsterme der Pendellager Kräfte nicht-konservativer Natur. \\\\
%
In \cite{Behm2016} werden zwei Möglichkeiten zur Regelung und Steuerung des mechatronischen Systems aufgezeigt. Zum einen kann der Wagen momentengesteuert betrieben werden. Hierbei wird ein Wunschmoment $ M_\mathrm{soll} $ an den Motor übertragen. Bei der Umsetzung des Moments hat die Reibung zwischen dem Wagen und der Linearführung jedoch einen großen Einfluss auf die letztendlich resultierende Beschleunigung des Wagens. Um eine realitätsnahe Modellierung des Systems zu gewährleisten, wird eine Berücksichtigung der Reibung vorausgesetzt, wenn das Pendel momentengesteuert betrieben wird. 

Zum anderen ist es möglich, das Doppelpendel mittels Drehzahlvorgabe anzusteuern. Dabei setzt der Motor eine vorgegebene Sollgeschwindigkkeit $ v_\mathrm{soll} $ um. Dies hat den Vorteil, dass die Reibung des Systems vernachlässigt werden kann. Außerdem wird in \cite{Behm2016} aufgezeigt, dass bei der Regelung des realen, inversen Einfachpendels mit Drehzahlvorgabe deutlich bessere Regelungsergebnisse erzielt werden. In diesem Zusammenhang wird die Vermutung aufgestellt, dass aufgrund der hohen Reibung der Linearführung und des geringen Gewichts der realen Pendelstäbe keine Rückwirkung der Pendelbewegung auf die Wagenposition vorliegt. Diese Annahme wird verifiziert, indem die relative Auslenkung des Wagens während eines Ausschwingvorgangs des Doppelpendels gemessen wird. In Bild~\ref{fig:rueckwirkungpendelaufwagen} ist zu sehen, dass die maximale Auslenkung wenige Mikrometer beträgt, wodurch der Einfluss der Pendelbewegung auf die Wagenposition im Folgenden vernachlässigt werden kann. 

Aus den genannten Gründen wird die Wagenbeschleunigung $ \ddot{x} $ als Eingangsgröße des Systems gewählt. 
%
\begin{figure}[!b]
	\centering
	\input{plots/rueckwirkungpendelaufwagen.tex}
	\caption{Relative Wagenposition beim Ausschwingvorgang des Doppelpendels}
	\label{fig:rueckwirkungpendelaufwagen}
\end{figure}
%
Für die Ansteuerung des Motors, wird die Sollgeschwindigkeit durch eine einfache Integration der vorgegebenen Beschleunigung ermittelt. Dadurch ist die explizite Lösung von~\eqref{eq:lagrangeX}, die die Bewegungsgleichung des Wagens liefert, nicht mehr notwendig. Nach einer Bildung der Ableitungen der Lagrange-Funktion und Umformen von~\eqref{eq:lagrangePhi1} und~\eqref{eq:lagrangePhi2} lassen sich die Bewegungsgleichungen des inversen Doppelpendels aufstellen:
%
\begin{align}
	\ddot{x} = u \label{eq:ddx}
\end{align}
\vspace{-0.7cm}
\begin{align}
	\begin{split}
	\ddot{\varphi}_1 = &\frac{1}{J_1^\mathrm{S} + (\tfrac{1}{4} m_1 + m_2 + m_3) \ell_1^2 } \Big( d_\mathrm{2} (\dot{\varphi}_2 - \dot{\varphi}_1) - d_\mathrm{1} \dot{\varphi}_1  + (\tfrac{1}{2} m_1 + m_2 + m_3) \ell_1 \cos(\varphi_1) \ddot{x} \\
	&+ (\tfrac{1}{2} m_1 + m_2 + m_3) \ell_1 g \sin(\varphi_1) 
	- \tfrac{1}{2} m_2 \ell_1 \ell_2 ( \cos(\varphi_1 - \varphi_2) \ddot{\varphi_2} + \sin(\varphi_1 - \varphi_2) \dot{\varphi}_2^2  )   \Big)  	\label{eq:ddphi1}  
	\end{split}
\end{align}
%\vspace{-0.4cm}
\begin{align}
	\begin{split}
	\ddot{\varphi}_2 = \frac{1}{J_2^\mathrm{S} + \tfrac{1}{4} m_2 \ell_2^2 } \Big( 
	&- d_\mathrm{2} (\dot{\varphi}_2 - \dot{\varphi}_1)
	+ \tfrac{1}{2} m_2 \ell_2 \cos(\varphi_2) \ddot{x}
	+ \tfrac{1}{2} m_2 \ell_2 g \sin(\varphi_2) \\
	&+ \tfrac{1}{2} m_2 \ell_1 \ell_2 (\sin(\varphi_1 - \varphi_2) \dot{\varphi}_1^2 - \cos(\varphi_1-\varphi_2) \ddot{\varphi}_1  )
	\Big) \label{eq:ddphi2}
	\end{split}
\end{align} 

In den Gleichungen~\eqref{eq:ddphi1} und~\eqref{eq:ddphi2} ist zu sehen, dass Winkelbeschleunigungen jeweils noch voneinander abhängen. In der Bewegungsgleichung für den inneren Pendelstab $ \ddot{\varphi}_1 $ taucht die Winkelbeschleunigung $ \ddot{\varphi}_2 $ auf und umgekehrt. Das Ergebnis der einen Gleichung wird im selben Zeitschritt für die Auswertung der anderen Winkelbeschleunigung benötigt. Um dieses Problem zu umgehen, werden die Gleichungen entkoppelt. Die Gleichungen der Form
%
\begin{align}
	\ddot{\varphi}_1 &= f(\ddot{x}, \varphi_1, \dot{\varphi}_1, \varphi_2, \dot{\varphi}_2    ),	\label{eq:ddphi1Entkoppelt} \\
	\ddot{\varphi}_2 &= f(\ddot{x}, \varphi_1, \dot{\varphi}_1, \varphi_2, \dot{\varphi}_2    )	\label{eq:ddphi2Entkoppelt} 
\end{align}

werden für die Ermittlung der Pendelwinkelbeschleunigungen verwendet. Eine vollständige Darstellung  von~\eqref{eq:ddphi1Entkoppelt} und~\eqref{eq:ddphi2Entkoppelt} ist in Anhang~\ref{sec:nichtlinearediffgleichungen} vorzufinden. An dieser Stelle wird auf die in der Zustandsregelung und -beobachtung verwendeten Systemparameter verwiesen, die Tabelle~\ref{tab:parameter} zu entnehmen sind.
\begin{table}[!h]
	\caption{Gemessene und geschätzte Werte der Systemparameter}
	\centering
	\label{tab:parameter}
	\begin{tabu}{cll}
		\tabucline[2pt]{-}
		Variable & Wert & Beschreibung   \\ \hline
		$ l_1 $ & \SI{0,194}{\meter} & Länge des inneren Pendelstabs \\
		$ l_2 $ & \SI{0,1855}{\meter} & Länge des äußeren Pendelstabs  \\
		$ m_1 $ & \SI{0,0313}{\kg} & Masse des inneren Pendelstabs \\
		$ m_2 $ & \SI{0,0313}{\kg} & Masse des äußeren Pendelstabs \\
		$ m_3 $ & \SI{0,0308}{\kg} & Masse des Gelenks \\
		$ d_1, d_2 $ & \SI{0,001}{\kg\square\meter\per\second} & Dämpfungskonstanten der Pendelstäbe \\
		$ g $ & \SI{9,81}{\meter\per\square\second} &  Erdbeschleunigung \\\hline
	\end{tabu}
\end{table}
\newline \newline
Mithilfe der hergeleiteten Bewegungsgleichungen wird im folgenden Kapitel zunächst die Zustandsregelung des Doppelpendels in der oberen, instabilen Gleichgewichtslage untersucht. 
