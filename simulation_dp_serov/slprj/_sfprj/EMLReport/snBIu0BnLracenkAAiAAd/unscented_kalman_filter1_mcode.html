<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">x</span>, <span class="var type0" id="S3T0U4"><span class="message error" id="M1F1C">P_out</span></span>] = unscented_kalman_filter(<span class="var type1" id="S4T2U7">P</span>, <span class="var type1" id="S5T2U8">Q</span>, <span class="var type1" id="S6T3U9">R</span>, <span class="var type1" id="S7T1U10">x0</span>, <span class="var type1" id="S8T3U11">alpha_ukf</span>, <span class="var type1" id="S9T3U12">beta_ukf</span>, <span class="var type1" id="S10T3U13">kappa_ukf</span>, <span class="var type1" id="S11T4U14">para_sys</span>, <span class="var type1" id="S12T3U15">T</span>, <span class="var type1" id="S13T3U16">u</span>, <span class="var type1" id="S14T3U17">y</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Unscented Kalman Filter (UKF) fuer nichtlineare Systeme</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% Das UKF praediziert den Zustand eines nichtliniearen Systems durch</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Mittelung sog. Sigma Punkte. Dazu werden 2n+1 Sigmapunkte (moegliche</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Zustaende des Systems) mittels Kovarianzmatrix P berechnet und fuer jeden</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% Sigmapunkt mithilfe der Zustandsgleichung ein neuer Zustand praediziert.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% Diese werden gewichtet gemittelt und mit deren Hilfe die neuen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% Kovarianzmatrizen, die Rueckfuehrmatrix K und die Zustaende ermittelt.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% Weitere Infos unter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% http://www.agnld.uni-potsdam.de/~shw/TSA/Tools/UKF/node4.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% http://cslu.cse.ogi.edu/nsel/ukf/node6.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% Tipp: kappa meist zu 0 waehlen, alpha sehr klein bspw. 0.001, beta bei</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% Gaussverteilung = 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% -alpha bestimmt die Streuung der Sigma-Punkte um den Mittelwert</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% -beta wird benutzt, um Wissen ueber die Verteilung aufzunehmen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">% -kappa ist ein sekundaerer skalierender Parameter, der gewoehnlich </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% gleich 0 oder 3-n gesetzt wird</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% Vorlage von Matthias Dagen, September 2009, veraendert durch David</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% Klinkenbuss</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S15T1U19">x_p</span> <span class="var type1" id="S16T2U20">P_p</span> <span class="var type1" id="S17T5U21">x0_sig</span> <span class="var type1" id="S18T5U22">x_sig</span> <span class="var type1" id="S19T6U23">W_m</span> <span class="var type1" id="S20T6U24">W_c</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">% Parameter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo " id="T3:U19"><span class="var type1" id="S21T3U27">g</span> = <span class="mxinfo " id="T3:U21"><span class="var type1" id="S11T4U29">para_sys</span>(<span class="mxinfo " id="T3:U23">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo " id="T3:U24"><span class="var type1" id="S22T3U33">l_1</span> = <span class="mxinfo " id="T3:U26"><span class="var type1" id="S11T4U35">para_sys</span>(<span class="mxinfo " id="T7:U28">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo " id="T3:U29"><span class="var type1" id="S23T3U39">l_2</span> = <span class="mxinfo " id="T3:U31"><span class="var type1" id="S11T4U41">para_sys</span>(<span class="mxinfo " id="T7:U33">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo " id="T3:U34"><span class="var type1" id="S24T3U45">m_1</span> = <span class="mxinfo " id="T3:U36"><span class="var type1" id="S11T4U47">para_sys</span>(<span class="mxinfo " id="T3:U38">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T3:U39"><span class="var type1" id="S25T3U51">m_2</span> = <span class="mxinfo " id="T3:U41"><span class="var type1" id="S11T4U53">para_sys</span>(<span class="mxinfo " id="T7:U43">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo " id="T3:U44"><span class="var type1" id="S26T3U57">m_3</span> = <span class="mxinfo " id="T3:U46"><span class="var type1" id="S11T4U59">para_sys</span>(<span class="mxinfo " id="T3:U48">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T3:U49"><span class="var type1" id="S27T3U63">d_p1</span> = <span class="mxinfo " id="T3:U51"><span class="var type1" id="S11T4U65">para_sys</span>(<span class="mxinfo " id="T3:U53">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo " id="T3:U54"><span class="var type1" id="S28T3U69">d_p2</span> = <span class="mxinfo " id="T3:U56"><span class="var type1" id="S11T4U71">para_sys</span>(<span class="mxinfo " id="T3:U58">8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T3:U59"><span class="var type1" id="S29T3U75">n_ukf</span>  = <span class="mxinfo " id="T3:U61">4</span></span>;     <span class="comment">% Laenge von f(x)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo " id="T3:U62"><span class="var type1" id="S30T3U79">o_ukf</span> = <span class="mxinfo " id="T3:U64">1</span></span>;      <span class="comment">% Anzahl der zurueckgefuehrten Variablen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U65">isempty(<span class="var type0" id="S15T0U90">x_p</span>)</span> || <span class="mxinfo " id="T8:U66">isempty(<span class="var type0" id="S16T0U93">P_p</span>)</span> || <span class="mxinfo " id="T8:U67">isempty(<span class="var type0" id="S17T0U96">x0_sig</span>)</span> || <span class="mxinfo " id="T8:U68">isempty(<span class="var type0" id="S18T0U99">x_sig</span>)</span> || <span class="mxinfo " id="T8:U69">isempty(<span class="var type0" id="S19T0U102">W_m</span>)</span> || <span class="mxinfo " id="T8:U70">isempty(<span class="var type0" id="S20T0U105">W_c</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo " id="T1:U71"><span class="var type1" id="S15T1U108">x_p</span> = <span class="var type1" id="S7T1U109">x0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo " id="T2:U74"><span class="var type1" id="S16T2U112">P_p</span> = <span class="var type1" id="S4T2U113">P</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T5:U77"><span class="var type1" id="S17T5U116">x0_sig</span> = <span class="mxinfo " id="T5:U79">zeros(<span class="var type1" id="S29T3U119">n_ukf</span>,<span class="mxinfo " id="T3:U81">2*<span class="var type1" id="S29T3U123">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T5:U83"><span class="var type1" id="S18T5U127">x_sig</span>  = <span class="mxinfo " id="T5:U85">zeros(<span class="var type1" id="S29T3U130">n_ukf</span>,<span class="mxinfo " id="T3:U87">2*<span class="var type1" id="S29T3U134">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T6:U89"><span class="var type1" id="S19T6U138">W_m</span> = <span class="mxinfo " id="T6:U91">zeros(<span class="mxinfo " id="T3:U92">1</span>,<span class="mxinfo " id="T3:U93">2*<span class="var type1" id="S29T3U145">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T6:U95"><span class="var type1" id="S20T6U149">W_c</span> = <span class="mxinfo " id="T6:U97">zeros(<span class="mxinfo " id="T3:U98">1</span>,<span class="mxinfo " id="T3:U99">2*<span class="var type1" id="S29T3U156">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T1:U101"><span class="var type1" id="S2T1U160">x</span> = <span class="var type1" id="S15T1U161">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%% Parameter-Initialization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo " id="T3:U104"><span class="var type1" id="S33T3U165">lambda_ukf</span> = <span class="mxinfo " id="T3:U106"><span class="mxinfo " id="T3:U107">(<span class="mxinfo " id="T3:U108"><span class="var type1" id="S8T3U170">alpha_ukf</span>^2</span>)*(<span class="mxinfo " id="T3:U110"><span class="var type1" id="S29T3U174">n_ukf</span>+<span class="var type1" id="S10T3U175">kappa_ukf</span></span>)</span>-<span class="var type1" id="S29T3U176">n_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%% Weight calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo " id="T3:U114"><span class="mxinfo " id="T3:U115"><span class="var type1" id="S19T6U180">W_m</span>(<span class="mxinfo " id="T3:U117">1</span>,<span class="mxinfo " id="T3:U118">1</span>)</span> = <span class="mxinfo " id="T3:U119"><span class="var type1" id="S33T3U184">lambda_ukf</span>/(<span class="mxinfo " id="T3:U121"><span class="var type1" id="S29T3U187">n_ukf</span>+<span class="var type1" id="S33T3U188">lambda_ukf</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T3:U124"><span class="mxinfo " id="T3:U125"><span class="var type1" id="S20T6U192">W_c</span>(<span class="mxinfo " id="T3:U127">1</span>,<span class="mxinfo " id="T3:U128">1</span>)</span> = <span class="mxinfo " id="T3:U129"><span class="mxinfo " id="T3:U130"><span class="mxinfo " id="T3:U131"><span class="mxinfo " id="T3:U132"><span class="var type1" id="S33T3U199">lambda_ukf</span>/(<span class="mxinfo " id="T3:U134"><span class="var type1" id="S29T3U202">n_ukf</span>+<span class="var type1" id="S33T3U203">lambda_ukf</span></span>)</span>+<span class="mxinfo " id="T3:U137">1</span></span>-<span class="mxinfo " id="T3:U138"><span class="var type1" id="S8T3U206">alpha_ukf</span>^2</span></span>+<span class="var type1" id="S9T3U208">beta_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U211">i</span>=<span class="mxinfo " id="T4:U142"><span class="mxinfo " id="T3:U143">2</span>:2*<span class="var type1" id="S29T3U217">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo " id="T3:U145"><span class="mxinfo " id="T3:U146"><span class="var type1" id="S19T6U222">W_m</span>(<span class="mxinfo " id="T3:U148">1</span>,<span class="var type1" id="S34T3U224">i</span>)</span> = <span class="mxinfo " id="T3:U150"><span class="mxinfo " id="T3:U151">1</span>/(<span class="mxinfo " id="T3:U152"><span class="mxinfo " id="T3:U153">2</span>*(<span class="mxinfo " id="T3:U154"><span class="var type1" id="S29T3U232">n_ukf</span>+<span class="var type1" id="S33T3U233">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo " id="T3:U157"><span class="mxinfo " id="T3:U158"><span class="var type1" id="S20T6U237">W_c</span>(<span class="mxinfo " id="T3:U160">1</span>,<span class="var type1" id="S34T3U239">i</span>)</span> = <span class="mxinfo " id="T3:U162"><span class="mxinfo " id="T3:U163">1</span>/(<span class="mxinfo " id="T3:U164"><span class="mxinfo " id="T3:U165">2</span>*(<span class="mxinfo " id="T3:U166"><span class="var type1" id="S29T3U247">n_ukf</span>+<span class="var type1" id="S33T3U248">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%% 2n+1 Sigma Points calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo " id="T2:U169"><span class="var type1" id="S35T2U251">P_an</span> = <span class="mxinfo " id="T2:U171">(<span class="mxinfo " id="T2:U172"><span class="mxinfo " id="T3:U173">sqrt(<span class="mxinfo " id="T3:U174"><span class="var type1" id="S29T3U258">n_ukf</span>+<span class="var type1" id="S33T3U259">lambda_ukf</span></span>)</span>.*<span class="mxinfo " id="T2:U177">chol(<span class="var type1" id="S16T2U262">P_p</span>)</span></span>)'</span></span>; <span class="comment">% Wurzelmatrix mittels Cholesky-Zerlegung</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo " id="T1:U179"><span class="mxinfo " id="T1:U180"><span class="var type1" id="S17T5U266">x0_sig</span>(<span class="mxinfo " id="T9:U182">:</span>,<span class="mxinfo " id="T3:U183">1</span>)</span> = <span class="var type1" id="S15T1U269">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U272">i</span>=<span class="mxinfo " id="T1:U186"><span class="mxinfo " id="T3:U187">2</span>:<span class="var type1" id="S29T3U276">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    <span class="mxinfo " id="T1:U189"><span class="mxinfo " id="T1:U190"><span class="var type1" id="S17T5U281">x0_sig</span>(<span class="mxinfo " id="T9:U192">:</span>,<span class="var type1" id="S34T3U283">i</span>)</span>     = <span class="mxinfo " id="T1:U194"><span class="var type1" id="S15T1U285">x_p</span> + <span class="mxinfo " id="T1:U196"><span class="var type1" id="S35T2U287">P_an</span>(<span class="mxinfo " id="T9:U198">:</span>,<span class="mxinfo " id="T3:U199"><span class="var type1" id="S34T3U290">i</span>-<span class="mxinfo " id="T3:U201">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T1:U202"><span class="mxinfo " id="T1:U203"><span class="var type1" id="S17T5U295">x0_sig</span>(<span class="mxinfo " id="T9:U205">:</span>,<span class="mxinfo " id="T3:U206"><span class="var type1" id="S29T3U298">n_ukf</span>+<span class="var type1" id="S34T3U299">i</span></span>)</span>   = <span class="mxinfo " id="T1:U209"><span class="var type1" id="S15T1U301">x_p</span> - <span class="mxinfo " id="T1:U211"><span class="var type1" id="S35T2U303">P_an</span>(<span class="mxinfo " id="T9:U213">:</span>,<span class="mxinfo " id="T3:U214"><span class="var type1" id="S34T3U306">i</span>-<span class="mxinfo " id="T3:U216">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">%% Unscented Kalman filter time update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U310">i</span> = <span class="mxinfo " id="T10:U218"><span class="mxinfo " id="T3:U219">1</span>:(2*<span class="var type1" id="S29T3U317">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"> <span class="mxinfo " id="T3:U221"><span class="var type1" id="S38T3U321">x_1</span> = <span class="mxinfo " id="T3:U223"><span class="var type1" id="S17T5U323">x0_sig</span>(<span class="mxinfo " id="T7:U225">1</span>,<span class="var type1" id="S34T3U325">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"> <span class="mxinfo " id="T3:U227"><span class="var type1" id="S39T3U328">x_2</span> = <span class="mxinfo " id="T3:U229"><span class="var type1" id="S17T5U330">x0_sig</span>(<span class="mxinfo " id="T7:U231">2</span>,<span class="var type1" id="S34T3U332">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"> <span class="mxinfo " id="T3:U233"><span class="var type1" id="S40T3U335">x_3</span> = <span class="mxinfo " id="T3:U235"><span class="var type1" id="S17T5U337">x0_sig</span>(<span class="mxinfo " id="T7:U237">3</span>,<span class="var type1" id="S34T3U339">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"> <span class="mxinfo " id="T3:U239"><span class="var type1" id="S41T3U342">x_4</span> = <span class="mxinfo " id="T3:U241"><span class="var type1" id="S17T5U344">x0_sig</span>(<span class="mxinfo " id="T7:U243">4</span>,<span class="var type1" id="S34T3U346">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">  <span class="mxinfo " id="T3:U245"><span class="var type1" id="S42T3U349">t3</span> = <span class="mxinfo " id="T3:U247"><span class="var type1" id="S38T3U351">x_1</span>-<span class="var type1" id="S40T3U352">x_3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">  <span class="mxinfo " id="T3:U250"><span class="var type1" id="S43T3U355">t2</span> = <span class="mxinfo " id="T3:U252">cos(<span class="var type1" id="S42T3U358">t3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">  <span class="mxinfo " id="T3:U254"><span class="var type1" id="S45T3U361">t4</span> = <span class="mxinfo " id="T3:U256">cos(<span class="var type1" id="S38T3U364">x_1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">  <span class="mxinfo " id="T3:U258"><span class="var type1" id="S46T3U367">t5</span> = <span class="mxinfo " id="T3:U260">sin(<span class="var type1" id="S38T3U370">x_1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">  <span class="mxinfo " id="T3:U262"><span class="var type1" id="S48T3U373">t6</span> = <span class="mxinfo " id="T3:U264">sin(<span class="var type1" id="S42T3U376">t3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">  <span class="mxinfo " id="T3:U266"><span class="var type1" id="S49T3U379">t7</span> = <span class="mxinfo " id="T3:U268"><span class="var type1" id="S22T3U381">l_1</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">  <span class="mxinfo " id="T3:U270"><span class="var type1" id="S50T3U385">t8</span> = <span class="mxinfo " id="T3:U272"><span class="var type1" id="S39T3U387">x_2</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">  <span class="mxinfo " id="T3:U274"><span class="var type1" id="S51T3U391">t9</span> = <span class="mxinfo " id="T3:U276"><span class="var type1" id="S25T3U393">m_2</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">  <span class="mxinfo " id="T3:U278"><span class="var type1" id="S52T3U397">t10</span> = <span class="mxinfo " id="T3:U280">cos(<span class="var type1" id="S40T3U400">x_3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">  <span class="mxinfo " id="T3:U282"><span class="var type1" id="S53T3U403">t11</span> = <span class="mxinfo " id="T3:U284">sin(<span class="var type1" id="S40T3U406">x_3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">  <span class="mxinfo " id="T3:U286"><span class="var type1" id="S54T3U409">t12</span> = <span class="mxinfo " id="T3:U288"><span class="var type1" id="S23T3U411">l_2</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">  <span class="mxinfo " id="T3:U290"><span class="var type1" id="S55T3U415">t13</span> = <span class="mxinfo " id="T3:U292"><span class="var type1" id="S41T3U417">x_4</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">  <span class="mxinfo " id="T3:U294"><span class="var type1" id="S56T3U421">t14</span> = <span class="mxinfo " id="T3:U296"><span class="var type1" id="S38T3U423">x_1</span>*<span class="mxinfo " id="T3:U298">2.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">  <span class="mxinfo " id="T3:U299"><span class="var type1" id="S57T3U427">t15</span> = <span class="mxinfo " id="T3:U301"><span class="var type1" id="S56T3U429">t14</span>-<span class="mxinfo " id="T3:U303"><span class="var type1" id="S40T3U431">x_3</span>*<span class="mxinfo " id="T3:U305">2.0</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">  <span class="mxinfo " id="T3:U306"><span class="var type1" id="S58T3U435">t16</span> = <span class="mxinfo " id="T3:U308"><span class="var type1" id="S56T3U437">t14</span>-<span class="var type1" id="S40T3U438">x_3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">  <span class="mxinfo " id="T3:U311"><span class="var type1" id="S59T3U441">t17</span> = <span class="mxinfo " id="T3:U313">cos(<span class="var type1" id="S58T3U444">t16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">  <span class="mxinfo " id="T3:U315"><span class="var type1" id="S60T3U447">t18</span> = <span class="mxinfo " id="T3:U317">sin(<span class="var type1" id="S58T3U450">t16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">  <span class="mxinfo " id="T1:U319"><span class="var type1" id="S61T1U453">t1</span> = <span class="mxinfo " id="T1:U321">zeros(<span class="mxinfo " id="T3:U322">4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">  <span class="mxinfo " id="T3:U323"><span class="mxinfo " id="T3:U324"><span class="var type1" id="S61T1U461">t1</span>(<span class="mxinfo " id="T3:U326">1</span>,<span class="mxinfo " id="T3:U327">1</span>)</span> = <span class="mxinfo " id="T3:U328"><span class="var type1" id="S38T3U465">x_1</span>+<span class="mxinfo " id="T3:U330"><span class="var type1" id="S12T3U467">T</span>*<span class="var type1" id="S39T3U468">x_2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">  <span class="mxinfo " id="T3:U333"><span class="mxinfo " id="T3:U334"><span class="var type1" id="S61T1U472">t1</span>(<span class="mxinfo " id="T3:U336">2</span>,<span class="mxinfo " id="T3:U337">1</span>)</span> = <span class="mxinfo " id="T3:U338"><span class="var type1" id="S39T3U476">x_2</span>+<span class="mxinfo " id="T3:U340">(<span class="mxinfo " id="T3:U341"><span class="mxinfo " id="T3:U342"><span class="mxinfo " id="T3:U343"><span class="var type1" id="S12T3U482">T</span>*<span class="mxinfo " id="T3:U345">1.0</span></span>/<span class="mxinfo " id="T3:U346"><span class="var type1" id="S22T3U485">l_1</span>^2</span></span>*(<span class="mxinfo " id="T3:U348"><span class="mxinfo " id="T3:U349"><span class="mxinfo " id="T3:U350"><span class="mxinfo " id="T3:U351"><span class="mxinfo " id="T3:U352"><span class="mxinfo " id="T3:U353"><span class="mxinfo " id="T3:U354"><span class="mxinfo " id="T3:U355"><span class="mxinfo " id="T3:U356"><span class="mxinfo " id="T3:U357"><span class="mxinfo " id="T3:U358"><span class="mxinfo " id="T3:U359">-<span class="var type1" id="S43T3U500">t2</span></span>*(<span class="mxinfo " id="T3:U361"><span class="mxinfo " id="T3:U362"><span class="mxinfo " id="T3:U363"><span class="mxinfo " id="T3:U364"><span class="mxinfo " id="T3:U365"><span class="mxinfo " id="T3:U366"><span class="mxinfo " id="T3:U367"><span class="var type1" id="S28T3U509">d_p2</span>*<span class="var type1" id="S22T3U510">l_1</span></span>*<span class="var type1" id="S39T3U511">x_2</span></span>*<span class="mxinfo " id="T3:U371">1.8e1</span></span>-<span class="mxinfo " id="T3:U372"><span class="mxinfo " id="T3:U373"><span class="mxinfo " id="T3:U374"><span class="var type1" id="S28T3U516">d_p2</span>*<span class="var type1" id="S22T3U517">l_1</span></span>*<span class="var type1" id="S41T3U518">x_4</span></span>*<span class="mxinfo " id="T3:U378">1.8e1</span></span></span>+<span class="mxinfo " id="T3:U379"><span class="mxinfo " id="T3:U380"><span class="mxinfo " id="T3:U381"><span class="mxinfo " id="T3:U382"><span class="mxinfo " id="T3:U383"><span class="var type1" id="S21T3U525">g</span>*<span class="var type1" id="S22T3U526">l_1</span></span>*<span class="var type1" id="S23T3U527">l_2</span></span>*<span class="var type1" id="S25T3U528">m_2</span></span>*<span class="var type1" id="S53T3U529">t11</span></span>*<span class="mxinfo " id="T3:U389">9.0</span></span></span>+<span class="mxinfo " id="T3:U390"><span class="mxinfo " id="T3:U391"><span class="mxinfo " id="T3:U392"><span class="mxinfo " id="T3:U393"><span class="mxinfo " id="T3:U394"><span class="var type1" id="S22T3U536">l_1</span>*<span class="var type1" id="S23T3U537">l_2</span></span>*<span class="var type1" id="S25T3U538">m_2</span></span>*<span class="var type1" id="S52T3U539">t10</span></span>*<span class="var type1" id="S13T3U540">u</span></span>*<span class="mxinfo " id="T3:U400">9.0</span></span></span>+<span class="mxinfo " id="T3:U401"><span class="mxinfo " id="T3:U402"><span class="mxinfo " id="T3:U403"><span class="mxinfo " id="T3:U404"><span class="mxinfo " id="T3:U405"><span class="var type1" id="S23T3U547">l_2</span>*<span class="var type1" id="S25T3U548">m_2</span></span>*<span class="var type1" id="S48T3U549">t6</span></span>*<span class="var type1" id="S49T3U550">t7</span></span>*<span class="var type1" id="S50T3U551">t8</span></span>*<span class="mxinfo " id="T3:U411">9.0</span></span></span>)</span>-<span class="mxinfo " id="T3:U412"><span class="mxinfo " id="T3:U413"><span class="mxinfo " id="T3:U414"><span class="var type1" id="S27T3U556">d_p1</span>*<span class="var type1" id="S23T3U557">l_2</span></span>*<span class="var type1" id="S39T3U558">x_2</span></span>*<span class="mxinfo " id="T3:U418">1.2e1</span></span></span>-<span class="mxinfo " id="T3:U419"><span class="mxinfo " id="T3:U420"><span class="mxinfo " id="T3:U421"><span class="var type1" id="S28T3U563">d_p2</span>*<span class="var type1" id="S23T3U564">l_2</span></span>*<span class="var type1" id="S39T3U565">x_2</span></span>*<span class="mxinfo " id="T3:U425">1.2e1</span></span></span>+<span class="mxinfo " id="T3:U426"><span class="mxinfo " id="T3:U427"><span class="mxinfo " id="T3:U428"><span class="var type1" id="S28T3U570">d_p2</span>*<span class="var type1" id="S23T3U571">l_2</span></span>*<span class="var type1" id="S41T3U572">x_4</span></span>*<span class="mxinfo " id="T3:U432">1.2e1</span></span></span>+<span class="mxinfo " id="T3:U433"><span class="mxinfo " id="T3:U434"><span class="mxinfo " id="T3:U435"><span class="mxinfo " id="T3:U436"><span class="mxinfo " id="T3:U437"><span class="var type1" id="S21T3U579">g</span>*<span class="var type1" id="S22T3U580">l_1</span></span>*<span class="var type1" id="S23T3U581">l_2</span></span>*<span class="var type1" id="S24T3U582">m_1</span></span>*<span class="var type1" id="S46T3U583">t5</span></span>*<span class="mxinfo " id="T3:U443">6.0</span></span></span>+<span class="mxinfo " id="T3:U444"><span class="mxinfo " id="T3:U445"><span class="mxinfo " id="T3:U446"><span class="mxinfo " id="T3:U447"><span class="mxinfo " id="T3:U448"><span class="var type1" id="S21T3U590">g</span>*<span class="var type1" id="S22T3U591">l_1</span></span>*<span class="var type1" id="S23T3U592">l_2</span></span>*<span class="var type1" id="S25T3U593">m_2</span></span>*<span class="var type1" id="S46T3U594">t5</span></span>*<span class="mxinfo " id="T3:U454">1.2e1</span></span></span>+<span class="mxinfo " id="T3:U455"><span class="mxinfo " id="T3:U456"><span class="mxinfo " id="T3:U457"><span class="mxinfo " id="T3:U458"><span class="mxinfo " id="T3:U459"><span class="var type1" id="S21T3U601">g</span>*<span class="var type1" id="S22T3U602">l_1</span></span>*<span class="var type1" id="S23T3U603">l_2</span></span>*<span class="var type1" id="S26T3U604">m_3</span></span>*<span class="var type1" id="S46T3U605">t5</span></span>*<span class="mxinfo " id="T3:U465">1.2e1</span></span></span>+<span class="mxinfo " id="T3:U466"><span class="mxinfo " id="T3:U467"><span class="mxinfo " id="T3:U468"><span class="mxinfo " id="T3:U469"><span class="mxinfo " id="T3:U470"><span class="var type1" id="S22T3U612">l_1</span>*<span class="var type1" id="S23T3U613">l_2</span></span>*<span class="var type1" id="S24T3U614">m_1</span></span>*<span class="var type1" id="S45T3U615">t4</span></span>*<span class="var type1" id="S13T3U616">u</span></span>*<span class="mxinfo " id="T3:U476">6.0</span></span></span>+<span class="mxinfo " id="T3:U477"><span class="mxinfo " id="T3:U478"><span class="mxinfo " id="T3:U479"><span class="mxinfo " id="T3:U480"><span class="mxinfo " id="T3:U481"><span class="var type1" id="S22T3U623">l_1</span>*<span class="var type1" id="S23T3U624">l_2</span></span>*<span class="var type1" id="S25T3U625">m_2</span></span>*<span class="var type1" id="S45T3U626">t4</span></span>*<span class="var type1" id="S13T3U627">u</span></span>*<span class="mxinfo " id="T3:U487">1.2e1</span></span></span>+<span class="mxinfo " id="T3:U488"><span class="mxinfo " id="T3:U489"><span class="mxinfo " id="T3:U490"><span class="mxinfo " id="T3:U491"><span class="mxinfo " id="T3:U492"><span class="var type1" id="S22T3U634">l_1</span>*<span class="var type1" id="S23T3U635">l_2</span></span>*<span class="var type1" id="S26T3U636">m_3</span></span>*<span class="var type1" id="S45T3U637">t4</span></span>*<span class="var type1" id="S13T3U638">u</span></span>*<span class="mxinfo " id="T3:U498">1.2e1</span></span></span>-<span class="mxinfo " id="T3:U499"><span class="mxinfo " id="T3:U500"><span class="mxinfo " id="T3:U501"><span class="mxinfo " id="T3:U502"><span class="mxinfo " id="T3:U503"><span class="var type1" id="S22T3U645">l_1</span>*<span class="var type1" id="S25T3U646">m_2</span></span>*<span class="var type1" id="S48T3U647">t6</span></span>*<span class="var type1" id="S54T3U648">t12</span></span>*<span class="var type1" id="S55T3U649">t13</span></span>*<span class="mxinfo " id="T3:U509">6.0</span></span></span>)</span>)/(<span class="mxinfo " id="T3:U510"><span class="var type1" id="S23T3U653">l_2</span>*(<span class="mxinfo " id="T3:U512"><span class="mxinfo " id="T3:U513"><span class="mxinfo " id="T3:U514"><span class="mxinfo " id="T3:U515"><span class="var type1" id="S24T3U659">m_1</span>*<span class="mxinfo " id="T3:U517">4.0</span></span>+<span class="mxinfo " id="T3:U518"><span class="var type1" id="S25T3U662">m_2</span>*<span class="mxinfo " id="T3:U520">1.2e1</span></span></span>+<span class="mxinfo " id="T3:U521"><span class="var type1" id="S26T3U665">m_3</span>*<span class="mxinfo " id="T3:U523">1.2e1</span></span></span>-<span class="mxinfo " id="T3:U524"><span class="mxinfo " id="T3:U525"><span class="var type1" id="S25T3U669">m_2</span>*<span class="mxinfo " id="T3:U527"><span class="var type1" id="S43T3U671">t2</span>^2</span></span>*<span class="mxinfo " id="T3:U529">9.0</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">  <span class="mxinfo " id="T3:U530"><span class="mxinfo " id="T3:U531"><span class="var type1" id="S61T1U677">t1</span>(<span class="mxinfo " id="T3:U533">3</span>,<span class="mxinfo " id="T3:U534">1</span>)</span> = <span class="mxinfo " id="T3:U535"><span class="var type1" id="S40T3U681">x_3</span>+<span class="mxinfo " id="T3:U537"><span class="var type1" id="S12T3U683">T</span>*<span class="var type1" id="S41T3U684">x_4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">  <span class="mxinfo " id="T3:U540"><span class="mxinfo " id="T3:U541"><span class="var type1" id="S61T1U688">t1</span>(<span class="mxinfo " id="T3:U543">4</span>,<span class="mxinfo " id="T3:U544">1</span>)</span> = <span class="mxinfo " id="T3:U545"><span class="var type1" id="S41T3U692">x_4</span>+<span class="mxinfo " id="T3:U547">(<span class="mxinfo " id="T3:U548"><span class="mxinfo " id="T3:U549"><span class="mxinfo " id="T3:U550"><span class="var type1" id="S12T3U698">T</span>*<span class="mxinfo " id="T3:U552">1.0</span></span>/<span class="mxinfo " id="T3:U553"><span class="var type1" id="S23T3U701">l_2</span>^2</span></span>*(<span class="mxinfo " id="T3:U555"><span class="mxinfo " id="T3:U556"><span class="mxinfo " id="T3:U557"><span class="mxinfo " id="T3:U558"><span class="mxinfo " id="T3:U559"><span class="mxinfo " id="T3:U560"><span class="mxinfo " id="T3:U561"><span class="mxinfo " id="T3:U562"><span class="mxinfo " id="T3:U563"><span class="mxinfo " id="T3:U564"><span class="mxinfo " id="T3:U565"><span class="mxinfo " id="T3:U566"><span class="mxinfo " id="T3:U567"><span class="mxinfo " id="T3:U568"><span class="mxinfo " id="T3:U569"><span class="mxinfo " id="T3:U570"><span class="mxinfo " id="T3:U571"><span class="mxinfo " id="T3:U572"><span class="mxinfo " id="T3:U573"><span class="mxinfo " id="T3:U574"><span class="mxinfo " id="T3:U575"><span class="mxinfo " id="T3:U576"><span class="mxinfo " id="T3:U577"><span class="var type1" id="S48T3U727">t6</span>*(<span class="mxinfo " id="T3:U579"><span class="mxinfo " id="T3:U580"><span class="mxinfo " id="T3:U581"><span class="mxinfo " id="T3:U582"><span class="mxinfo " id="T3:U583"><span class="mxinfo " id="T3:U584"><span class="var type1" id="S23T3U735">l_2</span>*<span class="var type1" id="S49T3U736">t7</span></span>*<span class="var type1" id="S50T3U737">t8</span></span>*<span class="var type1" id="S51T3U738">t9</span></span>*<span class="mxinfo " id="T3:U589">3.6e1</span></span>+<span class="mxinfo " id="T3:U590"><span class="mxinfo " id="T3:U591"><span class="mxinfo " id="T3:U592"><span class="mxinfo " id="T3:U593"><span class="mxinfo " id="T3:U594"><span class="var type1" id="S23T3U745">l_2</span>*<span class="var type1" id="S24T3U746">m_1</span></span>*<span class="var type1" id="S25T3U747">m_2</span></span>*<span class="var type1" id="S49T3U748">t7</span></span>*<span class="var type1" id="S50T3U749">t8</span></span>*<span class="mxinfo " id="T3:U600">1.2e1</span></span></span>+<span class="mxinfo " id="T3:U601"><span class="mxinfo " id="T3:U602"><span class="mxinfo " id="T3:U603"><span class="mxinfo " id="T3:U604"><span class="mxinfo " id="T3:U605"><span class="var type1" id="S23T3U756">l_2</span>*<span class="var type1" id="S25T3U757">m_2</span></span>*<span class="var type1" id="S26T3U758">m_3</span></span>*<span class="var type1" id="S49T3U759">t7</span></span>*<span class="var type1" id="S50T3U760">t8</span></span>*<span class="mxinfo " id="T3:U611">3.6e1</span></span></span>)</span>+<span class="mxinfo " id="T3:U612"><span class="mxinfo " id="T3:U613"><span class="mxinfo " id="T3:U614"><span class="mxinfo " id="T3:U615"><span class="var type1" id="S28T3U766">d_p2</span>*<span class="var type1" id="S22T3U767">l_1</span></span>*<span class="var type1" id="S24T3U768">m_1</span></span>*<span class="var type1" id="S39T3U769">x_2</span></span>*<span class="mxinfo " id="T3:U620">2.4e1</span></span></span>+<span class="mxinfo " id="T3:U621"><span class="mxinfo " id="T3:U622"><span class="mxinfo " id="T3:U623"><span class="mxinfo " id="T3:U624"><span class="var type1" id="S28T3U775">d_p2</span>*<span class="var type1" id="S22T3U776">l_1</span></span>*<span class="var type1" id="S25T3U777">m_2</span></span>*<span class="var type1" id="S39T3U778">x_2</span></span>*<span class="mxinfo " id="T3:U629">7.2e1</span></span></span>-<span class="mxinfo " id="T3:U630"><span class="mxinfo " id="T3:U631"><span class="mxinfo " id="T3:U632"><span class="mxinfo " id="T3:U633"><span class="var type1" id="S28T3U784">d_p2</span>*<span class="var type1" id="S22T3U785">l_1</span></span>*<span class="var type1" id="S24T3U786">m_1</span></span>*<span class="var type1" id="S41T3U787">x_4</span></span>*<span class="mxinfo " id="T3:U638">2.4e1</span></span></span>+<span class="mxinfo " id="T3:U639"><span class="mxinfo " id="T3:U640"><span class="mxinfo " id="T3:U641"><span class="mxinfo " id="T3:U642"><span class="var type1" id="S28T3U793">d_p2</span>*<span class="var type1" id="S22T3U794">l_1</span></span>*<span class="var type1" id="S26T3U795">m_3</span></span>*<span class="var type1" id="S39T3U796">x_2</span></span>*<span class="mxinfo " id="T3:U647">7.2e1</span></span></span>-<span class="mxinfo " id="T3:U648"><span class="mxinfo " id="T3:U649"><span class="mxinfo " id="T3:U650"><span class="mxinfo " id="T3:U651"><span class="var type1" id="S28T3U802">d_p2</span>*<span class="var type1" id="S22T3U803">l_1</span></span>*<span class="var type1" id="S25T3U804">m_2</span></span>*<span class="var type1" id="S41T3U805">x_4</span></span>*<span class="mxinfo " id="T3:U656">7.2e1</span></span></span>-<span class="mxinfo " id="T3:U657"><span class="mxinfo " id="T3:U658"><span class="mxinfo " id="T3:U659"><span class="mxinfo " id="T3:U660"><span class="var type1" id="S28T3U811">d_p2</span>*<span class="var type1" id="S22T3U812">l_1</span></span>*<span class="var type1" id="S26T3U813">m_3</span></span>*<span class="var type1" id="S41T3U814">x_4</span></span>*<span class="mxinfo " id="T3:U665">7.2e1</span></span></span>+<span class="mxinfo " id="T3:U666"><span class="mxinfo " id="T3:U667"><span class="mxinfo " id="T3:U668"><span class="mxinfo " id="T3:U669"><span class="mxinfo " id="T3:U670"><span class="var type1" id="S22T3U821">l_1</span>*<span class="var type1" id="S51T3U822">t9</span></span>*<span class="var type1" id="S54T3U823">t12</span></span>*<span class="var type1" id="S55T3U824">t13</span></span>*<span class="mxinfo " id="T3:U675">sin(<span class="var type1" id="S57T3U827">t15</span>)</span></span>*<span class="mxinfo " id="T3:U677">9.0</span></span></span>+<span class="mxinfo " id="T3:U678"><span class="mxinfo " id="T3:U679"><span class="mxinfo " id="T3:U680"><span class="mxinfo " id="T3:U681"><span class="mxinfo " id="T3:U682"><span class="var type1" id="S21T3U834">g</span>*<span class="var type1" id="S22T3U835">l_1</span></span>*<span class="var type1" id="S23T3U836">l_2</span></span>*<span class="var type1" id="S51T3U837">t9</span></span>*<span class="var type1" id="S53T3U838">t11</span></span>*<span class="mxinfo " id="T3:U688">1.8e1</span></span></span>-<span class="mxinfo " id="T3:U689"><span class="mxinfo " id="T3:U690"><span class="mxinfo " id="T3:U691"><span class="mxinfo " id="T3:U692"><span class="mxinfo " id="T3:U693"><span class="var type1" id="S21T3U845">g</span>*<span class="var type1" id="S22T3U846">l_1</span></span>*<span class="var type1" id="S23T3U847">l_2</span></span>*<span class="var type1" id="S51T3U848">t9</span></span>*<span class="var type1" id="S60T3U849">t18</span></span>*<span class="mxinfo " id="T3:U699">1.8e1</span></span></span>+<span class="mxinfo " id="T3:U700"><span class="mxinfo " id="T3:U701"><span class="mxinfo " id="T3:U702"><span class="mxinfo " id="T3:U703"><span class="mxinfo " id="T3:U704"><span class="var type1" id="S27T3U856">d_p1</span>*<span class="var type1" id="S23T3U857">l_2</span></span>*<span class="var type1" id="S25T3U858">m_2</span></span>*<span class="var type1" id="S43T3U859">t2</span></span>*<span class="var type1" id="S39T3U860">x_2</span></span>*<span class="mxinfo " id="T3:U710">3.6e1</span></span></span>+<span class="mxinfo " id="T3:U711"><span class="mxinfo " id="T3:U712"><span class="mxinfo " id="T3:U713"><span class="mxinfo " id="T3:U714"><span class="mxinfo " id="T3:U715"><span class="var type1" id="S28T3U867">d_p2</span>*<span class="var type1" id="S23T3U868">l_2</span></span>*<span class="var type1" id="S25T3U869">m_2</span></span>*<span class="var type1" id="S43T3U870">t2</span></span>*<span class="var type1" id="S39T3U871">x_2</span></span>*<span class="mxinfo " id="T3:U721">3.6e1</span></span></span>-<span class="mxinfo " id="T3:U722"><span class="mxinfo " id="T3:U723"><span class="mxinfo " id="T3:U724"><span class="mxinfo " id="T3:U725"><span class="mxinfo " id="T3:U726"><span class="var type1" id="S28T3U878">d_p2</span>*<span class="var type1" id="S23T3U879">l_2</span></span>*<span class="var type1" id="S25T3U880">m_2</span></span>*<span class="var type1" id="S43T3U881">t2</span></span>*<span class="var type1" id="S41T3U882">x_4</span></span>*<span class="mxinfo " id="T3:U732">3.6e1</span></span></span>+<span class="mxinfo " id="T3:U733"><span class="mxinfo " id="T3:U734"><span class="mxinfo " id="T3:U735"><span class="mxinfo " id="T3:U736"><span class="mxinfo " id="T3:U737"><span class="var type1" id="S22T3U889">l_1</span>*<span class="var type1" id="S23T3U890">l_2</span></span>*<span class="var type1" id="S51T3U891">t9</span></span>*<span class="var type1" id="S52T3U892">t10</span></span>*<span class="var type1" id="S13T3U893">u</span></span>*<span class="mxinfo " id="T3:U743">1.8e1</span></span></span>-<span class="mxinfo " id="T3:U744"><span class="mxinfo " id="T3:U745"><span class="mxinfo " id="T3:U746"><span class="mxinfo " id="T3:U747"><span class="mxinfo " id="T3:U748"><span class="var type1" id="S22T3U900">l_1</span>*<span class="var type1" id="S23T3U901">l_2</span></span>*<span class="var type1" id="S51T3U902">t9</span></span>*<span class="var type1" id="S59T3U903">t17</span></span>*<span class="var type1" id="S13T3U904">u</span></span>*<span class="mxinfo " id="T3:U754">1.8e1</span></span></span>+<span class="mxinfo " id="T3:U755"><span class="mxinfo " id="T3:U756"><span class="mxinfo " id="T3:U757"><span class="mxinfo " id="T3:U758"><span class="mxinfo " id="T3:U759"><span class="mxinfo " id="T3:U760"><span class="var type1" id="S21T3U912">g</span>*<span class="var type1" id="S22T3U913">l_1</span></span>*<span class="var type1" id="S23T3U914">l_2</span></span>*<span class="var type1" id="S24T3U915">m_1</span></span>*<span class="var type1" id="S25T3U916">m_2</span></span>*<span class="var type1" id="S53T3U917">t11</span></span>*<span class="mxinfo " id="T3:U767">3.0</span></span></span>+<span class="mxinfo " id="T3:U768"><span class="mxinfo " id="T3:U769"><span class="mxinfo " id="T3:U770"><span class="mxinfo " id="T3:U771"><span class="mxinfo " id="T3:U772"><span class="mxinfo " id="T3:U773"><span class="var type1" id="S21T3U925">g</span>*<span class="var type1" id="S22T3U926">l_1</span></span>*<span class="var type1" id="S23T3U927">l_2</span></span>*<span class="var type1" id="S25T3U928">m_2</span></span>*<span class="var type1" id="S26T3U929">m_3</span></span>*<span class="var type1" id="S53T3U930">t11</span></span>*<span class="mxinfo " id="T3:U780">1.8e1</span></span></span>-<span class="mxinfo " id="T3:U781"><span class="mxinfo " id="T3:U782"><span class="mxinfo " id="T3:U783"><span class="mxinfo " id="T3:U784"><span class="mxinfo " id="T3:U785"><span class="mxinfo " id="T3:U786"><span class="var type1" id="S21T3U938">g</span>*<span class="var type1" id="S22T3U939">l_1</span></span>*<span class="var type1" id="S23T3U940">l_2</span></span>*<span class="var type1" id="S24T3U941">m_1</span></span>*<span class="var type1" id="S25T3U942">m_2</span></span>*<span class="var type1" id="S60T3U943">t18</span></span>*<span class="mxinfo " id="T3:U793">9.0</span></span></span>-<span class="mxinfo " id="T3:U794"><span class="mxinfo " id="T3:U795"><span class="mxinfo " id="T3:U796"><span class="mxinfo " id="T3:U797"><span class="mxinfo " id="T3:U798"><span class="mxinfo " id="T3:U799"><span class="var type1" id="S21T3U951">g</span>*<span class="var type1" id="S22T3U952">l_1</span></span>*<span class="var type1" id="S23T3U953">l_2</span></span>*<span class="var type1" id="S25T3U954">m_2</span></span>*<span class="var type1" id="S26T3U955">m_3</span></span>*<span class="var type1" id="S60T3U956">t18</span></span>*<span class="mxinfo " id="T3:U806">1.8e1</span></span></span>+<span class="mxinfo " id="T3:U807"><span class="mxinfo " id="T3:U808"><span class="mxinfo " id="T3:U809"><span class="mxinfo " id="T3:U810"><span class="mxinfo " id="T3:U811"><span class="mxinfo " id="T3:U812"><span class="var type1" id="S22T3U964">l_1</span>*<span class="var type1" id="S23T3U965">l_2</span></span>*<span class="var type1" id="S24T3U966">m_1</span></span>*<span class="var type1" id="S25T3U967">m_2</span></span>*<span class="var type1" id="S52T3U968">t10</span></span>*<span class="var type1" id="S13T3U969">u</span></span>*<span class="mxinfo " id="T3:U819">3.0</span></span></span>+<span class="mxinfo " id="T3:U820"><span class="mxinfo " id="T3:U821"><span class="mxinfo " id="T3:U822"><span class="mxinfo " id="T3:U823"><span class="mxinfo " id="T3:U824"><span class="mxinfo " id="T3:U825"><span class="var type1" id="S22T3U977">l_1</span>*<span class="var type1" id="S23T3U978">l_2</span></span>*<span class="var type1" id="S25T3U979">m_2</span></span>*<span class="var type1" id="S26T3U980">m_3</span></span>*<span class="var type1" id="S52T3U981">t10</span></span>*<span class="var type1" id="S13T3U982">u</span></span>*<span class="mxinfo " id="T3:U832">1.8e1</span></span></span>-<span class="mxinfo " id="T3:U833"><span class="mxinfo " id="T3:U834"><span class="mxinfo " id="T3:U835"><span class="mxinfo " id="T3:U836"><span class="mxinfo " id="T3:U837"><span class="mxinfo " id="T3:U838"><span class="var type1" id="S22T3U990">l_1</span>*<span class="var type1" id="S23T3U991">l_2</span></span>*<span class="var type1" id="S24T3U992">m_1</span></span>*<span class="var type1" id="S25T3U993">m_2</span></span>*<span class="var type1" id="S59T3U994">t17</span></span>*<span class="var type1" id="S13T3U995">u</span></span>*<span class="mxinfo " id="T3:U845">9.0</span></span></span>-<span class="mxinfo " id="T3:U846"><span class="mxinfo " id="T3:U847"><span class="mxinfo " id="T3:U848"><span class="mxinfo " id="T3:U849"><span class="mxinfo " id="T3:U850"><span class="mxinfo " id="T3:U851"><span class="var type1" id="S22T3U1003">l_1</span>*<span class="var type1" id="S23T3U1004">l_2</span></span>*<span class="var type1" id="S25T3U1005">m_2</span></span>*<span class="var type1" id="S26T3U1006">m_3</span></span>*<span class="var type1" id="S59T3U1007">t17</span></span>*<span class="var type1" id="S13T3U1008">u</span></span>*<span class="mxinfo " id="T3:U858">1.8e1</span></span></span>)</span>)/(<span class="mxinfo " id="T3:U859"><span class="mxinfo " id="T3:U860"><span class="var type1" id="S22T3U1013">l_1</span>*<span class="var type1" id="S25T3U1014">m_2</span></span>*(<span class="mxinfo " id="T3:U863"><span class="mxinfo " id="T3:U864"><span class="mxinfo " id="T3:U865"><span class="mxinfo " id="T3:U866"><span class="var type1" id="S24T3U1020">m_1</span>*<span class="mxinfo " id="T3:U868">8.0</span></span>+<span class="mxinfo " id="T3:U869"><span class="var type1" id="S25T3U1023">m_2</span>*<span class="mxinfo " id="T3:U871">1.5e1</span></span></span>+<span class="mxinfo " id="T3:U872"><span class="var type1" id="S26T3U1026">m_3</span>*<span class="mxinfo " id="T3:U874">2.4e1</span></span></span>-<span class="mxinfo " id="T3:U875"><span class="mxinfo " id="T3:U876"><span class="var type1" id="S25T3U1030">m_2</span>*<span class="mxinfo " id="T3:U878">cos(<span class="var type1" id="S57T3U1033">t15</span>)</span></span>*<span class="mxinfo " id="T3:U880">9.0</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo " id="T1:U881"><span class="mxinfo " id="T1:U882"><span class="var type1" id="S18T5U1038">x_sig</span>(<span class="mxinfo " id="T9:U884">:</span>,<span class="var type1" id="S34T3U1040">i</span>)</span> = <span class="var type1" id="S61T1U1041">t1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo " id="T6:U887"><span class="var type1" id="S62T6U1044">y_sig</span>= <span class="mxinfo " id="T6:U889"><span class="mxinfo " id="T11:U890">[1 0 0 0]</span> * <span class="var type1" id="S18T5U1052">x_sig</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="comment">% Prediction, weighted sum</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo " id="T1:U892"><span class="var type1" id="S15T1U1055">x_p</span>  = <span class="mxinfo " id="T1:U894"><span class="var type1" id="S18T5U1057">x_sig</span> * <span class="mxinfo " id="T10:U896"><span class="var type1" id="S19T6U1059">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo " id="T3:U898"><span class="var type1" id="S63T3U1062">y_</span>  = <span class="mxinfo " id="T3:U900"><span class="var type1" id="S62T6U1064">y_sig</span> * <span class="mxinfo " id="T10:U902"><span class="var type1" id="S19T6U1066">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="comment">%P_p calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo " id="T2:U904"><span class="var type1" id="S16T2U1069">P_p</span> = <span class="mxinfo " id="T2:U906"><span class="var type1" id="S16T2U1071">P_p</span> .* <span class="mxinfo " id="T3:U908">0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1075">i</span>=<span class="mxinfo " id="T10:U910"><span class="mxinfo " id="T3:U911">1</span>:(2*<span class="var type1" id="S29T3U1082">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    <span class="mxinfo " id="T2:U913"><span class="var type1" id="S16T2U1086">P_p</span> = <span class="mxinfo " id="T2:U915"><span class="var type1" id="S16T2U1088">P_p</span> + (<span class="mxinfo " id="T2:U917"><span class="mxinfo " id="T2:U918">(<span class="mxinfo " id="T1:U919"><span class="mxinfo " id="T1:U920"><span class="var type1" id="S18T5U1095">x_sig</span>(<span class="mxinfo " id="T9:U922">:</span>,<span class="var type1" id="S34T3U1097">i</span>)</span> - <span class="var type1" id="S15T1U1098">x_p</span></span>) * <span class="mxinfo " id="T11:U925">(<span class="mxinfo " id="T1:U926"><span class="mxinfo " id="T1:U927"><span class="var type1" id="S18T5U1103">x_sig</span>(<span class="mxinfo " id="T9:U929">:</span>,<span class="var type1" id="S34T3U1105">i</span>)</span> - <span class="var type1" id="S15T1U1106">x_p</span></span>)'</span></span> .* <span class="mxinfo " id="T3:U932"><span class="var type1" id="S20T6U1108">W_c</span>(<span class="mxinfo " id="T3:U934">1</span>,<span class="var type1" id="S34T3U1110">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"><span class="mxinfo " id="T2:U936"><span class="var type1" id="S16T2U1113">P_p</span>  = <span class="mxinfo " id="T2:U938"><span class="var type1" id="S16T2U1115">P_p</span> + <span class="var type1" id="S5T2U1116">Q</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="comment">%% Unscented Kalman filter measurement update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="comment">% Pyy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo " id="T3:U941"><span class="var type1" id="S64T3U1119">P_yy</span> = <span class="mxinfo " id="T3:U943">zeros(<span class="var type1" id="S30T3U1122">o_ukf</span>,<span class="var type1" id="S30T3U1123">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1126">i</span>=<span class="mxinfo " id="T10:U947"><span class="mxinfo " id="T3:U948">1</span>:(2*<span class="var type1" id="S29T3U1133">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="mxinfo " id="T3:U950"><span class="var type1" id="S64T3U1137">P_yy</span> = <span class="mxinfo " id="T3:U952"><span class="var type1" id="S64T3U1139">P_yy</span> + (<span class="mxinfo " id="T3:U954"><span class="mxinfo " id="T3:U955">(<span class="mxinfo " id="T3:U956"><span class="mxinfo " id="T3:U957"><span class="var type1" id="S62T6U1146">y_sig</span>(<span class="mxinfo " id="T7:U959">:</span>,<span class="var type1" id="S34T3U1148">i</span>)</span> - <span class="var type1" id="S63T3U1149">y_</span></span>) * (<span class="mxinfo " id="T3:U962"><span class="mxinfo " id="T3:U963"><span class="var type1" id="S62T6U1154">y_sig</span>(<span class="mxinfo " id="T7:U965">:</span>,<span class="var type1" id="S34T3U1156">i</span>)</span> - <span class="var type1" id="S63T3U1157">y_</span></span>)'</span> .* <span class="mxinfo " id="T3:U968"><span class="var type1" id="S20T6U1159">W_c</span>(<span class="mxinfo " id="T3:U970">1</span>,<span class="var type1" id="S34T3U1161">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="mxinfo " id="T3:U972"><span class="var type1" id="S64T3U1164">P_yy</span> = <span class="mxinfo " id="T3:U974"><span class="var type1" id="S64T3U1166">P_yy</span> + <span class="var type1" id="S6T3U1167">R</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="comment">% Pxy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="mxinfo " id="T1:U977"><span class="var type1" id="S65T1U1170">P_xy</span> = <span class="mxinfo " id="T1:U979">zeros(<span class="var type1" id="S29T3U1173">n_ukf</span>,<span class="var type1" id="S30T3U1174">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1177">i</span>=<span class="mxinfo " id="T10:U983"><span class="mxinfo " id="T3:U984">1</span>:(2*<span class="var type1" id="S29T3U1184">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">    <span class="mxinfo " id="T1:U986"><span class="var type1" id="S65T1U1188">P_xy</span> = <span class="mxinfo " id="T1:U988"><span class="var type1" id="S65T1U1190">P_xy</span>+(<span class="mxinfo " id="T1:U990"><span class="mxinfo " id="T1:U991">(<span class="mxinfo " id="T1:U992"><span class="mxinfo " id="T1:U993"><span class="var type1" id="S18T5U1197">x_sig</span>(<span class="mxinfo " id="T9:U995">:</span>,<span class="var type1" id="S34T3U1199">i</span>)</span>-<span class="var type1" id="S15T1U1200">x_p</span></span>)*(<span class="mxinfo " id="T3:U998"><span class="mxinfo " id="T3:U999"><span class="var type1" id="S62T6U1205">y_sig</span>(<span class="mxinfo " id="T7:U1001">:</span>,<span class="var type1" id="S34T3U1207">i</span>)</span>-<span class="var type1" id="S63T3U1208">y_</span></span>)'</span>.*<span class="mxinfo " id="T3:U1004"><span class="var type1" id="S20T6U1210">W_c</span>(<span class="mxinfo " id="T3:U1006">1</span>,<span class="var type1" id="S34T3U1212">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="comment">% Kalman Gain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo " id="T1:U1008"><span class="var type1" id="S66T1U1215">K</span>  = <span class="mxinfo " id="T1:U1010"><span class="var type1" id="S65T1U1217">P_xy</span>/(<span class="var type1" id="S64T3U1219">P_yy</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="mxinfo " id="T2:U1013"><span class="var type1" id="S16T2U1222">P_p</span> = <span class="mxinfo " id="T2:U1015"><span class="var type1" id="S16T2U1224">P_p</span> - (<span class="mxinfo " id="T2:U1017"><span class="mxinfo " id="T1:U1018"><span class="var type1" id="S66T1U1228">K</span> * <span class="var type1" id="S64T3U1229">P_yy</span></span> * <span class="mxinfo " id="T11:U1021"><span class="var type1" id="S66T1U1231">K</span>'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="mxinfo " id="T1:U1023"><span class="var type1" id="S2T1U1234">x</span>  = <span class="mxinfo " id="T1:U1025"><span class="var type1" id="S15T1U1236">x_p</span> +  <span class="mxinfo " id="T1:U1027"><span class="var type1" id="S66T1U1238">K</span> * ( <span class="mxinfo " id="T3:U1029"><span class="var type1" id="S14T3U1241">y</span> - <span class="var type1" id="S63T3U1242">y_</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"><span class="mxinfo " id="T1:U1032"><span class="var type1" id="S15T1U1245">x_p</span> = <span class="var type1" id="S2T1U1246">x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
