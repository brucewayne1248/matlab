<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">x</span>,<span class="var type1" id="S3T1U4">K</span>] = unscented_kalman_filter(<span class="var type1" id="S4T2U7">P</span>, <span class="var type1" id="S5T2U8">Q</span>, <span class="var type1" id="S6T3U9">R</span>, <span class="var type1" id="S7T1U10">x0</span>, <span class="var type1" id="S8T3U11">alpha_ukf</span>, <span class="var type1" id="S9T3U12">beta_ukf</span>, <span class="var type1" id="S10T3U13">kappa_ukf</span>, <span class="var type1" id="S11T4U14">para_sys</span>, <span class="var type1" id="S12T3U15">T</span>, <span class="var type1" id="S13T3U16">u</span>, <span class="var type1" id="S14T3U17">y</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Unscented Kalman Filter (UKF) fuer nichtlineare Systeme</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% Das UKF praediziert den Zustand eines nichtliniearen Systems durch</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Mittelung sog. Sigma Punkte. Dazu werden 2n+1 Sigmapunkte (moegliche</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Zustaende des Systems) mittels Kovarianzmatrix P berechnet und fuer jeden</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% Sigmapunkt mithilfe der Zustandsgleichung ein neuer Zustand praediziert.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% Diese werden gewichtet gemittelt und mit deren Hilfe die neuen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% Kovarianzmatrizen, die Rueckfuehrmatrix K und die Zustaende ermittelt.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% Weitere Infos unter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% http://www.agnld.uni-potsdam.de/~shw/TSA/Tools/UKF/node4.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% http://cslu.cse.ogi.edu/nsel/ukf/node6.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% Tipp: kappa meist zu 0 waehlen, alpha sehr klein bspw. 0.001, beta bei</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% Gaussverteilung = 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% -alpha bestimmt die Streuung der Sigma-Punkte um den Mittelwert</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% -beta wird benutzt, um Wissen ueber die Verteilung aufzunehmen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">% -kappa ist ein sekundaerer skalierender Parameter, der gewoehnlich </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% gleich 0 oder 3-n gesetzt wird</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% Vorlage von Matthias Dagen, September 2009, veraendert durch David</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% Klinkenbuss</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S15T1U19">x_p</span> <span class="var type1" id="S16T2U20">P_p</span> <span class="var type1" id="S17T5U21">x0_sig</span> <span class="var type1" id="S18T5U22">x_sig</span> <span class="var type1" id="S19T6U23">W_m</span> <span class="var type1" id="S20T6U24">W_c</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">% Parameter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo " id="T3:U20"><span class="var type1" id="S21T3U27">g</span> = <span class="mxinfo " id="T3:U22"><span class="var type1" id="S11T4U29">para_sys</span>(<span class="mxinfo " id="T3:U24">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo " id="T3:U25"><span class="var type1" id="S22T3U33">l_1</span> = <span class="mxinfo " id="T3:U27"><span class="var type1" id="S11T4U35">para_sys</span>(<span class="mxinfo " id="T7:U29">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo " id="T3:U30"><span class="var type1" id="S23T3U39">l_2</span> = <span class="mxinfo " id="T3:U32"><span class="var type1" id="S11T4U41">para_sys</span>(<span class="mxinfo " id="T7:U34">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo " id="T3:U35"><span class="var type1" id="S24T3U45">m_1</span> = <span class="mxinfo " id="T3:U37"><span class="var type1" id="S11T4U47">para_sys</span>(<span class="mxinfo " id="T3:U39">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T3:U40"><span class="var type1" id="S25T3U51">m_2</span> = <span class="mxinfo " id="T3:U42"><span class="var type1" id="S11T4U53">para_sys</span>(<span class="mxinfo " id="T7:U44">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo " id="T3:U45"><span class="var type1" id="S26T3U57">m_3</span> = <span class="mxinfo " id="T3:U47"><span class="var type1" id="S11T4U59">para_sys</span>(<span class="mxinfo " id="T3:U49">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T3:U50"><span class="var type1" id="S27T3U63">d_p1</span> = <span class="mxinfo " id="T3:U52"><span class="var type1" id="S11T4U65">para_sys</span>(<span class="mxinfo " id="T3:U54">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo " id="T3:U55"><span class="var type1" id="S28T3U69">d_p2</span> = <span class="mxinfo " id="T3:U57"><span class="var type1" id="S11T4U71">para_sys</span>(<span class="mxinfo " id="T3:U59">8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T3:U60"><span class="var type1" id="S29T3U75">n_ukf</span>  = <span class="mxinfo " id="T3:U62">4</span></span>;     <span class="comment">% Laenge von f(x)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo " id="T3:U63"><span class="var type1" id="S30T3U79">o_ukf</span> = <span class="mxinfo " id="T3:U65">1</span></span>;      <span class="comment">% Anzahl der zurueckgefuehrten Variablen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U66">isempty(<span class="var type0" id="S15T0U90">x_p</span>)</span> || <span class="mxinfo " id="T8:U67">isempty(<span class="var type0" id="S16T0U93">P_p</span>)</span> || <span class="mxinfo " id="T8:U68">isempty(<span class="var type0" id="S17T0U96">x0_sig</span>)</span> || <span class="mxinfo " id="T8:U69">isempty(<span class="var type0" id="S18T0U99">x_sig</span>)</span> || <span class="mxinfo " id="T8:U70">isempty(<span class="var type0" id="S19T0U102">W_m</span>)</span> || <span class="mxinfo " id="T8:U71">isempty(<span class="var type0" id="S20T0U105">W_c</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo " id="T1:U72"><span class="var type1" id="S15T1U108">x_p</span> = <span class="var type1" id="S7T1U109">x0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo " id="T2:U75"><span class="var type1" id="S16T2U112">P_p</span> = <span class="var type1" id="S4T2U113">P</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T5:U78"><span class="var type1" id="S17T5U116">x0_sig</span> = <span class="mxinfo " id="T5:U80">zeros(<span class="var type1" id="S29T3U119">n_ukf</span>,<span class="mxinfo " id="T3:U82">2*<span class="var type1" id="S29T3U123">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T5:U84"><span class="var type1" id="S18T5U127">x_sig</span>  = <span class="mxinfo " id="T5:U86">zeros(<span class="var type1" id="S29T3U130">n_ukf</span>,<span class="mxinfo " id="T3:U88">2*<span class="var type1" id="S29T3U134">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T6:U90"><span class="var type1" id="S19T6U138">W_m</span> = <span class="mxinfo " id="T6:U92">zeros(<span class="mxinfo " id="T3:U93">1</span>,<span class="mxinfo " id="T3:U94">2*<span class="var type1" id="S29T3U145">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T6:U96"><span class="var type1" id="S20T6U149">W_c</span> = <span class="mxinfo " id="T6:U98">zeros(<span class="mxinfo " id="T3:U99">1</span>,<span class="mxinfo " id="T3:U100">2*<span class="var type1" id="S29T3U156">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T1:U102"><span class="var type1" id="S2T1U160">x</span> = <span class="var type1" id="S15T1U161">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo " id="T1:U105"><span class="var type1" id="S3T1U164">K</span> = <span class="mxinfo " id="T1:U107">zeros(<span class="mxinfo " id="T3:U108">4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%% Parameter-Initialization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo " id="T3:U109"><span class="var type1" id="S33T3U172">lambda_ukf</span> = <span class="mxinfo " id="T3:U111"><span class="mxinfo " id="T3:U112">(<span class="mxinfo " id="T3:U113"><span class="var type1" id="S8T3U177">alpha_ukf</span>^2</span>)*(<span class="mxinfo " id="T3:U115"><span class="var type1" id="S29T3U181">n_ukf</span>+<span class="var type1" id="S10T3U182">kappa_ukf</span></span>)</span>-<span class="var type1" id="S29T3U183">n_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%% Weight calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T3:U119"><span class="mxinfo " id="T3:U120"><span class="var type1" id="S19T6U187">W_m</span>(<span class="mxinfo " id="T3:U122">1</span>,<span class="mxinfo " id="T3:U123">1</span>)</span> = <span class="mxinfo " id="T3:U124"><span class="var type1" id="S33T3U191">lambda_ukf</span>/(<span class="mxinfo " id="T3:U126"><span class="var type1" id="S29T3U194">n_ukf</span>+<span class="var type1" id="S33T3U195">lambda_ukf</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo " id="T3:U129"><span class="mxinfo " id="T3:U130"><span class="var type1" id="S20T6U199">W_c</span>(<span class="mxinfo " id="T3:U132">1</span>,<span class="mxinfo " id="T3:U133">1</span>)</span> = <span class="mxinfo " id="T3:U134"><span class="mxinfo " id="T3:U135"><span class="mxinfo " id="T3:U136"><span class="mxinfo " id="T3:U137"><span class="var type1" id="S33T3U206">lambda_ukf</span>/(<span class="mxinfo " id="T3:U139"><span class="var type1" id="S29T3U209">n_ukf</span>+<span class="var type1" id="S33T3U210">lambda_ukf</span></span>)</span>+<span class="mxinfo " id="T3:U142">1</span></span>-<span class="mxinfo " id="T3:U143"><span class="var type1" id="S8T3U213">alpha_ukf</span>^2</span></span>+<span class="var type1" id="S9T3U215">beta_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U218">i</span>=<span class="mxinfo " id="T4:U147"><span class="mxinfo " id="T3:U148">2</span>:2*<span class="var type1" id="S29T3U224">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo " id="T3:U150"><span class="mxinfo " id="T3:U151"><span class="var type1" id="S19T6U229">W_m</span>(<span class="mxinfo " id="T3:U153">1</span>,<span class="var type1" id="S34T3U231">i</span>)</span> = <span class="mxinfo " id="T3:U155"><span class="mxinfo " id="T3:U156">1</span>/(<span class="mxinfo " id="T3:U157"><span class="mxinfo " id="T3:U158">2</span>*(<span class="mxinfo " id="T3:U159"><span class="var type1" id="S29T3U239">n_ukf</span>+<span class="var type1" id="S33T3U240">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo " id="T3:U162"><span class="mxinfo " id="T3:U163"><span class="var type1" id="S20T6U244">W_c</span>(<span class="mxinfo " id="T3:U165">1</span>,<span class="var type1" id="S34T3U246">i</span>)</span> = <span class="mxinfo " id="T3:U167"><span class="mxinfo " id="T3:U168">1</span>/(<span class="mxinfo " id="T3:U169"><span class="mxinfo " id="T3:U170">2</span>*(<span class="mxinfo " id="T3:U171"><span class="var type1" id="S29T3U254">n_ukf</span>+<span class="var type1" id="S33T3U255">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%% 2n+1 Sigma Points calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="var type0" id="S16T0U258">P_p</span> = <span class="message error" id="M1F1C"><span class="fcn" id="F39N4:B260">nearestSPD</span>(<span class="var type1" id="S16T2U261">P_p</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo " id="T2:U175"><span class="var type1" id="S36T2U264">P_an</span> = <span class="mxinfo " id="T2:U177">(<span class="mxinfo " id="T2:U178"><span class="mxinfo " id="T3:U179">sqrt(<span class="mxinfo " id="T3:U180"><span class="var type1" id="S29T3U271">n_ukf</span>+<span class="var type1" id="S33T3U272">lambda_ukf</span></span>)</span>.*<span class="mxinfo " id="T2:U183">chol(<span class="var type1" id="S16T2U275">P_p</span>)</span></span>)'</span></span>; <span class="comment">% Wurzelmatrix mittels Cholesky-Zerlegung</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo " id="T1:U185"><span class="mxinfo " id="T1:U186"><span class="var type1" id="S17T5U279">x0_sig</span>(<span class="mxinfo " id="T9:U188">:</span>,<span class="mxinfo " id="T3:U189">1</span>)</span> = <span class="var type1" id="S15T1U282">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U285">i</span>=<span class="mxinfo " id="T1:U192"><span class="mxinfo " id="T3:U193">2</span>:<span class="var type1" id="S29T3U289">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T1:U195"><span class="mxinfo " id="T1:U196"><span class="var type1" id="S17T5U294">x0_sig</span>(<span class="mxinfo " id="T9:U198">:</span>,<span class="var type1" id="S34T3U296">i</span>)</span>     = <span class="mxinfo " id="T1:U200"><span class="var type1" id="S15T1U298">x_p</span> + <span class="mxinfo " id="T1:U202"><span class="var type1" id="S36T2U300">P_an</span>(<span class="mxinfo " id="T9:U204">:</span>,<span class="mxinfo " id="T3:U205"><span class="var type1" id="S34T3U303">i</span>-<span class="mxinfo " id="T3:U207">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    <span class="mxinfo " id="T1:U208"><span class="mxinfo " id="T1:U209"><span class="var type1" id="S17T5U308">x0_sig</span>(<span class="mxinfo " id="T9:U211">:</span>,<span class="mxinfo " id="T3:U212"><span class="var type1" id="S29T3U311">n_ukf</span>+<span class="var type1" id="S34T3U312">i</span></span>)</span>   = <span class="mxinfo " id="T1:U215"><span class="var type1" id="S15T1U314">x_p</span> - <span class="mxinfo " id="T1:U217"><span class="var type1" id="S36T2U316">P_an</span>(<span class="mxinfo " id="T9:U219">:</span>,<span class="mxinfo " id="T3:U220"><span class="var type1" id="S34T3U319">i</span>-<span class="mxinfo " id="T3:U222">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%% Unscented Kalman filter time update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U323">i</span> = <span class="mxinfo " id="T10:U224"><span class="mxinfo " id="T3:U225">1</span>:(2*<span class="var type1" id="S29T3U330">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"> <span class="mxinfo " id="T3:U227"><span class="var type1" id="S39T3U334">x_1</span> = <span class="mxinfo " id="T3:U229"><span class="var type1" id="S17T5U336">x0_sig</span>(<span class="mxinfo " id="T7:U231">1</span>,<span class="var type1" id="S34T3U338">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"> <span class="mxinfo " id="T3:U233"><span class="var type1" id="S40T3U341">x_2</span> = <span class="mxinfo " id="T3:U235"><span class="var type1" id="S17T5U343">x0_sig</span>(<span class="mxinfo " id="T7:U237">2</span>,<span class="var type1" id="S34T3U345">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"> <span class="mxinfo " id="T3:U239"><span class="var type1" id="S41T3U348">x_3</span> = <span class="mxinfo " id="T3:U241"><span class="var type1" id="S17T5U350">x0_sig</span>(<span class="mxinfo " id="T7:U243">3</span>,<span class="var type1" id="S34T3U352">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"> <span class="mxinfo " id="T3:U245"><span class="var type1" id="S42T3U355">x_4</span> = <span class="mxinfo " id="T3:U247"><span class="var type1" id="S17T5U357">x0_sig</span>(<span class="mxinfo " id="T7:U249">4</span>,<span class="var type1" id="S34T3U359">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo " id="T1:U251"><span class="mxinfo " id="T1:U252"><span class="var type1" id="S18T5U363">x_sig</span>(<span class="mxinfo " id="T9:U254">:</span>,<span class="var type1" id="S34T3U365">i</span>)</span> = <span class="mxinfo " id="T1:U256">[<span class="mxinfo " id="T3:U257"><span class="var type1" id="S39T3U369">x_1</span> + <span class="mxinfo " id="T3:U259"><span class="var type1" id="S12T3U371">T</span>*<span class="var type1" id="S40T3U372">x_2</span></span></span>;<span class="mxinfo " id="T3:U262"><span class="var type1" id="S40T3U375">x_2</span> + <span class="mxinfo " id="T3:U264">(<span class="mxinfo " id="T3:U265"><span class="var type1" id="S12T3U379">T</span>*(<span class="mxinfo " id="T3:U267"><span class="mxinfo " id="T3:U268"><span class="mxinfo " id="T3:U269"><span class="mxinfo " id="T3:U270"><span class="mxinfo " id="T3:U271"><span class="mxinfo " id="T3:U272"><span class="mxinfo " id="T3:U273"><span class="mxinfo " id="T3:U274"><span class="mxinfo " id="T3:U275"><span class="mxinfo " id="T3:U276"><span class="mxinfo " id="T3:U277"><span class="mxinfo " id="T3:U278"><span class="mxinfo " id="T3:U279"><span class="mxinfo " id="T3:U280">12</span>*<span class="var type1" id="S28T3U395">d_p2</span></span>*<span class="var type1" id="S23T3U396">l_2</span></span>*<span class="var type1" id="S42T3U397">x_4</span></span> - <span class="mxinfo " id="T3:U284"><span class="mxinfo " id="T3:U285"><span class="mxinfo " id="T3:U286"><span class="mxinfo " id="T3:U287">12</span>*<span class="var type1" id="S27T3U402">d_p1</span></span>*<span class="var type1" id="S23T3U403">l_2</span></span>*<span class="var type1" id="S40T3U404">x_2</span></span></span> - <span class="mxinfo " id="T3:U291"><span class="mxinfo " id="T3:U292"><span class="mxinfo " id="T3:U293"><span class="mxinfo " id="T3:U294">12</span>*<span class="var type1" id="S28T3U409">d_p2</span></span>*<span class="var type1" id="S23T3U410">l_2</span></span>*<span class="var type1" id="S40T3U411">x_2</span></span></span> - <span class="mxinfo " id="T3:U298"><span class="mxinfo " id="T3:U299">cos(<span class="mxinfo " id="T3:U300"><span class="var type1" id="S39T3U416">x_1</span> - <span class="var type1" id="S41T3U417">x_3</span></span>)</span>*(<span class="mxinfo " id="T3:U303"><span class="mxinfo " id="T3:U304"><span class="mxinfo " id="T3:U305"><span class="mxinfo " id="T3:U306"><span class="mxinfo " id="T3:U307"><span class="mxinfo " id="T3:U308"><span class="mxinfo " id="T3:U309"><span class="mxinfo " id="T3:U310">18</span>*<span class="var type1" id="S28T3U427">d_p2</span></span>*<span class="var type1" id="S22T3U428">l_1</span></span>*<span class="var type1" id="S40T3U429">x_2</span></span> - <span class="mxinfo " id="T3:U314"><span class="mxinfo " id="T3:U315"><span class="mxinfo " id="T3:U316"><span class="mxinfo " id="T3:U317">18</span>*<span class="var type1" id="S28T3U434">d_p2</span></span>*<span class="var type1" id="S22T3U435">l_1</span></span>*<span class="var type1" id="S42T3U436">x_4</span></span></span> + <span class="mxinfo " id="T3:U321"><span class="mxinfo " id="T3:U322"><span class="mxinfo " id="T3:U323"><span class="mxinfo " id="T3:U324"><span class="mxinfo " id="T3:U325"><span class="mxinfo " id="T3:U326">9</span>*<span class="var type1" id="S22T3U443">l_1</span></span>*<span class="var type1" id="S23T3U444">l_2</span></span>*<span class="var type1" id="S25T3U445">m_2</span></span>*<span class="var type1" id="S13T3U446">u</span></span>*<span class="mxinfo " id="T3:U331">cos(<span class="var type1" id="S41T3U449">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U333"><span class="mxinfo " id="T3:U334"><span class="mxinfo " id="T3:U335"><span class="mxinfo " id="T3:U336"><span class="mxinfo " id="T3:U337"><span class="mxinfo " id="T3:U338">9</span>*<span class="var type1" id="S21T3U456">g</span></span>*<span class="var type1" id="S22T3U457">l_1</span></span>*<span class="var type1" id="S23T3U458">l_2</span></span>*<span class="var type1" id="S25T3U459">m_2</span></span>*<span class="mxinfo " id="T3:U343">sin(<span class="var type1" id="S41T3U462">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U345"><span class="mxinfo " id="T3:U346"><span class="mxinfo " id="T3:U347"><span class="mxinfo " id="T3:U348"><span class="mxinfo " id="T3:U349"><span class="mxinfo " id="T3:U350">9</span>*<span class="mxinfo " id="T3:U351"><span class="var type1" id="S22T3U470">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U472">l_2</span></span>*<span class="var type1" id="S25T3U473">m_2</span></span>*<span class="mxinfo " id="T3:U355"><span class="var type1" id="S40T3U475">x_2</span>^2</span></span>*<span class="mxinfo " id="T3:U357">sin(<span class="mxinfo " id="T3:U358"><span class="var type1" id="S39T3U480">x_1</span> - <span class="var type1" id="S41T3U481">x_3</span></span>)</span></span></span>)</span></span> + <span class="mxinfo " id="T3:U361"><span class="mxinfo " id="T3:U362"><span class="mxinfo " id="T3:U363"><span class="mxinfo " id="T3:U364"><span class="mxinfo " id="T3:U365"><span class="mxinfo " id="T3:U366">6</span>*<span class="var type1" id="S22T3U488">l_1</span></span>*<span class="var type1" id="S23T3U489">l_2</span></span>*<span class="var type1" id="S24T3U490">m_1</span></span>*<span class="var type1" id="S13T3U491">u</span></span>*<span class="mxinfo " id="T3:U371">cos(<span class="var type1" id="S39T3U494">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U373"><span class="mxinfo " id="T3:U374"><span class="mxinfo " id="T3:U375"><span class="mxinfo " id="T3:U376"><span class="mxinfo " id="T3:U377"><span class="mxinfo " id="T3:U378">12</span>*<span class="var type1" id="S22T3U501">l_1</span></span>*<span class="var type1" id="S23T3U502">l_2</span></span>*<span class="var type1" id="S25T3U503">m_2</span></span>*<span class="var type1" id="S13T3U504">u</span></span>*<span class="mxinfo " id="T3:U383">cos(<span class="var type1" id="S39T3U507">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U385"><span class="mxinfo " id="T3:U386"><span class="mxinfo " id="T3:U387"><span class="mxinfo " id="T3:U388"><span class="mxinfo " id="T3:U389"><span class="mxinfo " id="T3:U390">12</span>*<span class="var type1" id="S22T3U514">l_1</span></span>*<span class="var type1" id="S23T3U515">l_2</span></span>*<span class="var type1" id="S26T3U516">m_3</span></span>*<span class="var type1" id="S13T3U517">u</span></span>*<span class="mxinfo " id="T3:U395">cos(<span class="var type1" id="S39T3U520">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U397"><span class="mxinfo " id="T3:U398"><span class="mxinfo " id="T3:U399"><span class="mxinfo " id="T3:U400"><span class="mxinfo " id="T3:U401"><span class="mxinfo " id="T3:U402">6</span>*<span class="var type1" id="S21T3U527">g</span></span>*<span class="var type1" id="S22T3U528">l_1</span></span>*<span class="var type1" id="S23T3U529">l_2</span></span>*<span class="var type1" id="S24T3U530">m_1</span></span>*<span class="mxinfo " id="T3:U407">sin(<span class="var type1" id="S39T3U533">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U409"><span class="mxinfo " id="T3:U410"><span class="mxinfo " id="T3:U411"><span class="mxinfo " id="T3:U412"><span class="mxinfo " id="T3:U413"><span class="mxinfo " id="T3:U414">12</span>*<span class="var type1" id="S21T3U540">g</span></span>*<span class="var type1" id="S22T3U541">l_1</span></span>*<span class="var type1" id="S23T3U542">l_2</span></span>*<span class="var type1" id="S25T3U543">m_2</span></span>*<span class="mxinfo " id="T3:U419">sin(<span class="var type1" id="S39T3U546">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U421"><span class="mxinfo " id="T3:U422"><span class="mxinfo " id="T3:U423"><span class="mxinfo " id="T3:U424"><span class="mxinfo " id="T3:U425"><span class="mxinfo " id="T3:U426">12</span>*<span class="var type1" id="S21T3U553">g</span></span>*<span class="var type1" id="S22T3U554">l_1</span></span>*<span class="var type1" id="S23T3U555">l_2</span></span>*<span class="var type1" id="S26T3U556">m_3</span></span>*<span class="mxinfo " id="T3:U431">sin(<span class="var type1" id="S39T3U559">x_1</span>)</span></span></span> - <span class="mxinfo " id="T3:U433"><span class="mxinfo " id="T3:U434"><span class="mxinfo " id="T3:U435"><span class="mxinfo " id="T3:U436"><span class="mxinfo " id="T3:U437"><span class="mxinfo " id="T3:U438">6</span>*<span class="var type1" id="S22T3U566">l_1</span></span>*<span class="mxinfo " id="T3:U440"><span class="var type1" id="S23T3U568">l_2</span>^2</span></span>*<span class="var type1" id="S25T3U570">m_2</span></span>*<span class="mxinfo " id="T3:U443"><span class="var type1" id="S42T3U572">x_4</span>^2</span></span>*<span class="mxinfo " id="T3:U445">sin(<span class="mxinfo " id="T3:U446"><span class="var type1" id="S39T3U577">x_1</span> - <span class="var type1" id="S41T3U578">x_3</span></span>)</span></span></span>)</span>)/(<span class="mxinfo " id="T3:U449"><span class="mxinfo " id="T3:U450"><span class="mxinfo " id="T3:U451"><span class="var type1" id="S22T3U583">l_1</span>^2</span>*<span class="var type1" id="S23T3U585">l_2</span></span>*(<span class="mxinfo " id="T3:U454"><span class="mxinfo " id="T3:U455"><span class="mxinfo " id="T3:U456"><span class="mxinfo " id="T3:U457"><span class="mxinfo " id="T3:U458">4</span>*<span class="var type1" id="S24T3U592">m_1</span></span> + <span class="mxinfo " id="T3:U460"><span class="mxinfo " id="T3:U461">12</span>*<span class="var type1" id="S25T3U595">m_2</span></span></span> + <span class="mxinfo " id="T3:U463"><span class="mxinfo " id="T3:U464">12</span>*<span class="var type1" id="S26T3U598">m_3</span></span></span> - <span class="mxinfo " id="T3:U466"><span class="mxinfo " id="T3:U467"><span class="mxinfo " id="T3:U468">9</span>*<span class="var type1" id="S25T3U602">m_2</span></span>*<span class="mxinfo " id="T3:U470"><span class="mxinfo " id="T3:U471">cos(<span class="mxinfo " id="T3:U472"><span class="var type1" id="S39T3U607">x_1</span> - <span class="var type1" id="S41T3U608">x_3</span></span>)</span>^2</span></span></span>)</span>)</span></span>;<span class="mxinfo " id="T3:U475"><span class="var type1" id="S41T3U612">x_3</span> + <span class="mxinfo " id="T3:U477"><span class="var type1" id="S12T3U614">T</span>*<span class="var type1" id="S42T3U615">x_4</span></span></span>;<span class="mxinfo " id="T3:U480"><span class="var type1" id="S42T3U618">x_4</span> + <span class="mxinfo " id="T3:U482">(<span class="mxinfo " id="T3:U483"><span class="var type1" id="S12T3U622">T</span>*(<span class="mxinfo " id="T3:U485"><span class="mxinfo " id="T3:U486"><span class="mxinfo " id="T3:U487"><span class="mxinfo " id="T3:U488"><span class="mxinfo " id="T3:U489"><span class="mxinfo " id="T3:U490"><span class="mxinfo " id="T3:U491"><span class="mxinfo " id="T3:U492"><span class="mxinfo " id="T3:U493"><span class="mxinfo " id="T3:U494"><span class="mxinfo " id="T3:U495"><span class="mxinfo " id="T3:U496"><span class="mxinfo " id="T3:U497"><span class="mxinfo " id="T3:U498"><span class="mxinfo " id="T3:U499"><span class="mxinfo " id="T3:U500"><span class="mxinfo " id="T3:U501"><span class="mxinfo " id="T3:U502"><span class="mxinfo " id="T3:U503"><span class="mxinfo " id="T3:U504"><span class="mxinfo " id="T3:U505"><span class="mxinfo " id="T3:U506"><span class="mxinfo " id="T3:U507"><span class="mxinfo " id="T3:U508">sin(<span class="mxinfo " id="T3:U509"><span class="var type1" id="S39T3U650">x_1</span> - <span class="var type1" id="S41T3U651">x_3</span></span>)</span>*(<span class="mxinfo " id="T3:U512"><span class="mxinfo " id="T3:U513"><span class="mxinfo " id="T3:U514"><span class="mxinfo " id="T3:U515"><span class="mxinfo " id="T3:U516"><span class="mxinfo " id="T3:U517"><span class="mxinfo " id="T3:U518">36</span>*<span class="mxinfo " id="T3:U519"><span class="var type1" id="S22T3U661">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U663">l_2</span></span>*<span class="mxinfo " id="T3:U522"><span class="var type1" id="S25T3U665">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U524"><span class="var type1" id="S40T3U668">x_2</span>^2</span></span> + <span class="mxinfo " id="T3:U526"><span class="mxinfo " id="T3:U527"><span class="mxinfo " id="T3:U528"><span class="mxinfo " id="T3:U529"><span class="mxinfo " id="T3:U530"><span class="mxinfo " id="T3:U531">12</span>*<span class="mxinfo " id="T3:U532"><span class="var type1" id="S22T3U677">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U679">l_2</span></span>*<span class="var type1" id="S24T3U680">m_1</span></span>*<span class="var type1" id="S25T3U681">m_2</span></span>*<span class="mxinfo " id="T3:U537"><span class="var type1" id="S40T3U683">x_2</span>^2</span></span></span> + <span class="mxinfo " id="T3:U539"><span class="mxinfo " id="T3:U540"><span class="mxinfo " id="T3:U541"><span class="mxinfo " id="T3:U542"><span class="mxinfo " id="T3:U543"><span class="mxinfo " id="T3:U544">36</span>*<span class="mxinfo " id="T3:U545"><span class="var type1" id="S22T3U692">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U694">l_2</span></span>*<span class="var type1" id="S25T3U695">m_2</span></span>*<span class="var type1" id="S26T3U696">m_3</span></span>*<span class="mxinfo " id="T3:U550"><span class="var type1" id="S40T3U698">x_2</span>^2</span></span></span>)</span> + <span class="mxinfo " id="T3:U552"><span class="mxinfo " id="T3:U553"><span class="mxinfo " id="T3:U554"><span class="mxinfo " id="T3:U555"><span class="mxinfo " id="T3:U556">24</span>*<span class="var type1" id="S28T3U705">d_p2</span></span>*<span class="var type1" id="S22T3U706">l_1</span></span>*<span class="var type1" id="S24T3U707">m_1</span></span>*<span class="var type1" id="S40T3U708">x_2</span></span></span> + <span class="mxinfo " id="T3:U561"><span class="mxinfo " id="T3:U562"><span class="mxinfo " id="T3:U563"><span class="mxinfo " id="T3:U564"><span class="mxinfo " id="T3:U565">72</span>*<span class="var type1" id="S28T3U714">d_p2</span></span>*<span class="var type1" id="S22T3U715">l_1</span></span>*<span class="var type1" id="S25T3U716">m_2</span></span>*<span class="var type1" id="S40T3U717">x_2</span></span></span> - <span class="mxinfo " id="T3:U570"><span class="mxinfo " id="T3:U571"><span class="mxinfo " id="T3:U572"><span class="mxinfo " id="T3:U573"><span class="mxinfo " id="T3:U574">24</span>*<span class="var type1" id="S28T3U723">d_p2</span></span>*<span class="var type1" id="S22T3U724">l_1</span></span>*<span class="var type1" id="S24T3U725">m_1</span></span>*<span class="var type1" id="S42T3U726">x_4</span></span></span> + <span class="mxinfo " id="T3:U579"><span class="mxinfo " id="T3:U580"><span class="mxinfo " id="T3:U581"><span class="mxinfo " id="T3:U582"><span class="mxinfo " id="T3:U583">72</span>*<span class="var type1" id="S28T3U732">d_p2</span></span>*<span class="var type1" id="S22T3U733">l_1</span></span>*<span class="var type1" id="S26T3U734">m_3</span></span>*<span class="var type1" id="S40T3U735">x_2</span></span></span> - <span class="mxinfo " id="T3:U588"><span class="mxinfo " id="T3:U589"><span class="mxinfo " id="T3:U590"><span class="mxinfo " id="T3:U591"><span class="mxinfo " id="T3:U592">72</span>*<span class="var type1" id="S28T3U741">d_p2</span></span>*<span class="var type1" id="S22T3U742">l_1</span></span>*<span class="var type1" id="S25T3U743">m_2</span></span>*<span class="var type1" id="S42T3U744">x_4</span></span></span> - <span class="mxinfo " id="T3:U597"><span class="mxinfo " id="T3:U598"><span class="mxinfo " id="T3:U599"><span class="mxinfo " id="T3:U600"><span class="mxinfo " id="T3:U601">72</span>*<span class="var type1" id="S28T3U750">d_p2</span></span>*<span class="var type1" id="S22T3U751">l_1</span></span>*<span class="var type1" id="S26T3U752">m_3</span></span>*<span class="var type1" id="S42T3U753">x_4</span></span></span> + <span class="mxinfo " id="T3:U606"><span class="mxinfo " id="T3:U607"><span class="mxinfo " id="T3:U608"><span class="mxinfo " id="T3:U609"><span class="mxinfo " id="T3:U610"><span class="mxinfo " id="T3:U611">36</span>*<span class="var type1" id="S27T3U760">d_p1</span></span>*<span class="var type1" id="S23T3U761">l_2</span></span>*<span class="var type1" id="S25T3U762">m_2</span></span>*<span class="var type1" id="S40T3U763">x_2</span></span>*<span class="mxinfo " id="T3:U616">cos(<span class="mxinfo " id="T3:U617"><span class="var type1" id="S39T3U767">x_1</span> - <span class="var type1" id="S41T3U768">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T3:U620"><span class="mxinfo " id="T3:U621"><span class="mxinfo " id="T3:U622"><span class="mxinfo " id="T3:U623"><span class="mxinfo " id="T3:U624"><span class="mxinfo " id="T3:U625">36</span>*<span class="var type1" id="S28T3U775">d_p2</span></span>*<span class="var type1" id="S23T3U776">l_2</span></span>*<span class="var type1" id="S25T3U777">m_2</span></span>*<span class="var type1" id="S40T3U778">x_2</span></span>*<span class="mxinfo " id="T3:U630">cos(<span class="mxinfo " id="T3:U631"><span class="var type1" id="S39T3U782">x_1</span> - <span class="var type1" id="S41T3U783">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U634"><span class="mxinfo " id="T3:U635"><span class="mxinfo " id="T3:U636"><span class="mxinfo " id="T3:U637"><span class="mxinfo " id="T3:U638"><span class="mxinfo " id="T3:U639">36</span>*<span class="var type1" id="S28T3U790">d_p2</span></span>*<span class="var type1" id="S23T3U791">l_2</span></span>*<span class="var type1" id="S25T3U792">m_2</span></span>*<span class="var type1" id="S42T3U793">x_4</span></span>*<span class="mxinfo " id="T3:U644">cos(<span class="mxinfo " id="T3:U645"><span class="var type1" id="S39T3U797">x_1</span> - <span class="var type1" id="S41T3U798">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T3:U648"><span class="mxinfo " id="T3:U649"><span class="mxinfo " id="T3:U650"><span class="mxinfo " id="T3:U651"><span class="mxinfo " id="T3:U652"><span class="mxinfo " id="T3:U653">18</span>*<span class="var type1" id="S22T3U805">l_1</span></span>*<span class="var type1" id="S23T3U806">l_2</span></span>*<span class="mxinfo " id="T3:U656"><span class="var type1" id="S25T3U808">m_2</span>^2</span></span>*<span class="var type1" id="S13T3U810">u</span></span>*<span class="mxinfo " id="T3:U659">cos(<span class="var type1" id="S41T3U813">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U661"><span class="mxinfo " id="T3:U662"><span class="mxinfo " id="T3:U663"><span class="mxinfo " id="T3:U664"><span class="mxinfo " id="T3:U665"><span class="mxinfo " id="T3:U666">18</span>*<span class="var type1" id="S21T3U820">g</span></span>*<span class="var type1" id="S22T3U821">l_1</span></span>*<span class="var type1" id="S23T3U822">l_2</span></span>*<span class="mxinfo " id="T3:U670"><span class="var type1" id="S25T3U824">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U672">sin(<span class="var type1" id="S41T3U828">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U674"><span class="mxinfo " id="T3:U675"><span class="mxinfo " id="T3:U676"><span class="mxinfo " id="T3:U677"><span class="mxinfo " id="T3:U678"><span class="mxinfo " id="T3:U679">9</span>*<span class="var type1" id="S22T3U835">l_1</span></span>*<span class="mxinfo " id="T3:U681"><span class="var type1" id="S23T3U837">l_2</span>^2</span></span>*<span class="mxinfo " id="T3:U683"><span class="var type1" id="S25T3U840">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U685"><span class="var type1" id="S42T3U843">x_4</span>^2</span></span>*<span class="mxinfo " id="T3:U687">sin(<span class="mxinfo " id="T3:U688"><span class="mxinfo " id="T3:U689"><span class="mxinfo " id="T3:U690">2</span>*<span class="var type1" id="S39T3U850">x_1</span></span> - <span class="mxinfo " id="T3:U692"><span class="mxinfo " id="T3:U693">2</span>*<span class="var type1" id="S41T3U853">x_3</span></span></span>)</span></span></span> - <span class="mxinfo " id="T3:U695"><span class="mxinfo " id="T3:U696"><span class="mxinfo " id="T3:U697"><span class="mxinfo " id="T3:U698"><span class="mxinfo " id="T3:U699"><span class="mxinfo " id="T3:U700">18</span>*<span class="var type1" id="S22T3U860">l_1</span></span>*<span class="var type1" id="S23T3U861">l_2</span></span>*<span class="mxinfo " id="T3:U703"><span class="var type1" id="S25T3U863">m_2</span>^2</span></span>*<span class="var type1" id="S13T3U865">u</span></span>*<span class="mxinfo " id="T3:U706">cos(<span class="mxinfo " id="T3:U707"><span class="mxinfo " id="T3:U708"><span class="mxinfo " id="T3:U709">2</span>*<span class="var type1" id="S39T3U871">x_1</span></span> - <span class="var type1" id="S41T3U872">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U712"><span class="mxinfo " id="T3:U713"><span class="mxinfo " id="T3:U714"><span class="mxinfo " id="T3:U715"><span class="mxinfo " id="T3:U716"><span class="mxinfo " id="T3:U717">18</span>*<span class="var type1" id="S21T3U879">g</span></span>*<span class="var type1" id="S22T3U880">l_1</span></span>*<span class="var type1" id="S23T3U881">l_2</span></span>*<span class="mxinfo " id="T3:U721"><span class="var type1" id="S25T3U883">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U723">sin(<span class="mxinfo " id="T3:U724"><span class="mxinfo " id="T3:U725"><span class="mxinfo " id="T3:U726">2</span>*<span class="var type1" id="S39T3U890">x_1</span></span> - <span class="var type1" id="S41T3U891">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T3:U729"><span class="mxinfo " id="T3:U730"><span class="mxinfo " id="T3:U731"><span class="mxinfo " id="T3:U732"><span class="mxinfo " id="T3:U733"><span class="mxinfo " id="T3:U734"><span class="mxinfo " id="T3:U735">3</span>*<span class="var type1" id="S22T3U899">l_1</span></span>*<span class="var type1" id="S23T3U900">l_2</span></span>*<span class="var type1" id="S24T3U901">m_1</span></span>*<span class="var type1" id="S25T3U902">m_2</span></span>*<span class="var type1" id="S13T3U903">u</span></span>*<span class="mxinfo " id="T3:U741">cos(<span class="var type1" id="S41T3U906">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U743"><span class="mxinfo " id="T3:U744"><span class="mxinfo " id="T3:U745"><span class="mxinfo " id="T3:U746"><span class="mxinfo " id="T3:U747"><span class="mxinfo " id="T3:U748"><span class="mxinfo " id="T3:U749">18</span>*<span class="var type1" id="S22T3U914">l_1</span></span>*<span class="var type1" id="S23T3U915">l_2</span></span>*<span class="var type1" id="S25T3U916">m_2</span></span>*<span class="var type1" id="S26T3U917">m_3</span></span>*<span class="var type1" id="S13T3U918">u</span></span>*<span class="mxinfo " id="T3:U755">cos(<span class="var type1" id="S41T3U921">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U757"><span class="mxinfo " id="T3:U758"><span class="mxinfo " id="T3:U759"><span class="mxinfo " id="T3:U760"><span class="mxinfo " id="T3:U761"><span class="mxinfo " id="T3:U762"><span class="mxinfo " id="T3:U763">3</span>*<span class="var type1" id="S21T3U929">g</span></span>*<span class="var type1" id="S22T3U930">l_1</span></span>*<span class="var type1" id="S23T3U931">l_2</span></span>*<span class="var type1" id="S24T3U932">m_1</span></span>*<span class="var type1" id="S25T3U933">m_2</span></span>*<span class="mxinfo " id="T3:U769">sin(<span class="var type1" id="S41T3U936">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U771"><span class="mxinfo " id="T3:U772"><span class="mxinfo " id="T3:U773"><span class="mxinfo " id="T3:U774"><span class="mxinfo " id="T3:U775"><span class="mxinfo " id="T3:U776"><span class="mxinfo " id="T3:U777">18</span>*<span class="var type1" id="S21T3U944">g</span></span>*<span class="var type1" id="S22T3U945">l_1</span></span>*<span class="var type1" id="S23T3U946">l_2</span></span>*<span class="var type1" id="S25T3U947">m_2</span></span>*<span class="var type1" id="S26T3U948">m_3</span></span>*<span class="mxinfo " id="T3:U783">sin(<span class="var type1" id="S41T3U951">x_3</span>)</span></span></span> - <span class="mxinfo " id="T3:U785"><span class="mxinfo " id="T3:U786"><span class="mxinfo " id="T3:U787"><span class="mxinfo " id="T3:U788"><span class="mxinfo " id="T3:U789"><span class="mxinfo " id="T3:U790"><span class="mxinfo " id="T3:U791">9</span>*<span class="var type1" id="S22T3U959">l_1</span></span>*<span class="var type1" id="S23T3U960">l_2</span></span>*<span class="var type1" id="S24T3U961">m_1</span></span>*<span class="var type1" id="S25T3U962">m_2</span></span>*<span class="var type1" id="S13T3U963">u</span></span>*<span class="mxinfo " id="T3:U797">cos(<span class="mxinfo " id="T3:U798"><span class="mxinfo " id="T3:U799"><span class="mxinfo " id="T3:U800">2</span>*<span class="var type1" id="S39T3U969">x_1</span></span> - <span class="var type1" id="S41T3U970">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U803"><span class="mxinfo " id="T3:U804"><span class="mxinfo " id="T3:U805"><span class="mxinfo " id="T3:U806"><span class="mxinfo " id="T3:U807"><span class="mxinfo " id="T3:U808"><span class="mxinfo " id="T3:U809">18</span>*<span class="var type1" id="S22T3U978">l_1</span></span>*<span class="var type1" id="S23T3U979">l_2</span></span>*<span class="var type1" id="S25T3U980">m_2</span></span>*<span class="var type1" id="S26T3U981">m_3</span></span>*<span class="var type1" id="S13T3U982">u</span></span>*<span class="mxinfo " id="T3:U815">cos(<span class="mxinfo " id="T3:U816"><span class="mxinfo " id="T3:U817"><span class="mxinfo " id="T3:U818">2</span>*<span class="var type1" id="S39T3U988">x_1</span></span> - <span class="var type1" id="S41T3U989">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U821"><span class="mxinfo " id="T3:U822"><span class="mxinfo " id="T3:U823"><span class="mxinfo " id="T3:U824"><span class="mxinfo " id="T3:U825"><span class="mxinfo " id="T3:U826"><span class="mxinfo " id="T3:U827">9</span>*<span class="var type1" id="S21T3U997">g</span></span>*<span class="var type1" id="S22T3U998">l_1</span></span>*<span class="var type1" id="S23T3U999">l_2</span></span>*<span class="var type1" id="S24T3U1000">m_1</span></span>*<span class="var type1" id="S25T3U1001">m_2</span></span>*<span class="mxinfo " id="T3:U833">sin(<span class="mxinfo " id="T3:U834"><span class="mxinfo " id="T3:U835"><span class="mxinfo " id="T3:U836">2</span>*<span class="var type1" id="S39T3U1007">x_1</span></span> - <span class="var type1" id="S41T3U1008">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U839"><span class="mxinfo " id="T3:U840"><span class="mxinfo " id="T3:U841"><span class="mxinfo " id="T3:U842"><span class="mxinfo " id="T3:U843"><span class="mxinfo " id="T3:U844"><span class="mxinfo " id="T3:U845">18</span>*<span class="var type1" id="S21T3U1016">g</span></span>*<span class="var type1" id="S22T3U1017">l_1</span></span>*<span class="var type1" id="S23T3U1018">l_2</span></span>*<span class="var type1" id="S25T3U1019">m_2</span></span>*<span class="var type1" id="S26T3U1020">m_3</span></span>*<span class="mxinfo " id="T3:U851">sin(<span class="mxinfo " id="T3:U852"><span class="mxinfo " id="T3:U853"><span class="mxinfo " id="T3:U854">2</span>*<span class="var type1" id="S39T3U1026">x_1</span></span> - <span class="var type1" id="S41T3U1027">x_3</span></span>)</span></span></span>)</span>)/(<span class="mxinfo " id="T3:U857"><span class="mxinfo " id="T3:U858"><span class="mxinfo " id="T3:U859"><span class="var type1" id="S22T3U1032">l_1</span>*<span class="mxinfo " id="T3:U861"><span class="var type1" id="S23T3U1034">l_2</span>^2</span></span>*<span class="var type1" id="S25T3U1036">m_2</span></span>*(<span class="mxinfo " id="T3:U864"><span class="mxinfo " id="T3:U865"><span class="mxinfo " id="T3:U866"><span class="mxinfo " id="T3:U867"><span class="mxinfo " id="T3:U868">8</span>*<span class="var type1" id="S24T3U1043">m_1</span></span> + <span class="mxinfo " id="T3:U870"><span class="mxinfo " id="T3:U871">15</span>*<span class="var type1" id="S25T3U1046">m_2</span></span></span> + <span class="mxinfo " id="T3:U873"><span class="mxinfo " id="T3:U874">24</span>*<span class="var type1" id="S26T3U1049">m_3</span></span></span> - <span class="mxinfo " id="T3:U876"><span class="mxinfo " id="T3:U877"><span class="mxinfo " id="T3:U878">9</span>*<span class="var type1" id="S25T3U1053">m_2</span></span>*<span class="mxinfo " id="T3:U880">cos(<span class="mxinfo " id="T3:U881"><span class="mxinfo " id="T3:U882"><span class="mxinfo " id="T3:U883">2</span>*<span class="var type1" id="S39T3U1059">x_1</span></span> - <span class="mxinfo " id="T3:U885"><span class="mxinfo " id="T3:U886">2</span>*<span class="var type1" id="S41T3U1062">x_3</span></span></span>)</span></span></span>)</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo " id="T6:U888"><span class="var type1" id="S45T6U1065">y_sig</span>= <span class="mxinfo " id="T6:U890"><span class="mxinfo " id="T11:U891">[1 0 0 0]</span> * <span class="var type1" id="S18T5U1073">x_sig</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">% Prediction, weighted sum</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo " id="T1:U893"><span class="var type1" id="S15T1U1076">x_p</span>  = <span class="mxinfo " id="T1:U895"><span class="var type1" id="S18T5U1078">x_sig</span> * <span class="mxinfo " id="T10:U897"><span class="var type1" id="S19T6U1080">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="mxinfo " id="T3:U899"><span class="var type1" id="S46T3U1083">y_</span>  = <span class="mxinfo " id="T3:U901"><span class="var type1" id="S45T6U1085">y_sig</span> * <span class="mxinfo " id="T10:U903"><span class="var type1" id="S19T6U1087">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">%P_p calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo " id="T2:U905"><span class="var type1" id="S16T2U1090">P_p</span> = <span class="mxinfo " id="T2:U907"><span class="var type1" id="S16T2U1092">P_p</span> .* <span class="mxinfo " id="T3:U909">0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1096">i</span>=<span class="mxinfo " id="T10:U911"><span class="mxinfo " id="T3:U912">1</span>:(2*<span class="var type1" id="S29T3U1103">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo " id="T2:U914"><span class="var type1" id="S16T2U1107">P_p</span> = <span class="mxinfo " id="T2:U916"><span class="var type1" id="S16T2U1109">P_p</span> + (<span class="mxinfo " id="T2:U918"><span class="mxinfo " id="T2:U919">(<span class="mxinfo " id="T1:U920"><span class="mxinfo " id="T1:U921"><span class="var type1" id="S18T5U1116">x_sig</span>(<span class="mxinfo " id="T9:U923">:</span>,<span class="var type1" id="S34T3U1118">i</span>)</span> - <span class="var type1" id="S15T1U1119">x_p</span></span>) * <span class="mxinfo " id="T11:U926">(<span class="mxinfo " id="T1:U927"><span class="mxinfo " id="T1:U928"><span class="var type1" id="S18T5U1124">x_sig</span>(<span class="mxinfo " id="T9:U930">:</span>,<span class="var type1" id="S34T3U1126">i</span>)</span> - <span class="var type1" id="S15T1U1127">x_p</span></span>)'</span></span> .* <span class="mxinfo " id="T3:U933"><span class="var type1" id="S20T6U1129">W_c</span>(<span class="mxinfo " id="T3:U935">1</span>,<span class="var type1" id="S34T3U1131">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="mxinfo " id="T2:U937"><span class="var type1" id="S16T2U1134">P_p</span>  = <span class="mxinfo " id="T2:U939"><span class="var type1" id="S16T2U1136">P_p</span> + <span class="var type1" id="S5T2U1137">Q</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%% Unscented Kalman filter measurement update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">% Pyy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo " id="T3:U942"><span class="var type1" id="S47T3U1140">P_yy</span> = <span class="mxinfo " id="T3:U944">zeros(<span class="var type1" id="S30T3U1143">o_ukf</span>,<span class="var type1" id="S30T3U1144">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1147">i</span>=<span class="mxinfo " id="T10:U948"><span class="mxinfo " id="T3:U949">1</span>:(2*<span class="var type1" id="S29T3U1154">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="mxinfo " id="T3:U951"><span class="var type1" id="S47T3U1158">P_yy</span> = <span class="mxinfo " id="T3:U953"><span class="var type1" id="S47T3U1160">P_yy</span> + (<span class="mxinfo " id="T3:U955"><span class="mxinfo " id="T3:U956">(<span class="mxinfo " id="T3:U957"><span class="mxinfo " id="T3:U958"><span class="var type1" id="S45T6U1167">y_sig</span>(<span class="mxinfo " id="T7:U960">:</span>,<span class="var type1" id="S34T3U1169">i</span>)</span> - <span class="var type1" id="S46T3U1170">y_</span></span>) * (<span class="mxinfo " id="T3:U963"><span class="mxinfo " id="T3:U964"><span class="var type1" id="S45T6U1175">y_sig</span>(<span class="mxinfo " id="T7:U966">:</span>,<span class="var type1" id="S34T3U1177">i</span>)</span> - <span class="var type1" id="S46T3U1178">y_</span></span>)'</span> .* <span class="mxinfo " id="T3:U969"><span class="var type1" id="S20T6U1180">W_c</span>(<span class="mxinfo " id="T3:U971">1</span>,<span class="var type1" id="S34T3U1182">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo " id="T3:U973"><span class="var type1" id="S47T3U1185">P_yy</span> = <span class="mxinfo " id="T3:U975"><span class="var type1" id="S47T3U1187">P_yy</span> + <span class="var type1" id="S6T3U1188">R</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="comment">% Pxy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo " id="T1:U978"><span class="var type1" id="S48T1U1191">P_xy</span> = <span class="mxinfo " id="T1:U980">zeros(<span class="var type1" id="S29T3U1194">n_ukf</span>,<span class="var type1" id="S30T3U1195">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1198">i</span>=<span class="mxinfo " id="T10:U984"><span class="mxinfo " id="T3:U985">1</span>:(2*<span class="var type1" id="S29T3U1205">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="mxinfo " id="T1:U987"><span class="var type1" id="S48T1U1209">P_xy</span> = <span class="mxinfo " id="T1:U989"><span class="var type1" id="S48T1U1211">P_xy</span>+(<span class="mxinfo " id="T1:U991"><span class="mxinfo " id="T1:U992">(<span class="mxinfo " id="T1:U993"><span class="mxinfo " id="T1:U994"><span class="var type1" id="S18T5U1218">x_sig</span>(<span class="mxinfo " id="T9:U996">:</span>,<span class="var type1" id="S34T3U1220">i</span>)</span>-<span class="var type1" id="S15T1U1221">x_p</span></span>)*(<span class="mxinfo " id="T3:U999"><span class="mxinfo " id="T3:U1000"><span class="var type1" id="S45T6U1226">y_sig</span>(<span class="mxinfo " id="T7:U1002">:</span>,<span class="var type1" id="S34T3U1228">i</span>)</span>-<span class="var type1" id="S46T3U1229">y_</span></span>)'</span>.*<span class="mxinfo " id="T3:U1005"><span class="var type1" id="S20T6U1231">W_c</span>(<span class="mxinfo " id="T3:U1007">1</span>,<span class="var type1" id="S34T3U1233">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="comment">% Kalman Gain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo " id="T1:U1009"><span class="var type1" id="S3T1U1236">K</span>  = <span class="mxinfo " id="T1:U1011"><span class="var type1" id="S48T1U1238">P_xy</span>/(<span class="var type1" id="S47T3U1240">P_yy</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo " id="T2:U1014"><span class="var type1" id="S16T2U1243">P_p</span> = <span class="mxinfo " id="T2:U1016"><span class="var type1" id="S16T2U1245">P_p</span> - (<span class="mxinfo " id="T2:U1018"><span class="mxinfo " id="T1:U1019"><span class="var type1" id="S3T1U1249">K</span> * <span class="var type1" id="S47T3U1250">P_yy</span></span> * <span class="mxinfo " id="T11:U1022"><span class="var type1" id="S3T1U1252">K</span>'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo " id="T1:U1024"><span class="var type1" id="S2T1U1255">x</span>  = <span class="mxinfo " id="T1:U1026"><span class="var type1" id="S15T1U1257">x_p</span> +  <span class="mxinfo " id="T1:U1028"><span class="var type1" id="S3T1U1259">K</span> * ( <span class="mxinfo " id="T3:U1030"><span class="var type1" id="S14T3U1262">y</span> - <span class="var type1" id="S46T3U1263">y_</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo " id="T1:U1033"><span class="var type1" id="S15T1U1266">x_p</span> = <span class="var type1" id="S2T1U1267">x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
