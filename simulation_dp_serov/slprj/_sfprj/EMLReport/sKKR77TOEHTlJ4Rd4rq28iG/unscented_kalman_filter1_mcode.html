<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">x</span>,<span class="var type1" id="S3T1U4">K</span>] = unscented_kalman_filter(<span class="var type1" id="S4T2U7">P</span>, <span class="var type1" id="S5T3U8">Q</span>, <span class="var type1" id="S6T4U9">R</span>, <span class="var type1" id="S7T1U10">x0</span>, <span class="var type1" id="S8T4U11">alpha_ukf</span>, <span class="var type1" id="S9T4U12">beta_ukf</span>, <span class="var type1" id="S10T4U13">kappa_ukf</span>, <span class="var type1" id="S11T5U14">para_sys</span>, <span class="var type1" id="S12T4U15">T</span>, <span class="var type1" id="S13T4U16">u</span>, <span class="var type1" id="S14T4U17">y</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Unscented Kalman Filter (UKF) fuer nichtlineare Systeme</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% Das UKF praediziert den Zustand eines nichtliniearen Systems durch</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Mittelung sog. Sigma Punkte. Dazu werden 2n+1 Sigmapunkte (moegliche</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Zustaende des Systems) mittels Kovarianzmatrix P berechnet und fuer jeden</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% Sigmapunkt mithilfe der Zustandsgleichung ein neuer Zustand praediziert.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% Diese werden gewichtet gemittelt und mit deren Hilfe die neuen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% Kovarianzmatrizen, die Rueckfuehrmatrix K und die Zustaende ermittelt.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% Weitere Infos unter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% http://www.agnld.uni-potsdam.de/~shw/TSA/Tools/UKF/node4.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% http://cslu.cse.ogi.edu/nsel/ukf/node6.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% Tipp: kappa meist zu 0 waehlen, alpha sehr klein bspw. 0.001, beta bei</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% Gaussverteilung = 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% -alpha bestimmt die Streuung der Sigma-Punkte um den Mittelwert</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% -beta wird benutzt, um Wissen ueber die Verteilung aufzunehmen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">% -kappa ist ein sekundaerer skalierender Parameter, der gewoehnlich </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% gleich 0 oder 3-n gesetzt wird</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% Vorlage von Matthias Dagen, September 2009, veraendert durch David</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% Klinkenbuss</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S15T1U19">x_p</span> <span class="var type1" id="S16T2U20">P_p</span> <span class="var type1" id="S17T6U21">x0_sig</span> <span class="var type1" id="S18T6U22">x_sig</span> <span class="var type1" id="S19T7U23">W_m</span> <span class="var type1" id="S20T7U24">W_c</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">% Parameter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo " id="T4:U20"><span class="var type1" id="S21T4U27">g</span> = <span class="mxinfo " id="T4:U22"><span class="var type1" id="S11T5U29">para_sys</span>(<span class="mxinfo " id="T4:U24">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo " id="T4:U25"><span class="var type1" id="S22T4U33">l_1</span> = <span class="mxinfo " id="T4:U27"><span class="var type1" id="S11T5U35">para_sys</span>(<span class="mxinfo " id="T8:U29">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo " id="T4:U30"><span class="var type1" id="S23T4U39">l_2</span> = <span class="mxinfo " id="T4:U32"><span class="var type1" id="S11T5U41">para_sys</span>(<span class="mxinfo " id="T8:U34">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo " id="T4:U35"><span class="var type1" id="S24T4U45">m_1</span> = <span class="mxinfo " id="T4:U37"><span class="var type1" id="S11T5U47">para_sys</span>(<span class="mxinfo " id="T4:U39">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T4:U40"><span class="var type1" id="S25T4U51">m_2</span> = <span class="mxinfo " id="T4:U42"><span class="var type1" id="S11T5U53">para_sys</span>(<span class="mxinfo " id="T8:U44">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo " id="T4:U45"><span class="var type1" id="S26T4U57">m_3</span> = <span class="mxinfo " id="T4:U47"><span class="var type1" id="S11T5U59">para_sys</span>(<span class="mxinfo " id="T4:U49">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T4:U50"><span class="var type1" id="S27T4U63">d_p1</span> = <span class="mxinfo " id="T4:U52"><span class="var type1" id="S11T5U65">para_sys</span>(<span class="mxinfo " id="T4:U54">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo " id="T4:U55"><span class="var type1" id="S28T4U69">d_p2</span> = <span class="mxinfo " id="T4:U57"><span class="var type1" id="S11T5U71">para_sys</span>(<span class="mxinfo " id="T4:U59">8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T4:U60"><span class="var type1" id="S29T4U75">n_ukf</span>  = <span class="mxinfo " id="T4:U62">4</span></span>;     <span class="comment">% Laenge von f(x)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo " id="T4:U63"><span class="var type1" id="S30T4U79">o_ukf</span> = <span class="mxinfo " id="T4:U65">1</span></span>;      <span class="comment">% Anzahl der zurueckgefuehrten Variablen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T9:U66">isempty(<span class="var type0" id="S15T0U90">x_p</span>)</span> || <span class="mxinfo " id="T9:U67">isempty(<span class="var type0" id="S16T0U93">P_p</span>)</span> || <span class="mxinfo " id="T9:U68">isempty(<span class="var type0" id="S17T0U96">x0_sig</span>)</span> || <span class="mxinfo " id="T9:U69">isempty(<span class="var type0" id="S18T0U99">x_sig</span>)</span> || <span class="mxinfo " id="T9:U70">isempty(<span class="var type0" id="S19T0U102">W_m</span>)</span> || <span class="mxinfo " id="T9:U71">isempty(<span class="var type0" id="S20T0U105">W_c</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo " id="T1:U72"><span class="var type1" id="S15T1U108">x_p</span> = <span class="var type1" id="S7T1U109">x0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo " id="T2:U75"><span class="var type1" id="S16T2U112">P_p</span> = <span class="var type1" id="S4T2U113">P</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T6:U78"><span class="var type1" id="S17T6U116">x0_sig</span> = <span class="mxinfo " id="T6:U80">zeros(<span class="var type1" id="S29T4U119">n_ukf</span>,<span class="mxinfo " id="T4:U82">2*<span class="var type1" id="S29T4U123">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T6:U84"><span class="var type1" id="S18T6U127">x_sig</span>  = <span class="mxinfo " id="T6:U86">zeros(<span class="var type1" id="S29T4U130">n_ukf</span>,<span class="mxinfo " id="T4:U88">2*<span class="var type1" id="S29T4U134">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T7:U90"><span class="var type1" id="S19T7U138">W_m</span> = <span class="mxinfo " id="T7:U92">zeros(<span class="mxinfo " id="T4:U93">1</span>,<span class="mxinfo " id="T4:U94">2*<span class="var type1" id="S29T4U145">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T7:U96"><span class="var type1" id="S20T7U149">W_c</span> = <span class="mxinfo " id="T7:U98">zeros(<span class="mxinfo " id="T4:U99">1</span>,<span class="mxinfo " id="T4:U100">2*<span class="var type1" id="S29T4U156">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T1:U102"><span class="var type1" id="S2T1U160">x</span> = <span class="var type1" id="S15T1U161">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo " id="T1:U105"><span class="var type1" id="S3T1U164">K</span> = <span class="mxinfo " id="T1:U107">zeros(<span class="mxinfo " id="T4:U108">4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%% Parameter-Initialization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo " id="T4:U109"><span class="var type1" id="S33T4U172">lambda_ukf</span> = <span class="mxinfo " id="T4:U111"><span class="mxinfo " id="T4:U112">(<span class="mxinfo " id="T4:U113"><span class="var type1" id="S8T4U177">alpha_ukf</span>^2</span>)*(<span class="mxinfo " id="T4:U115"><span class="var type1" id="S29T4U181">n_ukf</span>+<span class="var type1" id="S10T4U182">kappa_ukf</span></span>)</span>-<span class="var type1" id="S29T4U183">n_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%% Weight calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T4:U119"><span class="mxinfo " id="T4:U120"><span class="var type1" id="S19T7U187">W_m</span>(<span class="mxinfo " id="T4:U122">1</span>,<span class="mxinfo " id="T4:U123">1</span>)</span> = <span class="mxinfo " id="T4:U124"><span class="var type1" id="S33T4U191">lambda_ukf</span>/(<span class="mxinfo " id="T4:U126"><span class="var type1" id="S29T4U194">n_ukf</span>+<span class="var type1" id="S33T4U195">lambda_ukf</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo " id="T4:U129"><span class="mxinfo " id="T4:U130"><span class="var type1" id="S20T7U199">W_c</span>(<span class="mxinfo " id="T4:U132">1</span>,<span class="mxinfo " id="T4:U133">1</span>)</span> = <span class="mxinfo " id="T4:U134"><span class="mxinfo " id="T4:U135"><span class="mxinfo " id="T4:U136"><span class="mxinfo " id="T4:U137"><span class="var type1" id="S33T4U206">lambda_ukf</span>/(<span class="mxinfo " id="T4:U139"><span class="var type1" id="S29T4U209">n_ukf</span>+<span class="var type1" id="S33T4U210">lambda_ukf</span></span>)</span>+<span class="mxinfo " id="T4:U142">1</span></span>-<span class="mxinfo " id="T4:U143"><span class="var type1" id="S8T4U213">alpha_ukf</span>^2</span></span>+<span class="var type1" id="S9T4U215">beta_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T4U218">i</span>=<span class="mxinfo " id="T5:U147"><span class="mxinfo " id="T4:U148">2</span>:2*<span class="var type1" id="S29T4U224">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo " id="T4:U150"><span class="mxinfo " id="T4:U151"><span class="var type1" id="S19T7U229">W_m</span>(<span class="mxinfo " id="T4:U153">1</span>,<span class="var type1" id="S34T4U231">i</span>)</span> = <span class="mxinfo " id="T4:U155"><span class="mxinfo " id="T4:U156">1</span>/(<span class="mxinfo " id="T4:U157"><span class="mxinfo " id="T4:U158">2</span>*(<span class="mxinfo " id="T4:U159"><span class="var type1" id="S29T4U239">n_ukf</span>+<span class="var type1" id="S33T4U240">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo " id="T4:U162"><span class="mxinfo " id="T4:U163"><span class="var type1" id="S20T7U244">W_c</span>(<span class="mxinfo " id="T4:U165">1</span>,<span class="var type1" id="S34T4U246">i</span>)</span> = <span class="mxinfo " id="T4:U167"><span class="mxinfo " id="T4:U168">1</span>/(<span class="mxinfo " id="T4:U169"><span class="mxinfo " id="T4:U170">2</span>*(<span class="mxinfo " id="T4:U171"><span class="var type1" id="S29T4U254">n_ukf</span>+<span class="var type1" id="S33T4U255">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%% 2n+1 Sigma Points calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo " id="T2:U174"><span class="var type1" id="S35T2U258">P_an</span> = <span class="mxinfo " id="T2:U176">(<span class="mxinfo " id="T2:U177"><span class="mxinfo " id="T4:U178">sqrt(<span class="mxinfo " id="T4:U179"><span class="var type1" id="S29T4U265">n_ukf</span>+<span class="var type1" id="S33T4U266">lambda_ukf</span></span>)</span>.*<span class="mxinfo " id="T2:U182">chol(<span class="var type1" id="S16T2U269">P_p</span>)</span></span>)'</span></span>; <span class="comment">% Wurzelmatrix mittels Cholesky-Zerlegung</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo " id="T1:U184"><span class="mxinfo " id="T1:U185"><span class="var type1" id="S17T6U273">x0_sig</span>(<span class="mxinfo " id="T10:U187">:</span>,<span class="mxinfo " id="T4:U188">1</span>)</span> = <span class="var type1" id="S15T1U276">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T4U279">i</span>=<span class="mxinfo " id="T1:U191"><span class="mxinfo " id="T4:U192">2</span>:<span class="var type1" id="S29T4U283">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T1:U194"><span class="mxinfo " id="T1:U195"><span class="var type1" id="S17T6U288">x0_sig</span>(<span class="mxinfo " id="T10:U197">:</span>,<span class="var type1" id="S34T4U290">i</span>)</span>     = <span class="mxinfo " id="T1:U199"><span class="var type1" id="S15T1U292">x_p</span> + <span class="mxinfo " id="T1:U201"><span class="var type1" id="S35T2U294">P_an</span>(<span class="mxinfo " id="T10:U203">:</span>,<span class="mxinfo " id="T4:U204"><span class="var type1" id="S34T4U297">i</span>-<span class="mxinfo " id="T4:U206">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    <span class="mxinfo " id="T1:U207"><span class="mxinfo " id="T1:U208"><span class="var type1" id="S17T6U302">x0_sig</span>(<span class="mxinfo " id="T10:U210">:</span>,<span class="mxinfo " id="T4:U211"><span class="var type1" id="S29T4U305">n_ukf</span>+<span class="var type1" id="S34T4U306">i</span></span>)</span>   = <span class="mxinfo " id="T1:U214"><span class="var type1" id="S15T1U308">x_p</span> - <span class="mxinfo " id="T1:U216"><span class="var type1" id="S35T2U310">P_an</span>(<span class="mxinfo " id="T10:U218">:</span>,<span class="mxinfo " id="T4:U219"><span class="var type1" id="S34T4U313">i</span>-<span class="mxinfo " id="T4:U221">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%% Unscented Kalman filter time update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T4U317">i</span> = <span class="mxinfo " id="T11:U223"><span class="mxinfo " id="T4:U224">1</span>:(2*<span class="var type1" id="S29T4U324">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"> <span class="mxinfo " id="T4:U226"><span class="var type1" id="S38T4U328">x_1</span> = <span class="mxinfo " id="T4:U228"><span class="var type1" id="S17T6U330">x0_sig</span>(<span class="mxinfo " id="T8:U230">1</span>,<span class="var type1" id="S34T4U332">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"> <span class="mxinfo " id="T4:U232"><span class="var type1" id="S39T4U335">x_2</span> = <span class="mxinfo " id="T4:U234"><span class="var type1" id="S17T6U337">x0_sig</span>(<span class="mxinfo " id="T8:U236">2</span>,<span class="var type1" id="S34T4U339">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"> <span class="mxinfo " id="T4:U238"><span class="var type1" id="S40T4U342">x_3</span> = <span class="mxinfo " id="T4:U240"><span class="var type1" id="S17T6U344">x0_sig</span>(<span class="mxinfo " id="T8:U242">3</span>,<span class="var type1" id="S34T4U346">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"> <span class="mxinfo " id="T4:U244"><span class="var type1" id="S41T4U349">x_4</span> = <span class="mxinfo " id="T4:U246"><span class="var type1" id="S17T6U351">x0_sig</span>(<span class="mxinfo " id="T8:U248">4</span>,<span class="var type1" id="S34T4U353">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo " id="T1:U250"><span class="mxinfo " id="T1:U251"><span class="var type1" id="S18T6U357">x_sig</span>(<span class="mxinfo " id="T10:U253">:</span>,<span class="var type1" id="S34T4U359">i</span>)</span> = <span class="mxinfo " id="T1:U255">[<span class="mxinfo " id="T4:U256"><span class="var type1" id="S38T4U363">x_1</span> + <span class="mxinfo " id="T4:U258"><span class="var type1" id="S12T4U365">T</span>*<span class="var type1" id="S39T4U366">x_2</span></span></span>;<span class="mxinfo " id="T4:U261"><span class="var type1" id="S39T4U369">x_2</span> + <span class="mxinfo " id="T4:U263">(<span class="mxinfo " id="T4:U264"><span class="var type1" id="S12T4U373">T</span>*(<span class="mxinfo " id="T4:U266"><span class="mxinfo " id="T4:U267"><span class="mxinfo " id="T4:U268"><span class="mxinfo " id="T4:U269"><span class="mxinfo " id="T4:U270"><span class="mxinfo " id="T4:U271"><span class="mxinfo " id="T4:U272"><span class="mxinfo " id="T4:U273"><span class="mxinfo " id="T4:U274"><span class="mxinfo " id="T4:U275"><span class="mxinfo " id="T4:U276"><span class="mxinfo " id="T4:U277"><span class="mxinfo " id="T4:U278"><span class="mxinfo " id="T4:U279">12</span>*<span class="var type1" id="S28T4U389">d_p2</span></span>*<span class="var type1" id="S23T4U390">l_2</span></span>*<span class="var type1" id="S41T4U391">x_4</span></span> - <span class="mxinfo " id="T4:U283"><span class="mxinfo " id="T4:U284"><span class="mxinfo " id="T4:U285"><span class="mxinfo " id="T4:U286">12</span>*<span class="var type1" id="S27T4U396">d_p1</span></span>*<span class="var type1" id="S23T4U397">l_2</span></span>*<span class="var type1" id="S39T4U398">x_2</span></span></span> - <span class="mxinfo " id="T4:U290"><span class="mxinfo " id="T4:U291"><span class="mxinfo " id="T4:U292"><span class="mxinfo " id="T4:U293">12</span>*<span class="var type1" id="S28T4U403">d_p2</span></span>*<span class="var type1" id="S23T4U404">l_2</span></span>*<span class="var type1" id="S39T4U405">x_2</span></span></span> - <span class="mxinfo " id="T4:U297"><span class="mxinfo " id="T4:U298">cos(<span class="mxinfo " id="T4:U299"><span class="var type1" id="S38T4U410">x_1</span> - <span class="var type1" id="S40T4U411">x_3</span></span>)</span>*(<span class="mxinfo " id="T4:U302"><span class="mxinfo " id="T4:U303"><span class="mxinfo " id="T4:U304"><span class="mxinfo " id="T4:U305"><span class="mxinfo " id="T4:U306"><span class="mxinfo " id="T4:U307"><span class="mxinfo " id="T4:U308"><span class="mxinfo " id="T4:U309">18</span>*<span class="var type1" id="S28T4U421">d_p2</span></span>*<span class="var type1" id="S22T4U422">l_1</span></span>*<span class="var type1" id="S39T4U423">x_2</span></span> - <span class="mxinfo " id="T4:U313"><span class="mxinfo " id="T4:U314"><span class="mxinfo " id="T4:U315"><span class="mxinfo " id="T4:U316">18</span>*<span class="var type1" id="S28T4U428">d_p2</span></span>*<span class="var type1" id="S22T4U429">l_1</span></span>*<span class="var type1" id="S41T4U430">x_4</span></span></span> + <span class="mxinfo " id="T4:U320"><span class="mxinfo " id="T4:U321"><span class="mxinfo " id="T4:U322"><span class="mxinfo " id="T4:U323"><span class="mxinfo " id="T4:U324"><span class="mxinfo " id="T4:U325">9</span>*<span class="var type1" id="S22T4U437">l_1</span></span>*<span class="var type1" id="S23T4U438">l_2</span></span>*<span class="var type1" id="S25T4U439">m_2</span></span>*<span class="var type1" id="S13T4U440">u</span></span>*<span class="mxinfo " id="T4:U330">cos(<span class="var type1" id="S40T4U443">x_3</span>)</span></span></span> + <span class="mxinfo " id="T4:U332"><span class="mxinfo " id="T4:U333"><span class="mxinfo " id="T4:U334"><span class="mxinfo " id="T4:U335"><span class="mxinfo " id="T4:U336"><span class="mxinfo " id="T4:U337">9</span>*<span class="var type1" id="S21T4U450">g</span></span>*<span class="var type1" id="S22T4U451">l_1</span></span>*<span class="var type1" id="S23T4U452">l_2</span></span>*<span class="var type1" id="S25T4U453">m_2</span></span>*<span class="mxinfo " id="T4:U342">sin(<span class="var type1" id="S40T4U456">x_3</span>)</span></span></span> + <span class="mxinfo " id="T4:U344"><span class="mxinfo " id="T4:U345"><span class="mxinfo " id="T4:U346"><span class="mxinfo " id="T4:U347"><span class="mxinfo " id="T4:U348"><span class="mxinfo " id="T4:U349">9</span>*<span class="mxinfo " id="T4:U350"><span class="var type1" id="S22T4U464">l_1</span>^2</span></span>*<span class="var type1" id="S23T4U466">l_2</span></span>*<span class="var type1" id="S25T4U467">m_2</span></span>*<span class="mxinfo " id="T4:U354"><span class="var type1" id="S39T4U469">x_2</span>^2</span></span>*<span class="mxinfo " id="T4:U356">sin(<span class="mxinfo " id="T4:U357"><span class="var type1" id="S38T4U474">x_1</span> - <span class="var type1" id="S40T4U475">x_3</span></span>)</span></span></span>)</span></span> + <span class="mxinfo " id="T4:U360"><span class="mxinfo " id="T4:U361"><span class="mxinfo " id="T4:U362"><span class="mxinfo " id="T4:U363"><span class="mxinfo " id="T4:U364"><span class="mxinfo " id="T4:U365">6</span>*<span class="var type1" id="S22T4U482">l_1</span></span>*<span class="var type1" id="S23T4U483">l_2</span></span>*<span class="var type1" id="S24T4U484">m_1</span></span>*<span class="var type1" id="S13T4U485">u</span></span>*<span class="mxinfo " id="T4:U370">cos(<span class="var type1" id="S38T4U488">x_1</span>)</span></span></span> + <span class="mxinfo " id="T4:U372"><span class="mxinfo " id="T4:U373"><span class="mxinfo " id="T4:U374"><span class="mxinfo " id="T4:U375"><span class="mxinfo " id="T4:U376"><span class="mxinfo " id="T4:U377">12</span>*<span class="var type1" id="S22T4U495">l_1</span></span>*<span class="var type1" id="S23T4U496">l_2</span></span>*<span class="var type1" id="S25T4U497">m_2</span></span>*<span class="var type1" id="S13T4U498">u</span></span>*<span class="mxinfo " id="T4:U382">cos(<span class="var type1" id="S38T4U501">x_1</span>)</span></span></span> + <span class="mxinfo " id="T4:U384"><span class="mxinfo " id="T4:U385"><span class="mxinfo " id="T4:U386"><span class="mxinfo " id="T4:U387"><span class="mxinfo " id="T4:U388"><span class="mxinfo " id="T4:U389">12</span>*<span class="var type1" id="S22T4U508">l_1</span></span>*<span class="var type1" id="S23T4U509">l_2</span></span>*<span class="var type1" id="S26T4U510">m_3</span></span>*<span class="var type1" id="S13T4U511">u</span></span>*<span class="mxinfo " id="T4:U394">cos(<span class="var type1" id="S38T4U514">x_1</span>)</span></span></span> + <span class="mxinfo " id="T4:U396"><span class="mxinfo " id="T4:U397"><span class="mxinfo " id="T4:U398"><span class="mxinfo " id="T4:U399"><span class="mxinfo " id="T4:U400"><span class="mxinfo " id="T4:U401">6</span>*<span class="var type1" id="S21T4U521">g</span></span>*<span class="var type1" id="S22T4U522">l_1</span></span>*<span class="var type1" id="S23T4U523">l_2</span></span>*<span class="var type1" id="S24T4U524">m_1</span></span>*<span class="mxinfo " id="T4:U406">sin(<span class="var type1" id="S38T4U527">x_1</span>)</span></span></span> + <span class="mxinfo " id="T4:U408"><span class="mxinfo " id="T4:U409"><span class="mxinfo " id="T4:U410"><span class="mxinfo " id="T4:U411"><span class="mxinfo " id="T4:U412"><span class="mxinfo " id="T4:U413">12</span>*<span class="var type1" id="S21T4U534">g</span></span>*<span class="var type1" id="S22T4U535">l_1</span></span>*<span class="var type1" id="S23T4U536">l_2</span></span>*<span class="var type1" id="S25T4U537">m_2</span></span>*<span class="mxinfo " id="T4:U418">sin(<span class="var type1" id="S38T4U540">x_1</span>)</span></span></span> + <span class="mxinfo " id="T4:U420"><span class="mxinfo " id="T4:U421"><span class="mxinfo " id="T4:U422"><span class="mxinfo " id="T4:U423"><span class="mxinfo " id="T4:U424"><span class="mxinfo " id="T4:U425">12</span>*<span class="var type1" id="S21T4U547">g</span></span>*<span class="var type1" id="S22T4U548">l_1</span></span>*<span class="var type1" id="S23T4U549">l_2</span></span>*<span class="var type1" id="S26T4U550">m_3</span></span>*<span class="mxinfo " id="T4:U430">sin(<span class="var type1" id="S38T4U553">x_1</span>)</span></span></span> - <span class="mxinfo " id="T4:U432"><span class="mxinfo " id="T4:U433"><span class="mxinfo " id="T4:U434"><span class="mxinfo " id="T4:U435"><span class="mxinfo " id="T4:U436"><span class="mxinfo " id="T4:U437">6</span>*<span class="var type1" id="S22T4U560">l_1</span></span>*<span class="mxinfo " id="T4:U439"><span class="var type1" id="S23T4U562">l_2</span>^2</span></span>*<span class="var type1" id="S25T4U564">m_2</span></span>*<span class="mxinfo " id="T4:U442"><span class="var type1" id="S41T4U566">x_4</span>^2</span></span>*<span class="mxinfo " id="T4:U444">sin(<span class="mxinfo " id="T4:U445"><span class="var type1" id="S38T4U571">x_1</span> - <span class="var type1" id="S40T4U572">x_3</span></span>)</span></span></span>)</span>)/(<span class="mxinfo " id="T4:U448"><span class="mxinfo " id="T4:U449"><span class="mxinfo " id="T4:U450"><span class="var type1" id="S22T4U577">l_1</span>^2</span>*<span class="var type1" id="S23T4U579">l_2</span></span>*(<span class="mxinfo " id="T4:U453"><span class="mxinfo " id="T4:U454"><span class="mxinfo " id="T4:U455"><span class="mxinfo " id="T4:U456"><span class="mxinfo " id="T4:U457">4</span>*<span class="var type1" id="S24T4U586">m_1</span></span> + <span class="mxinfo " id="T4:U459"><span class="mxinfo " id="T4:U460">12</span>*<span class="var type1" id="S25T4U589">m_2</span></span></span> + <span class="mxinfo " id="T4:U462"><span class="mxinfo " id="T4:U463">12</span>*<span class="var type1" id="S26T4U592">m_3</span></span></span> - <span class="mxinfo " id="T4:U465"><span class="mxinfo " id="T4:U466"><span class="mxinfo " id="T4:U467">9</span>*<span class="var type1" id="S25T4U596">m_2</span></span>*<span class="mxinfo " id="T4:U469"><span class="mxinfo " id="T4:U470">cos(<span class="mxinfo " id="T4:U471"><span class="var type1" id="S38T4U601">x_1</span> - <span class="var type1" id="S40T4U602">x_3</span></span>)</span>^2</span></span></span>)</span>)</span></span>;<span class="mxinfo " id="T4:U474"><span class="var type1" id="S40T4U606">x_3</span> + <span class="mxinfo " id="T4:U476"><span class="var type1" id="S12T4U608">T</span>*<span class="var type1" id="S41T4U609">x_4</span></span></span>;<span class="mxinfo " id="T4:U479"><span class="var type1" id="S41T4U612">x_4</span> + <span class="mxinfo " id="T4:U481">(<span class="mxinfo " id="T4:U482"><span class="var type1" id="S12T4U616">T</span>*(<span class="mxinfo " id="T4:U484"><span class="mxinfo " id="T4:U485"><span class="mxinfo " id="T4:U486"><span class="mxinfo " id="T4:U487"><span class="mxinfo " id="T4:U488"><span class="mxinfo " id="T4:U489"><span class="mxinfo " id="T4:U490"><span class="mxinfo " id="T4:U491"><span class="mxinfo " id="T4:U492"><span class="mxinfo " id="T4:U493"><span class="mxinfo " id="T4:U494"><span class="mxinfo " id="T4:U495"><span class="mxinfo " id="T4:U496"><span class="mxinfo " id="T4:U497"><span class="mxinfo " id="T4:U498"><span class="mxinfo " id="T4:U499"><span class="mxinfo " id="T4:U500"><span class="mxinfo " id="T4:U501"><span class="mxinfo " id="T4:U502"><span class="mxinfo " id="T4:U503"><span class="mxinfo " id="T4:U504"><span class="mxinfo " id="T4:U505"><span class="mxinfo " id="T4:U506"><span class="mxinfo " id="T4:U507">sin(<span class="mxinfo " id="T4:U508"><span class="var type1" id="S38T4U644">x_1</span> - <span class="var type1" id="S40T4U645">x_3</span></span>)</span>*(<span class="mxinfo " id="T4:U511"><span class="mxinfo " id="T4:U512"><span class="mxinfo " id="T4:U513"><span class="mxinfo " id="T4:U514"><span class="mxinfo " id="T4:U515"><span class="mxinfo " id="T4:U516"><span class="mxinfo " id="T4:U517">36</span>*<span class="mxinfo " id="T4:U518"><span class="var type1" id="S22T4U655">l_1</span>^2</span></span>*<span class="var type1" id="S23T4U657">l_2</span></span>*<span class="mxinfo " id="T4:U521"><span class="var type1" id="S25T4U659">m_2</span>^2</span></span>*<span class="mxinfo " id="T4:U523"><span class="var type1" id="S39T4U662">x_2</span>^2</span></span> + <span class="mxinfo " id="T4:U525"><span class="mxinfo " id="T4:U526"><span class="mxinfo " id="T4:U527"><span class="mxinfo " id="T4:U528"><span class="mxinfo " id="T4:U529"><span class="mxinfo " id="T4:U530">12</span>*<span class="mxinfo " id="T4:U531"><span class="var type1" id="S22T4U671">l_1</span>^2</span></span>*<span class="var type1" id="S23T4U673">l_2</span></span>*<span class="var type1" id="S24T4U674">m_1</span></span>*<span class="var type1" id="S25T4U675">m_2</span></span>*<span class="mxinfo " id="T4:U536"><span class="var type1" id="S39T4U677">x_2</span>^2</span></span></span> + <span class="mxinfo " id="T4:U538"><span class="mxinfo " id="T4:U539"><span class="mxinfo " id="T4:U540"><span class="mxinfo " id="T4:U541"><span class="mxinfo " id="T4:U542"><span class="mxinfo " id="T4:U543">36</span>*<span class="mxinfo " id="T4:U544"><span class="var type1" id="S22T4U686">l_1</span>^2</span></span>*<span class="var type1" id="S23T4U688">l_2</span></span>*<span class="var type1" id="S25T4U689">m_2</span></span>*<span class="var type1" id="S26T4U690">m_3</span></span>*<span class="mxinfo " id="T4:U549"><span class="var type1" id="S39T4U692">x_2</span>^2</span></span></span>)</span> + <span class="mxinfo " id="T4:U551"><span class="mxinfo " id="T4:U552"><span class="mxinfo " id="T4:U553"><span class="mxinfo " id="T4:U554"><span class="mxinfo " id="T4:U555">24</span>*<span class="var type1" id="S28T4U699">d_p2</span></span>*<span class="var type1" id="S22T4U700">l_1</span></span>*<span class="var type1" id="S24T4U701">m_1</span></span>*<span class="var type1" id="S39T4U702">x_2</span></span></span> + <span class="mxinfo " id="T4:U560"><span class="mxinfo " id="T4:U561"><span class="mxinfo " id="T4:U562"><span class="mxinfo " id="T4:U563"><span class="mxinfo " id="T4:U564">72</span>*<span class="var type1" id="S28T4U708">d_p2</span></span>*<span class="var type1" id="S22T4U709">l_1</span></span>*<span class="var type1" id="S25T4U710">m_2</span></span>*<span class="var type1" id="S39T4U711">x_2</span></span></span> - <span class="mxinfo " id="T4:U569"><span class="mxinfo " id="T4:U570"><span class="mxinfo " id="T4:U571"><span class="mxinfo " id="T4:U572"><span class="mxinfo " id="T4:U573">24</span>*<span class="var type1" id="S28T4U717">d_p2</span></span>*<span class="var type1" id="S22T4U718">l_1</span></span>*<span class="var type1" id="S24T4U719">m_1</span></span>*<span class="var type1" id="S41T4U720">x_4</span></span></span> + <span class="mxinfo " id="T4:U578"><span class="mxinfo " id="T4:U579"><span class="mxinfo " id="T4:U580"><span class="mxinfo " id="T4:U581"><span class="mxinfo " id="T4:U582">72</span>*<span class="var type1" id="S28T4U726">d_p2</span></span>*<span class="var type1" id="S22T4U727">l_1</span></span>*<span class="var type1" id="S26T4U728">m_3</span></span>*<span class="var type1" id="S39T4U729">x_2</span></span></span> - <span class="mxinfo " id="T4:U587"><span class="mxinfo " id="T4:U588"><span class="mxinfo " id="T4:U589"><span class="mxinfo " id="T4:U590"><span class="mxinfo " id="T4:U591">72</span>*<span class="var type1" id="S28T4U735">d_p2</span></span>*<span class="var type1" id="S22T4U736">l_1</span></span>*<span class="var type1" id="S25T4U737">m_2</span></span>*<span class="var type1" id="S41T4U738">x_4</span></span></span> - <span class="mxinfo " id="T4:U596"><span class="mxinfo " id="T4:U597"><span class="mxinfo " id="T4:U598"><span class="mxinfo " id="T4:U599"><span class="mxinfo " id="T4:U600">72</span>*<span class="var type1" id="S28T4U744">d_p2</span></span>*<span class="var type1" id="S22T4U745">l_1</span></span>*<span class="var type1" id="S26T4U746">m_3</span></span>*<span class="var type1" id="S41T4U747">x_4</span></span></span> + <span class="mxinfo " id="T4:U605"><span class="mxinfo " id="T4:U606"><span class="mxinfo " id="T4:U607"><span class="mxinfo " id="T4:U608"><span class="mxinfo " id="T4:U609"><span class="mxinfo " id="T4:U610">36</span>*<span class="var type1" id="S27T4U754">d_p1</span></span>*<span class="var type1" id="S23T4U755">l_2</span></span>*<span class="var type1" id="S25T4U756">m_2</span></span>*<span class="var type1" id="S39T4U757">x_2</span></span>*<span class="mxinfo " id="T4:U615">cos(<span class="mxinfo " id="T4:U616"><span class="var type1" id="S38T4U761">x_1</span> - <span class="var type1" id="S40T4U762">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T4:U619"><span class="mxinfo " id="T4:U620"><span class="mxinfo " id="T4:U621"><span class="mxinfo " id="T4:U622"><span class="mxinfo " id="T4:U623"><span class="mxinfo " id="T4:U624">36</span>*<span class="var type1" id="S28T4U769">d_p2</span></span>*<span class="var type1" id="S23T4U770">l_2</span></span>*<span class="var type1" id="S25T4U771">m_2</span></span>*<span class="var type1" id="S39T4U772">x_2</span></span>*<span class="mxinfo " id="T4:U629">cos(<span class="mxinfo " id="T4:U630"><span class="var type1" id="S38T4U776">x_1</span> - <span class="var type1" id="S40T4U777">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T4:U633"><span class="mxinfo " id="T4:U634"><span class="mxinfo " id="T4:U635"><span class="mxinfo " id="T4:U636"><span class="mxinfo " id="T4:U637"><span class="mxinfo " id="T4:U638">36</span>*<span class="var type1" id="S28T4U784">d_p2</span></span>*<span class="var type1" id="S23T4U785">l_2</span></span>*<span class="var type1" id="S25T4U786">m_2</span></span>*<span class="var type1" id="S41T4U787">x_4</span></span>*<span class="mxinfo " id="T4:U643">cos(<span class="mxinfo " id="T4:U644"><span class="var type1" id="S38T4U791">x_1</span> - <span class="var type1" id="S40T4U792">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T4:U647"><span class="mxinfo " id="T4:U648"><span class="mxinfo " id="T4:U649"><span class="mxinfo " id="T4:U650"><span class="mxinfo " id="T4:U651"><span class="mxinfo " id="T4:U652">18</span>*<span class="var type1" id="S22T4U799">l_1</span></span>*<span class="var type1" id="S23T4U800">l_2</span></span>*<span class="mxinfo " id="T4:U655"><span class="var type1" id="S25T4U802">m_2</span>^2</span></span>*<span class="var type1" id="S13T4U804">u</span></span>*<span class="mxinfo " id="T4:U658">cos(<span class="var type1" id="S40T4U807">x_3</span>)</span></span></span> + <span class="mxinfo " id="T4:U660"><span class="mxinfo " id="T4:U661"><span class="mxinfo " id="T4:U662"><span class="mxinfo " id="T4:U663"><span class="mxinfo " id="T4:U664"><span class="mxinfo " id="T4:U665">18</span>*<span class="var type1" id="S21T4U814">g</span></span>*<span class="var type1" id="S22T4U815">l_1</span></span>*<span class="var type1" id="S23T4U816">l_2</span></span>*<span class="mxinfo " id="T4:U669"><span class="var type1" id="S25T4U818">m_2</span>^2</span></span>*<span class="mxinfo " id="T4:U671">sin(<span class="var type1" id="S40T4U822">x_3</span>)</span></span></span> + <span class="mxinfo " id="T4:U673"><span class="mxinfo " id="T4:U674"><span class="mxinfo " id="T4:U675"><span class="mxinfo " id="T4:U676"><span class="mxinfo " id="T4:U677"><span class="mxinfo " id="T4:U678">9</span>*<span class="var type1" id="S22T4U829">l_1</span></span>*<span class="mxinfo " id="T4:U680"><span class="var type1" id="S23T4U831">l_2</span>^2</span></span>*<span class="mxinfo " id="T4:U682"><span class="var type1" id="S25T4U834">m_2</span>^2</span></span>*<span class="mxinfo " id="T4:U684"><span class="var type1" id="S41T4U837">x_4</span>^2</span></span>*<span class="mxinfo " id="T4:U686">sin(<span class="mxinfo " id="T4:U687"><span class="mxinfo " id="T4:U688"><span class="mxinfo " id="T4:U689">2</span>*<span class="var type1" id="S38T4U844">x_1</span></span> - <span class="mxinfo " id="T4:U691"><span class="mxinfo " id="T4:U692">2</span>*<span class="var type1" id="S40T4U847">x_3</span></span></span>)</span></span></span> - <span class="mxinfo " id="T4:U694"><span class="mxinfo " id="T4:U695"><span class="mxinfo " id="T4:U696"><span class="mxinfo " id="T4:U697"><span class="mxinfo " id="T4:U698"><span class="mxinfo " id="T4:U699">18</span>*<span class="var type1" id="S22T4U854">l_1</span></span>*<span class="var type1" id="S23T4U855">l_2</span></span>*<span class="mxinfo " id="T4:U702"><span class="var type1" id="S25T4U857">m_2</span>^2</span></span>*<span class="var type1" id="S13T4U859">u</span></span>*<span class="mxinfo " id="T4:U705">cos(<span class="mxinfo " id="T4:U706"><span class="mxinfo " id="T4:U707"><span class="mxinfo " id="T4:U708">2</span>*<span class="var type1" id="S38T4U865">x_1</span></span> - <span class="var type1" id="S40T4U866">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T4:U711"><span class="mxinfo " id="T4:U712"><span class="mxinfo " id="T4:U713"><span class="mxinfo " id="T4:U714"><span class="mxinfo " id="T4:U715"><span class="mxinfo " id="T4:U716">18</span>*<span class="var type1" id="S21T4U873">g</span></span>*<span class="var type1" id="S22T4U874">l_1</span></span>*<span class="var type1" id="S23T4U875">l_2</span></span>*<span class="mxinfo " id="T4:U720"><span class="var type1" id="S25T4U877">m_2</span>^2</span></span>*<span class="mxinfo " id="T4:U722">sin(<span class="mxinfo " id="T4:U723"><span class="mxinfo " id="T4:U724"><span class="mxinfo " id="T4:U725">2</span>*<span class="var type1" id="S38T4U884">x_1</span></span> - <span class="var type1" id="S40T4U885">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T4:U728"><span class="mxinfo " id="T4:U729"><span class="mxinfo " id="T4:U730"><span class="mxinfo " id="T4:U731"><span class="mxinfo " id="T4:U732"><span class="mxinfo " id="T4:U733"><span class="mxinfo " id="T4:U734">3</span>*<span class="var type1" id="S22T4U893">l_1</span></span>*<span class="var type1" id="S23T4U894">l_2</span></span>*<span class="var type1" id="S24T4U895">m_1</span></span>*<span class="var type1" id="S25T4U896">m_2</span></span>*<span class="var type1" id="S13T4U897">u</span></span>*<span class="mxinfo " id="T4:U740">cos(<span class="var type1" id="S40T4U900">x_3</span>)</span></span></span> + <span class="mxinfo " id="T4:U742"><span class="mxinfo " id="T4:U743"><span class="mxinfo " id="T4:U744"><span class="mxinfo " id="T4:U745"><span class="mxinfo " id="T4:U746"><span class="mxinfo " id="T4:U747"><span class="mxinfo " id="T4:U748">18</span>*<span class="var type1" id="S22T4U908">l_1</span></span>*<span class="var type1" id="S23T4U909">l_2</span></span>*<span class="var type1" id="S25T4U910">m_2</span></span>*<span class="var type1" id="S26T4U911">m_3</span></span>*<span class="var type1" id="S13T4U912">u</span></span>*<span class="mxinfo " id="T4:U754">cos(<span class="var type1" id="S40T4U915">x_3</span>)</span></span></span> + <span class="mxinfo " id="T4:U756"><span class="mxinfo " id="T4:U757"><span class="mxinfo " id="T4:U758"><span class="mxinfo " id="T4:U759"><span class="mxinfo " id="T4:U760"><span class="mxinfo " id="T4:U761"><span class="mxinfo " id="T4:U762">3</span>*<span class="var type1" id="S21T4U923">g</span></span>*<span class="var type1" id="S22T4U924">l_1</span></span>*<span class="var type1" id="S23T4U925">l_2</span></span>*<span class="var type1" id="S24T4U926">m_1</span></span>*<span class="var type1" id="S25T4U927">m_2</span></span>*<span class="mxinfo " id="T4:U768">sin(<span class="var type1" id="S40T4U930">x_3</span>)</span></span></span> + <span class="mxinfo " id="T4:U770"><span class="mxinfo " id="T4:U771"><span class="mxinfo " id="T4:U772"><span class="mxinfo " id="T4:U773"><span class="mxinfo " id="T4:U774"><span class="mxinfo " id="T4:U775"><span class="mxinfo " id="T4:U776">18</span>*<span class="var type1" id="S21T4U938">g</span></span>*<span class="var type1" id="S22T4U939">l_1</span></span>*<span class="var type1" id="S23T4U940">l_2</span></span>*<span class="var type1" id="S25T4U941">m_2</span></span>*<span class="var type1" id="S26T4U942">m_3</span></span>*<span class="mxinfo " id="T4:U782">sin(<span class="var type1" id="S40T4U945">x_3</span>)</span></span></span> - <span class="mxinfo " id="T4:U784"><span class="mxinfo " id="T4:U785"><span class="mxinfo " id="T4:U786"><span class="mxinfo " id="T4:U787"><span class="mxinfo " id="T4:U788"><span class="mxinfo " id="T4:U789"><span class="mxinfo " id="T4:U790">9</span>*<span class="var type1" id="S22T4U953">l_1</span></span>*<span class="var type1" id="S23T4U954">l_2</span></span>*<span class="var type1" id="S24T4U955">m_1</span></span>*<span class="var type1" id="S25T4U956">m_2</span></span>*<span class="var type1" id="S13T4U957">u</span></span>*<span class="mxinfo " id="T4:U796">cos(<span class="mxinfo " id="T4:U797"><span class="mxinfo " id="T4:U798"><span class="mxinfo " id="T4:U799">2</span>*<span class="var type1" id="S38T4U963">x_1</span></span> - <span class="var type1" id="S40T4U964">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T4:U802"><span class="mxinfo " id="T4:U803"><span class="mxinfo " id="T4:U804"><span class="mxinfo " id="T4:U805"><span class="mxinfo " id="T4:U806"><span class="mxinfo " id="T4:U807"><span class="mxinfo " id="T4:U808">18</span>*<span class="var type1" id="S22T4U972">l_1</span></span>*<span class="var type1" id="S23T4U973">l_2</span></span>*<span class="var type1" id="S25T4U974">m_2</span></span>*<span class="var type1" id="S26T4U975">m_3</span></span>*<span class="var type1" id="S13T4U976">u</span></span>*<span class="mxinfo " id="T4:U814">cos(<span class="mxinfo " id="T4:U815"><span class="mxinfo " id="T4:U816"><span class="mxinfo " id="T4:U817">2</span>*<span class="var type1" id="S38T4U982">x_1</span></span> - <span class="var type1" id="S40T4U983">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T4:U820"><span class="mxinfo " id="T4:U821"><span class="mxinfo " id="T4:U822"><span class="mxinfo " id="T4:U823"><span class="mxinfo " id="T4:U824"><span class="mxinfo " id="T4:U825"><span class="mxinfo " id="T4:U826">9</span>*<span class="var type1" id="S21T4U991">g</span></span>*<span class="var type1" id="S22T4U992">l_1</span></span>*<span class="var type1" id="S23T4U993">l_2</span></span>*<span class="var type1" id="S24T4U994">m_1</span></span>*<span class="var type1" id="S25T4U995">m_2</span></span>*<span class="mxinfo " id="T4:U832">sin(<span class="mxinfo " id="T4:U833"><span class="mxinfo " id="T4:U834"><span class="mxinfo " id="T4:U835">2</span>*<span class="var type1" id="S38T4U1001">x_1</span></span> - <span class="var type1" id="S40T4U1002">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T4:U838"><span class="mxinfo " id="T4:U839"><span class="mxinfo " id="T4:U840"><span class="mxinfo " id="T4:U841"><span class="mxinfo " id="T4:U842"><span class="mxinfo " id="T4:U843"><span class="mxinfo " id="T4:U844">18</span>*<span class="var type1" id="S21T4U1010">g</span></span>*<span class="var type1" id="S22T4U1011">l_1</span></span>*<span class="var type1" id="S23T4U1012">l_2</span></span>*<span class="var type1" id="S25T4U1013">m_2</span></span>*<span class="var type1" id="S26T4U1014">m_3</span></span>*<span class="mxinfo " id="T4:U850">sin(<span class="mxinfo " id="T4:U851"><span class="mxinfo " id="T4:U852"><span class="mxinfo " id="T4:U853">2</span>*<span class="var type1" id="S38T4U1020">x_1</span></span> - <span class="var type1" id="S40T4U1021">x_3</span></span>)</span></span></span>)</span>)/(<span class="mxinfo " id="T4:U856"><span class="mxinfo " id="T4:U857"><span class="mxinfo " id="T4:U858"><span class="var type1" id="S22T4U1026">l_1</span>*<span class="mxinfo " id="T4:U860"><span class="var type1" id="S23T4U1028">l_2</span>^2</span></span>*<span class="var type1" id="S25T4U1030">m_2</span></span>*(<span class="mxinfo " id="T4:U863"><span class="mxinfo " id="T4:U864"><span class="mxinfo " id="T4:U865"><span class="mxinfo " id="T4:U866"><span class="mxinfo " id="T4:U867">8</span>*<span class="var type1" id="S24T4U1037">m_1</span></span> + <span class="mxinfo " id="T4:U869"><span class="mxinfo " id="T4:U870">15</span>*<span class="var type1" id="S25T4U1040">m_2</span></span></span> + <span class="mxinfo " id="T4:U872"><span class="mxinfo " id="T4:U873">24</span>*<span class="var type1" id="S26T4U1043">m_3</span></span></span> - <span class="mxinfo " id="T4:U875"><span class="mxinfo " id="T4:U876"><span class="mxinfo " id="T4:U877">9</span>*<span class="var type1" id="S25T4U1047">m_2</span></span>*<span class="mxinfo " id="T4:U879">cos(<span class="mxinfo " id="T4:U880"><span class="mxinfo " id="T4:U881"><span class="mxinfo " id="T4:U882">2</span>*<span class="var type1" id="S38T4U1053">x_1</span></span> - <span class="mxinfo " id="T4:U884"><span class="mxinfo " id="T4:U885">2</span>*<span class="var type1" id="S40T4U1056">x_3</span></span></span>)</span></span></span>)</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo " id="T7:U887"><span class="var type1" id="S44T7U1059">y_sig</span>= <span class="mxinfo " id="T7:U889"><span class="mxinfo " id="T12:U890">[1 0 0 0]</span> * <span class="var type1" id="S18T6U1067">x_sig</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">% Prediction, weighted sum</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo " id="T1:U892"><span class="var type1" id="S15T1U1070">x_p</span>  = <span class="mxinfo " id="T1:U894"><span class="var type1" id="S18T6U1072">x_sig</span> * <span class="mxinfo " id="T11:U896"><span class="var type1" id="S19T7U1074">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="mxinfo " id="T4:U898"><span class="var type1" id="S45T4U1077">y_</span>  = <span class="mxinfo " id="T4:U900"><span class="var type1" id="S44T7U1079">y_sig</span> * <span class="mxinfo " id="T11:U902"><span class="var type1" id="S19T7U1081">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">%P_p calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo " id="T2:U904"><span class="var type1" id="S16T2U1084">P_p</span> = <span class="mxinfo " id="T2:U906"><span class="var type1" id="S16T2U1086">P_p</span> .* <span class="mxinfo " id="T4:U908">0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T4U1090">i</span>=<span class="mxinfo " id="T11:U910"><span class="mxinfo " id="T4:U911">1</span>:(2*<span class="var type1" id="S29T4U1097">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo " id="T2:U913"><span class="var type1" id="S16T2U1101">P_p</span> = <span class="mxinfo " id="T2:U915"><span class="var type1" id="S16T2U1103">P_p</span> + (<span class="mxinfo " id="T2:U917"><span class="mxinfo " id="T2:U918">(<span class="mxinfo " id="T1:U919"><span class="mxinfo " id="T1:U920"><span class="var type1" id="S18T6U1110">x_sig</span>(<span class="mxinfo " id="T10:U922">:</span>,<span class="var type1" id="S34T4U1112">i</span>)</span> - <span class="var type1" id="S15T1U1113">x_p</span></span>) * <span class="mxinfo " id="T12:U925">(<span class="mxinfo " id="T1:U926"><span class="mxinfo " id="T1:U927"><span class="var type1" id="S18T6U1118">x_sig</span>(<span class="mxinfo " id="T10:U929">:</span>,<span class="var type1" id="S34T4U1120">i</span>)</span> - <span class="var type1" id="S15T1U1121">x_p</span></span>)'</span></span> .* <span class="mxinfo " id="T4:U932"><span class="var type1" id="S20T7U1123">W_c</span>(<span class="mxinfo " id="T4:U934">1</span>,<span class="var type1" id="S34T4U1125">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="var type0" id="S16T0U1128">P_p</span>  = <span class="message error" id="M1F1C"><span class="var type1" id="S16T2U1130">P_p</span> + <span class="var type1" id="S5T3U1131">Q</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%% Unscented Kalman filter measurement update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">% Pyy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo " id="T4:U938"><span class="var type1" id="S46T4U1134">P_yy</span> = <span class="mxinfo " id="T4:U940">zeros(<span class="var type1" id="S30T4U1137">o_ukf</span>,<span class="var type1" id="S30T4U1138">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T4U1141">i</span>=<span class="mxinfo " id="T11:U944"><span class="mxinfo " id="T4:U945">1</span>:(2*<span class="var type1" id="S29T4U1148">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="mxinfo " id="T4:U947"><span class="var type1" id="S46T4U1152">P_yy</span> = <span class="mxinfo " id="T4:U949"><span class="var type1" id="S46T4U1154">P_yy</span> + (<span class="mxinfo " id="T4:U951"><span class="mxinfo " id="T4:U952">(<span class="mxinfo " id="T4:U953"><span class="mxinfo " id="T4:U954"><span class="var type1" id="S44T7U1161">y_sig</span>(<span class="mxinfo " id="T8:U956">:</span>,<span class="var type1" id="S34T4U1163">i</span>)</span> - <span class="var type1" id="S45T4U1164">y_</span></span>) * (<span class="mxinfo " id="T4:U959"><span class="mxinfo " id="T4:U960"><span class="var type1" id="S44T7U1169">y_sig</span>(<span class="mxinfo " id="T8:U962">:</span>,<span class="var type1" id="S34T4U1171">i</span>)</span> - <span class="var type1" id="S45T4U1172">y_</span></span>)'</span> .* <span class="mxinfo " id="T4:U965"><span class="var type1" id="S20T7U1174">W_c</span>(<span class="mxinfo " id="T4:U967">1</span>,<span class="var type1" id="S34T4U1176">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo " id="T4:U969"><span class="var type1" id="S46T4U1179">P_yy</span> = <span class="mxinfo " id="T4:U971"><span class="var type1" id="S46T4U1181">P_yy</span> + <span class="var type1" id="S6T4U1182">R</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="comment">% Pxy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo " id="T1:U974"><span class="var type1" id="S47T1U1185">P_xy</span> = <span class="mxinfo " id="T1:U976">zeros(<span class="var type1" id="S29T4U1188">n_ukf</span>,<span class="var type1" id="S30T4U1189">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T4U1192">i</span>=<span class="mxinfo " id="T11:U980"><span class="mxinfo " id="T4:U981">1</span>:(2*<span class="var type1" id="S29T4U1199">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="mxinfo " id="T1:U983"><span class="var type1" id="S47T1U1203">P_xy</span> = <span class="mxinfo " id="T1:U985"><span class="var type1" id="S47T1U1205">P_xy</span>+(<span class="mxinfo " id="T1:U987"><span class="mxinfo " id="T1:U988">(<span class="mxinfo " id="T1:U989"><span class="mxinfo " id="T1:U990"><span class="var type1" id="S18T6U1212">x_sig</span>(<span class="mxinfo " id="T10:U992">:</span>,<span class="var type1" id="S34T4U1214">i</span>)</span>-<span class="var type1" id="S15T1U1215">x_p</span></span>)*(<span class="mxinfo " id="T4:U995"><span class="mxinfo " id="T4:U996"><span class="var type1" id="S44T7U1220">y_sig</span>(<span class="mxinfo " id="T8:U998">:</span>,<span class="var type1" id="S34T4U1222">i</span>)</span>-<span class="var type1" id="S45T4U1223">y_</span></span>)'</span>.*<span class="mxinfo " id="T4:U1001"><span class="var type1" id="S20T7U1225">W_c</span>(<span class="mxinfo " id="T4:U1003">1</span>,<span class="var type1" id="S34T4U1227">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="comment">% Kalman Gain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo " id="T1:U1005"><span class="var type1" id="S3T1U1230">K</span>  = <span class="mxinfo " id="T1:U1007"><span class="var type1" id="S47T1U1232">P_xy</span>/(<span class="var type1" id="S46T4U1234">P_yy</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo " id="T2:U1010"><span class="var type1" id="S16T2U1237">P_p</span> = <span class="mxinfo " id="T2:U1012"><span class="var type1" id="S16T2U1239">P_p</span> - (<span class="mxinfo " id="T2:U1014"><span class="mxinfo " id="T1:U1015"><span class="var type1" id="S3T1U1243">K</span> * <span class="var type1" id="S46T4U1244">P_yy</span></span> * <span class="mxinfo " id="T12:U1018"><span class="var type1" id="S3T1U1246">K</span>'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo " id="T1:U1020"><span class="var type1" id="S2T1U1249">x</span>  = <span class="mxinfo " id="T1:U1022"><span class="var type1" id="S15T1U1251">x_p</span> +  <span class="mxinfo " id="T1:U1024"><span class="var type1" id="S3T1U1253">K</span> * ( <span class="mxinfo " id="T4:U1026"><span class="var type1" id="S14T4U1256">y</span> - <span class="var type1" id="S45T4U1257">y_</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo " id="T1:U1029"><span class="var type1" id="S15T1U1260">x_p</span> = <span class="var type1" id="S2T1U1261">x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
