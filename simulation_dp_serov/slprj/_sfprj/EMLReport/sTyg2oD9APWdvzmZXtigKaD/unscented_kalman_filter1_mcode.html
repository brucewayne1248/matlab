<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">x</span>,<span class="mxinfo " id="T1:U2"><span class="var type1" id="S3T1U4"><span class="message error" id="M1F1C">K</span></span></span>] = unscented_kalman_filter(<span class="var type1" id="S4T2U7">P</span>, <span class="var type1" id="S5T2U8">Q</span>, <span class="var type1" id="S6T3U9">R</span>, <span class="var type1" id="S7T1U10">x0</span>, <span class="var type1" id="S8T3U11">alpha_ukf</span>, <span class="var type1" id="S9T3U12">beta_ukf</span>, <span class="var type1" id="S10T3U13">kappa_ukf</span>, <span class="var type1" id="S11T4U14">para_sys</span>, <span class="var type1" id="S12T3U15">T</span>, <span class="var type1" id="S13T3U16">u</span>, <span class="var type1" id="S14T3U17">y</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Unscented Kalman Filter (UKF) fuer nichtlineare Systeme</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% Das UKF praediziert den Zustand eines nichtliniearen Systems durch</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Mittelung sog. Sigma Punkte. Dazu werden 2n+1 Sigmapunkte (moegliche</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Zustaende des Systems) mittels Kovarianzmatrix P berechnet und fuer jeden</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% Sigmapunkt mithilfe der Zustandsgleichung ein neuer Zustand praediziert.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% Diese werden gewichtet gemittelt und mit deren Hilfe die neuen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% Kovarianzmatrizen, die Rueckfuehrmatrix K und die Zustaende ermittelt.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% Weitere Infos unter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% http://www.agnld.uni-potsdam.de/~shw/TSA/Tools/UKF/node4.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% http://cslu.cse.ogi.edu/nsel/ukf/node6.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% Tipp: kappa meist zu 0 waehlen, alpha sehr klein bspw. 0.001, beta bei</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% Gaussverteilung = 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% -alpha bestimmt die Streuung der Sigma-Punkte um den Mittelwert</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% -beta wird benutzt, um Wissen ueber die Verteilung aufzunehmen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">% -kappa ist ein sekundaerer skalierender Parameter, der gewoehnlich </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% gleich 0 oder 3-n gesetzt wird</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% Vorlage von Matthias Dagen, September 2009, veraendert durch David</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% Klinkenbuss</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S15T1U19">x_p</span> <span class="var type1" id="S16T2U20">P_p</span> <span class="var type1" id="S17T5U21">x0_sig</span> <span class="var type1" id="S18T5U22">x_sig</span> <span class="var type1" id="S19T6U23">W_m</span> <span class="var type1" id="S20T6U24">W_c</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">% Parameter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo " id="T3:U20"><span class="var type1" id="S21T3U27">g</span> = <span class="mxinfo " id="T3:U22"><span class="var type1" id="S11T4U29">para_sys</span>(<span class="mxinfo " id="T3:U24">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo " id="T3:U25"><span class="var type1" id="S22T3U33">l_1</span> = <span class="mxinfo " id="T3:U27"><span class="var type1" id="S11T4U35">para_sys</span>(<span class="mxinfo " id="T7:U29">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo " id="T3:U30"><span class="var type1" id="S23T3U39">l_2</span> = <span class="mxinfo " id="T3:U32"><span class="var type1" id="S11T4U41">para_sys</span>(<span class="mxinfo " id="T7:U34">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo " id="T3:U35"><span class="var type1" id="S24T3U45">m_1</span> = <span class="mxinfo " id="T3:U37"><span class="var type1" id="S11T4U47">para_sys</span>(<span class="mxinfo " id="T3:U39">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T3:U40"><span class="var type1" id="S25T3U51">m_2</span> = <span class="mxinfo " id="T3:U42"><span class="var type1" id="S11T4U53">para_sys</span>(<span class="mxinfo " id="T7:U44">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo " id="T3:U45"><span class="var type1" id="S26T3U57">m_3</span> = <span class="mxinfo " id="T3:U47"><span class="var type1" id="S11T4U59">para_sys</span>(<span class="mxinfo " id="T3:U49">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T3:U50"><span class="var type1" id="S27T3U63">d_p1</span> = <span class="mxinfo " id="T3:U52"><span class="var type1" id="S11T4U65">para_sys</span>(<span class="mxinfo " id="T3:U54">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo " id="T3:U55"><span class="var type1" id="S28T3U69">d_p2</span> = <span class="mxinfo " id="T3:U57"><span class="var type1" id="S11T4U71">para_sys</span>(<span class="mxinfo " id="T3:U59">8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T3:U60"><span class="var type1" id="S29T3U75">n_ukf</span>  = <span class="mxinfo " id="T3:U62">4</span></span>;     <span class="comment">% Laenge von f(x)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo " id="T3:U63"><span class="var type1" id="S30T3U79">o_ukf</span> = <span class="mxinfo " id="T3:U65">1</span></span>;      <span class="comment">% Anzahl der zurueckgefuehrten Variablen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U66">isempty(<span class="var type0" id="S15T0U90">x_p</span>)</span> || <span class="mxinfo " id="T8:U67">isempty(<span class="var type0" id="S16T0U93">P_p</span>)</span> || <span class="mxinfo " id="T8:U68">isempty(<span class="var type0" id="S17T0U96">x0_sig</span>)</span> || <span class="mxinfo " id="T8:U69">isempty(<span class="var type0" id="S18T0U99">x_sig</span>)</span> || <span class="mxinfo " id="T8:U70">isempty(<span class="var type0" id="S19T0U102">W_m</span>)</span> || <span class="mxinfo " id="T8:U71">isempty(<span class="var type0" id="S20T0U105">W_c</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo " id="T1:U72"><span class="var type1" id="S15T1U108">x_p</span> = <span class="var type1" id="S7T1U109">x0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo " id="T2:U75"><span class="var type1" id="S16T2U112">P_p</span> = <span class="var type1" id="S4T2U113">P</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T5:U78"><span class="var type1" id="S17T5U116">x0_sig</span> = <span class="mxinfo " id="T5:U80">zeros(<span class="var type1" id="S29T3U119">n_ukf</span>,<span class="mxinfo " id="T3:U82">2*<span class="var type1" id="S29T3U123">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T5:U84"><span class="var type1" id="S18T5U127">x_sig</span>  = <span class="mxinfo " id="T5:U86">zeros(<span class="var type1" id="S29T3U130">n_ukf</span>,<span class="mxinfo " id="T3:U88">2*<span class="var type1" id="S29T3U134">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T6:U90"><span class="var type1" id="S19T6U138">W_m</span> = <span class="mxinfo " id="T6:U92">zeros(<span class="mxinfo " id="T3:U93">1</span>,<span class="mxinfo " id="T3:U94">2*<span class="var type1" id="S29T3U145">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T6:U96"><span class="var type1" id="S20T6U149">W_c</span> = <span class="mxinfo " id="T6:U98">zeros(<span class="mxinfo " id="T3:U99">1</span>,<span class="mxinfo " id="T3:U100">2*<span class="var type1" id="S29T3U156">n_ukf</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T1:U102"><span class="var type1" id="S2T1U160">x</span> = <span class="var type1" id="S15T1U161">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%% Parameter-Initialization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo " id="T3:U105"><span class="var type1" id="S33T3U165">lambda_ukf</span> = <span class="mxinfo " id="T3:U107"><span class="mxinfo " id="T3:U108">(<span class="mxinfo " id="T3:U109"><span class="var type1" id="S8T3U170">alpha_ukf</span>^2</span>)*(<span class="mxinfo " id="T3:U111"><span class="var type1" id="S29T3U174">n_ukf</span>+<span class="var type1" id="S10T3U175">kappa_ukf</span></span>)</span>-<span class="var type1" id="S29T3U176">n_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%% Weight calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo " id="T3:U115"><span class="mxinfo " id="T3:U116"><span class="var type1" id="S19T6U180">W_m</span>(<span class="mxinfo " id="T3:U118">1</span>,<span class="mxinfo " id="T3:U119">1</span>)</span> = <span class="mxinfo " id="T3:U120"><span class="var type1" id="S33T3U184">lambda_ukf</span>/(<span class="mxinfo " id="T3:U122"><span class="var type1" id="S29T3U187">n_ukf</span>+<span class="var type1" id="S33T3U188">lambda_ukf</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T3:U125"><span class="mxinfo " id="T3:U126"><span class="var type1" id="S20T6U192">W_c</span>(<span class="mxinfo " id="T3:U128">1</span>,<span class="mxinfo " id="T3:U129">1</span>)</span> = <span class="mxinfo " id="T3:U130"><span class="mxinfo " id="T3:U131"><span class="mxinfo " id="T3:U132"><span class="mxinfo " id="T3:U133"><span class="var type1" id="S33T3U199">lambda_ukf</span>/(<span class="mxinfo " id="T3:U135"><span class="var type1" id="S29T3U202">n_ukf</span>+<span class="var type1" id="S33T3U203">lambda_ukf</span></span>)</span>+<span class="mxinfo " id="T3:U138">1</span></span>-<span class="mxinfo " id="T3:U139"><span class="var type1" id="S8T3U206">alpha_ukf</span>^2</span></span>+<span class="var type1" id="S9T3U208">beta_ukf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U211">i</span>=<span class="mxinfo " id="T4:U143"><span class="mxinfo " id="T3:U144">2</span>:2*<span class="var type1" id="S29T3U217">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo " id="T3:U146"><span class="mxinfo " id="T3:U147"><span class="var type1" id="S19T6U222">W_m</span>(<span class="mxinfo " id="T3:U149">1</span>,<span class="var type1" id="S34T3U224">i</span>)</span> = <span class="mxinfo " id="T3:U151"><span class="mxinfo " id="T3:U152">1</span>/(<span class="mxinfo " id="T3:U153"><span class="mxinfo " id="T3:U154">2</span>*(<span class="mxinfo " id="T3:U155"><span class="var type1" id="S29T3U232">n_ukf</span>+<span class="var type1" id="S33T3U233">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo " id="T3:U158"><span class="mxinfo " id="T3:U159"><span class="var type1" id="S20T6U237">W_c</span>(<span class="mxinfo " id="T3:U161">1</span>,<span class="var type1" id="S34T3U239">i</span>)</span> = <span class="mxinfo " id="T3:U163"><span class="mxinfo " id="T3:U164">1</span>/(<span class="mxinfo " id="T3:U165"><span class="mxinfo " id="T3:U166">2</span>*(<span class="mxinfo " id="T3:U167"><span class="var type1" id="S29T3U247">n_ukf</span>+<span class="var type1" id="S33T3U248">lambda_ukf</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%% 2n+1 Sigma Points calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo " id="T2:U170"><span class="var type1" id="S35T2U251">P_an</span> = <span class="mxinfo " id="T2:U172">(<span class="mxinfo " id="T2:U173"><span class="mxinfo " id="T3:U174">sqrt(<span class="mxinfo " id="T3:U175"><span class="var type1" id="S29T3U258">n_ukf</span>+<span class="var type1" id="S33T3U259">lambda_ukf</span></span>)</span>.*<span class="mxinfo " id="T2:U178">chol(<span class="var type1" id="S16T2U262">P_p</span>)</span></span>)'</span></span>; <span class="comment">% Wurzelmatrix mittels Cholesky-Zerlegung</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo " id="T1:U180"><span class="mxinfo " id="T1:U181"><span class="var type1" id="S17T5U266">x0_sig</span>(<span class="mxinfo " id="T9:U183">:</span>,<span class="mxinfo " id="T3:U184">1</span>)</span> = <span class="var type1" id="S15T1U269">x_p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U272">i</span>=<span class="mxinfo " id="T1:U187"><span class="mxinfo " id="T3:U188">2</span>:<span class="var type1" id="S29T3U276">n_ukf</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    <span class="mxinfo " id="T1:U190"><span class="mxinfo " id="T1:U191"><span class="var type1" id="S17T5U281">x0_sig</span>(<span class="mxinfo " id="T9:U193">:</span>,<span class="var type1" id="S34T3U283">i</span>)</span>     = <span class="mxinfo " id="T1:U195"><span class="var type1" id="S15T1U285">x_p</span> + <span class="mxinfo " id="T1:U197"><span class="var type1" id="S35T2U287">P_an</span>(<span class="mxinfo " id="T9:U199">:</span>,<span class="mxinfo " id="T3:U200"><span class="var type1" id="S34T3U290">i</span>-<span class="mxinfo " id="T3:U202">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T1:U203"><span class="mxinfo " id="T1:U204"><span class="var type1" id="S17T5U295">x0_sig</span>(<span class="mxinfo " id="T9:U206">:</span>,<span class="mxinfo " id="T3:U207"><span class="var type1" id="S29T3U298">n_ukf</span>+<span class="var type1" id="S34T3U299">i</span></span>)</span>   = <span class="mxinfo " id="T1:U210"><span class="var type1" id="S15T1U301">x_p</span> - <span class="mxinfo " id="T1:U212"><span class="var type1" id="S35T2U303">P_an</span>(<span class="mxinfo " id="T9:U214">:</span>,<span class="mxinfo " id="T3:U215"><span class="var type1" id="S34T3U306">i</span>-<span class="mxinfo " id="T3:U217">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">%% Unscented Kalman filter time update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U310">i</span> = <span class="mxinfo " id="T10:U219"><span class="mxinfo " id="T3:U220">1</span>:(2*<span class="var type1" id="S29T3U317">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"> <span class="mxinfo " id="T3:U222"><span class="var type1" id="S38T3U321">x_1</span> = <span class="mxinfo " id="T3:U224"><span class="var type1" id="S17T5U323">x0_sig</span>(<span class="mxinfo " id="T7:U226">1</span>,<span class="var type1" id="S34T3U325">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"> <span class="mxinfo " id="T3:U228"><span class="var type1" id="S39T3U328">x_2</span> = <span class="mxinfo " id="T3:U230"><span class="var type1" id="S17T5U330">x0_sig</span>(<span class="mxinfo " id="T7:U232">2</span>,<span class="var type1" id="S34T3U332">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"> <span class="mxinfo " id="T3:U234"><span class="var type1" id="S40T3U335">x_3</span> = <span class="mxinfo " id="T3:U236"><span class="var type1" id="S17T5U337">x0_sig</span>(<span class="mxinfo " id="T7:U238">3</span>,<span class="var type1" id="S34T3U339">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"> <span class="mxinfo " id="T3:U240"><span class="var type1" id="S41T3U342">x_4</span> = <span class="mxinfo " id="T3:U242"><span class="var type1" id="S17T5U344">x0_sig</span>(<span class="mxinfo " id="T7:U244">4</span>,<span class="var type1" id="S34T3U346">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo " id="T1:U246"><span class="mxinfo " id="T1:U247"><span class="var type1" id="S18T5U350">x_sig</span>(<span class="mxinfo " id="T9:U249">:</span>,<span class="var type1" id="S34T3U352">i</span>)</span> = <span class="mxinfo " id="T1:U251">[<span class="mxinfo " id="T3:U252"><span class="var type1" id="S38T3U356">x_1</span> + <span class="mxinfo " id="T3:U254"><span class="var type1" id="S12T3U358">T</span>*<span class="var type1" id="S39T3U359">x_2</span></span></span>;<span class="mxinfo " id="T3:U257"><span class="var type1" id="S39T3U362">x_2</span> + <span class="mxinfo " id="T3:U259">(<span class="mxinfo " id="T3:U260"><span class="var type1" id="S12T3U366">T</span>*(<span class="mxinfo " id="T3:U262"><span class="mxinfo " id="T3:U263"><span class="mxinfo " id="T3:U264"><span class="mxinfo " id="T3:U265"><span class="mxinfo " id="T3:U266"><span class="mxinfo " id="T3:U267"><span class="mxinfo " id="T3:U268"><span class="mxinfo " id="T3:U269"><span class="mxinfo " id="T3:U270"><span class="mxinfo " id="T3:U271"><span class="mxinfo " id="T3:U272"><span class="mxinfo " id="T3:U273"><span class="mxinfo " id="T3:U274"><span class="mxinfo " id="T3:U275">12</span>*<span class="var type1" id="S28T3U382">d_p2</span></span>*<span class="var type1" id="S23T3U383">l_2</span></span>*<span class="var type1" id="S41T3U384">x_4</span></span> - <span class="mxinfo " id="T3:U279"><span class="mxinfo " id="T3:U280"><span class="mxinfo " id="T3:U281"><span class="mxinfo " id="T3:U282">12</span>*<span class="var type1" id="S27T3U389">d_p1</span></span>*<span class="var type1" id="S23T3U390">l_2</span></span>*<span class="var type1" id="S39T3U391">x_2</span></span></span> - <span class="mxinfo " id="T3:U286"><span class="mxinfo " id="T3:U287"><span class="mxinfo " id="T3:U288"><span class="mxinfo " id="T3:U289">12</span>*<span class="var type1" id="S28T3U396">d_p2</span></span>*<span class="var type1" id="S23T3U397">l_2</span></span>*<span class="var type1" id="S39T3U398">x_2</span></span></span> - <span class="mxinfo " id="T3:U293"><span class="mxinfo " id="T3:U294">cos(<span class="mxinfo " id="T3:U295"><span class="var type1" id="S38T3U403">x_1</span> - <span class="var type1" id="S40T3U404">x_3</span></span>)</span>*(<span class="mxinfo " id="T3:U298"><span class="mxinfo " id="T3:U299"><span class="mxinfo " id="T3:U300"><span class="mxinfo " id="T3:U301"><span class="mxinfo " id="T3:U302"><span class="mxinfo " id="T3:U303"><span class="mxinfo " id="T3:U304"><span class="mxinfo " id="T3:U305">18</span>*<span class="var type1" id="S28T3U414">d_p2</span></span>*<span class="var type1" id="S22T3U415">l_1</span></span>*<span class="var type1" id="S39T3U416">x_2</span></span> - <span class="mxinfo " id="T3:U309"><span class="mxinfo " id="T3:U310"><span class="mxinfo " id="T3:U311"><span class="mxinfo " id="T3:U312">18</span>*<span class="var type1" id="S28T3U421">d_p2</span></span>*<span class="var type1" id="S22T3U422">l_1</span></span>*<span class="var type1" id="S41T3U423">x_4</span></span></span> + <span class="mxinfo " id="T3:U316"><span class="mxinfo " id="T3:U317"><span class="mxinfo " id="T3:U318"><span class="mxinfo " id="T3:U319"><span class="mxinfo " id="T3:U320"><span class="mxinfo " id="T3:U321">9</span>*<span class="var type1" id="S22T3U430">l_1</span></span>*<span class="var type1" id="S23T3U431">l_2</span></span>*<span class="var type1" id="S25T3U432">m_2</span></span>*<span class="var type1" id="S13T3U433">u</span></span>*<span class="mxinfo " id="T3:U326">cos(<span class="var type1" id="S40T3U436">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U328"><span class="mxinfo " id="T3:U329"><span class="mxinfo " id="T3:U330"><span class="mxinfo " id="T3:U331"><span class="mxinfo " id="T3:U332"><span class="mxinfo " id="T3:U333">9</span>*<span class="var type1" id="S21T3U443">g</span></span>*<span class="var type1" id="S22T3U444">l_1</span></span>*<span class="var type1" id="S23T3U445">l_2</span></span>*<span class="var type1" id="S25T3U446">m_2</span></span>*<span class="mxinfo " id="T3:U338">sin(<span class="var type1" id="S40T3U449">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U340"><span class="mxinfo " id="T3:U341"><span class="mxinfo " id="T3:U342"><span class="mxinfo " id="T3:U343"><span class="mxinfo " id="T3:U344"><span class="mxinfo " id="T3:U345">9</span>*<span class="mxinfo " id="T3:U346"><span class="var type1" id="S22T3U457">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U459">l_2</span></span>*<span class="var type1" id="S25T3U460">m_2</span></span>*<span class="mxinfo " id="T3:U350"><span class="var type1" id="S39T3U462">x_2</span>^2</span></span>*<span class="mxinfo " id="T3:U352">sin(<span class="mxinfo " id="T3:U353"><span class="var type1" id="S38T3U467">x_1</span> - <span class="var type1" id="S40T3U468">x_3</span></span>)</span></span></span>)</span></span> + <span class="mxinfo " id="T3:U356"><span class="mxinfo " id="T3:U357"><span class="mxinfo " id="T3:U358"><span class="mxinfo " id="T3:U359"><span class="mxinfo " id="T3:U360"><span class="mxinfo " id="T3:U361">6</span>*<span class="var type1" id="S22T3U475">l_1</span></span>*<span class="var type1" id="S23T3U476">l_2</span></span>*<span class="var type1" id="S24T3U477">m_1</span></span>*<span class="var type1" id="S13T3U478">u</span></span>*<span class="mxinfo " id="T3:U366">cos(<span class="var type1" id="S38T3U481">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U368"><span class="mxinfo " id="T3:U369"><span class="mxinfo " id="T3:U370"><span class="mxinfo " id="T3:U371"><span class="mxinfo " id="T3:U372"><span class="mxinfo " id="T3:U373">12</span>*<span class="var type1" id="S22T3U488">l_1</span></span>*<span class="var type1" id="S23T3U489">l_2</span></span>*<span class="var type1" id="S25T3U490">m_2</span></span>*<span class="var type1" id="S13T3U491">u</span></span>*<span class="mxinfo " id="T3:U378">cos(<span class="var type1" id="S38T3U494">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U380"><span class="mxinfo " id="T3:U381"><span class="mxinfo " id="T3:U382"><span class="mxinfo " id="T3:U383"><span class="mxinfo " id="T3:U384"><span class="mxinfo " id="T3:U385">12</span>*<span class="var type1" id="S22T3U501">l_1</span></span>*<span class="var type1" id="S23T3U502">l_2</span></span>*<span class="var type1" id="S26T3U503">m_3</span></span>*<span class="var type1" id="S13T3U504">u</span></span>*<span class="mxinfo " id="T3:U390">cos(<span class="var type1" id="S38T3U507">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U392"><span class="mxinfo " id="T3:U393"><span class="mxinfo " id="T3:U394"><span class="mxinfo " id="T3:U395"><span class="mxinfo " id="T3:U396"><span class="mxinfo " id="T3:U397">6</span>*<span class="var type1" id="S21T3U514">g</span></span>*<span class="var type1" id="S22T3U515">l_1</span></span>*<span class="var type1" id="S23T3U516">l_2</span></span>*<span class="var type1" id="S24T3U517">m_1</span></span>*<span class="mxinfo " id="T3:U402">sin(<span class="var type1" id="S38T3U520">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U404"><span class="mxinfo " id="T3:U405"><span class="mxinfo " id="T3:U406"><span class="mxinfo " id="T3:U407"><span class="mxinfo " id="T3:U408"><span class="mxinfo " id="T3:U409">12</span>*<span class="var type1" id="S21T3U527">g</span></span>*<span class="var type1" id="S22T3U528">l_1</span></span>*<span class="var type1" id="S23T3U529">l_2</span></span>*<span class="var type1" id="S25T3U530">m_2</span></span>*<span class="mxinfo " id="T3:U414">sin(<span class="var type1" id="S38T3U533">x_1</span>)</span></span></span> + <span class="mxinfo " id="T3:U416"><span class="mxinfo " id="T3:U417"><span class="mxinfo " id="T3:U418"><span class="mxinfo " id="T3:U419"><span class="mxinfo " id="T3:U420"><span class="mxinfo " id="T3:U421">12</span>*<span class="var type1" id="S21T3U540">g</span></span>*<span class="var type1" id="S22T3U541">l_1</span></span>*<span class="var type1" id="S23T3U542">l_2</span></span>*<span class="var type1" id="S26T3U543">m_3</span></span>*<span class="mxinfo " id="T3:U426">sin(<span class="var type1" id="S38T3U546">x_1</span>)</span></span></span> - <span class="mxinfo " id="T3:U428"><span class="mxinfo " id="T3:U429"><span class="mxinfo " id="T3:U430"><span class="mxinfo " id="T3:U431"><span class="mxinfo " id="T3:U432"><span class="mxinfo " id="T3:U433">6</span>*<span class="var type1" id="S22T3U553">l_1</span></span>*<span class="mxinfo " id="T3:U435"><span class="var type1" id="S23T3U555">l_2</span>^2</span></span>*<span class="var type1" id="S25T3U557">m_2</span></span>*<span class="mxinfo " id="T3:U438"><span class="var type1" id="S41T3U559">x_4</span>^2</span></span>*<span class="mxinfo " id="T3:U440">sin(<span class="mxinfo " id="T3:U441"><span class="var type1" id="S38T3U564">x_1</span> - <span class="var type1" id="S40T3U565">x_3</span></span>)</span></span></span>)</span>)/(<span class="mxinfo " id="T3:U444"><span class="mxinfo " id="T3:U445"><span class="mxinfo " id="T3:U446"><span class="var type1" id="S22T3U570">l_1</span>^2</span>*<span class="var type1" id="S23T3U572">l_2</span></span>*(<span class="mxinfo " id="T3:U449"><span class="mxinfo " id="T3:U450"><span class="mxinfo " id="T3:U451"><span class="mxinfo " id="T3:U452"><span class="mxinfo " id="T3:U453">4</span>*<span class="var type1" id="S24T3U579">m_1</span></span> + <span class="mxinfo " id="T3:U455"><span class="mxinfo " id="T3:U456">12</span>*<span class="var type1" id="S25T3U582">m_2</span></span></span> + <span class="mxinfo " id="T3:U458"><span class="mxinfo " id="T3:U459">12</span>*<span class="var type1" id="S26T3U585">m_3</span></span></span> - <span class="mxinfo " id="T3:U461"><span class="mxinfo " id="T3:U462"><span class="mxinfo " id="T3:U463">9</span>*<span class="var type1" id="S25T3U589">m_2</span></span>*<span class="mxinfo " id="T3:U465"><span class="mxinfo " id="T3:U466">cos(<span class="mxinfo " id="T3:U467"><span class="var type1" id="S38T3U594">x_1</span> - <span class="var type1" id="S40T3U595">x_3</span></span>)</span>^2</span></span></span>)</span>)</span></span>;<span class="mxinfo " id="T3:U470"><span class="var type1" id="S40T3U599">x_3</span> + <span class="mxinfo " id="T3:U472"><span class="var type1" id="S12T3U601">T</span>*<span class="var type1" id="S41T3U602">x_4</span></span></span>;<span class="mxinfo " id="T3:U475"><span class="var type1" id="S41T3U605">x_4</span> + <span class="mxinfo " id="T3:U477">(<span class="mxinfo " id="T3:U478"><span class="var type1" id="S12T3U609">T</span>*(<span class="mxinfo " id="T3:U480"><span class="mxinfo " id="T3:U481"><span class="mxinfo " id="T3:U482"><span class="mxinfo " id="T3:U483"><span class="mxinfo " id="T3:U484"><span class="mxinfo " id="T3:U485"><span class="mxinfo " id="T3:U486"><span class="mxinfo " id="T3:U487"><span class="mxinfo " id="T3:U488"><span class="mxinfo " id="T3:U489"><span class="mxinfo " id="T3:U490"><span class="mxinfo " id="T3:U491"><span class="mxinfo " id="T3:U492"><span class="mxinfo " id="T3:U493"><span class="mxinfo " id="T3:U494"><span class="mxinfo " id="T3:U495"><span class="mxinfo " id="T3:U496"><span class="mxinfo " id="T3:U497"><span class="mxinfo " id="T3:U498"><span class="mxinfo " id="T3:U499"><span class="mxinfo " id="T3:U500"><span class="mxinfo " id="T3:U501"><span class="mxinfo " id="T3:U502"><span class="mxinfo " id="T3:U503">sin(<span class="mxinfo " id="T3:U504"><span class="var type1" id="S38T3U637">x_1</span> - <span class="var type1" id="S40T3U638">x_3</span></span>)</span>*(<span class="mxinfo " id="T3:U507"><span class="mxinfo " id="T3:U508"><span class="mxinfo " id="T3:U509"><span class="mxinfo " id="T3:U510"><span class="mxinfo " id="T3:U511"><span class="mxinfo " id="T3:U512"><span class="mxinfo " id="T3:U513">36</span>*<span class="mxinfo " id="T3:U514"><span class="var type1" id="S22T3U648">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U650">l_2</span></span>*<span class="mxinfo " id="T3:U517"><span class="var type1" id="S25T3U652">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U519"><span class="var type1" id="S39T3U655">x_2</span>^2</span></span> + <span class="mxinfo " id="T3:U521"><span class="mxinfo " id="T3:U522"><span class="mxinfo " id="T3:U523"><span class="mxinfo " id="T3:U524"><span class="mxinfo " id="T3:U525"><span class="mxinfo " id="T3:U526">12</span>*<span class="mxinfo " id="T3:U527"><span class="var type1" id="S22T3U664">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U666">l_2</span></span>*<span class="var type1" id="S24T3U667">m_1</span></span>*<span class="var type1" id="S25T3U668">m_2</span></span>*<span class="mxinfo " id="T3:U532"><span class="var type1" id="S39T3U670">x_2</span>^2</span></span></span> + <span class="mxinfo " id="T3:U534"><span class="mxinfo " id="T3:U535"><span class="mxinfo " id="T3:U536"><span class="mxinfo " id="T3:U537"><span class="mxinfo " id="T3:U538"><span class="mxinfo " id="T3:U539">36</span>*<span class="mxinfo " id="T3:U540"><span class="var type1" id="S22T3U679">l_1</span>^2</span></span>*<span class="var type1" id="S23T3U681">l_2</span></span>*<span class="var type1" id="S25T3U682">m_2</span></span>*<span class="var type1" id="S26T3U683">m_3</span></span>*<span class="mxinfo " id="T3:U545"><span class="var type1" id="S39T3U685">x_2</span>^2</span></span></span>)</span> + <span class="mxinfo " id="T3:U547"><span class="mxinfo " id="T3:U548"><span class="mxinfo " id="T3:U549"><span class="mxinfo " id="T3:U550"><span class="mxinfo " id="T3:U551">24</span>*<span class="var type1" id="S28T3U692">d_p2</span></span>*<span class="var type1" id="S22T3U693">l_1</span></span>*<span class="var type1" id="S24T3U694">m_1</span></span>*<span class="var type1" id="S39T3U695">x_2</span></span></span> + <span class="mxinfo " id="T3:U556"><span class="mxinfo " id="T3:U557"><span class="mxinfo " id="T3:U558"><span class="mxinfo " id="T3:U559"><span class="mxinfo " id="T3:U560">72</span>*<span class="var type1" id="S28T3U701">d_p2</span></span>*<span class="var type1" id="S22T3U702">l_1</span></span>*<span class="var type1" id="S25T3U703">m_2</span></span>*<span class="var type1" id="S39T3U704">x_2</span></span></span> - <span class="mxinfo " id="T3:U565"><span class="mxinfo " id="T3:U566"><span class="mxinfo " id="T3:U567"><span class="mxinfo " id="T3:U568"><span class="mxinfo " id="T3:U569">24</span>*<span class="var type1" id="S28T3U710">d_p2</span></span>*<span class="var type1" id="S22T3U711">l_1</span></span>*<span class="var type1" id="S24T3U712">m_1</span></span>*<span class="var type1" id="S41T3U713">x_4</span></span></span> + <span class="mxinfo " id="T3:U574"><span class="mxinfo " id="T3:U575"><span class="mxinfo " id="T3:U576"><span class="mxinfo " id="T3:U577"><span class="mxinfo " id="T3:U578">72</span>*<span class="var type1" id="S28T3U719">d_p2</span></span>*<span class="var type1" id="S22T3U720">l_1</span></span>*<span class="var type1" id="S26T3U721">m_3</span></span>*<span class="var type1" id="S39T3U722">x_2</span></span></span> - <span class="mxinfo " id="T3:U583"><span class="mxinfo " id="T3:U584"><span class="mxinfo " id="T3:U585"><span class="mxinfo " id="T3:U586"><span class="mxinfo " id="T3:U587">72</span>*<span class="var type1" id="S28T3U728">d_p2</span></span>*<span class="var type1" id="S22T3U729">l_1</span></span>*<span class="var type1" id="S25T3U730">m_2</span></span>*<span class="var type1" id="S41T3U731">x_4</span></span></span> - <span class="mxinfo " id="T3:U592"><span class="mxinfo " id="T3:U593"><span class="mxinfo " id="T3:U594"><span class="mxinfo " id="T3:U595"><span class="mxinfo " id="T3:U596">72</span>*<span class="var type1" id="S28T3U737">d_p2</span></span>*<span class="var type1" id="S22T3U738">l_1</span></span>*<span class="var type1" id="S26T3U739">m_3</span></span>*<span class="var type1" id="S41T3U740">x_4</span></span></span> + <span class="mxinfo " id="T3:U601"><span class="mxinfo " id="T3:U602"><span class="mxinfo " id="T3:U603"><span class="mxinfo " id="T3:U604"><span class="mxinfo " id="T3:U605"><span class="mxinfo " id="T3:U606">36</span>*<span class="var type1" id="S27T3U747">d_p1</span></span>*<span class="var type1" id="S23T3U748">l_2</span></span>*<span class="var type1" id="S25T3U749">m_2</span></span>*<span class="var type1" id="S39T3U750">x_2</span></span>*<span class="mxinfo " id="T3:U611">cos(<span class="mxinfo " id="T3:U612"><span class="var type1" id="S38T3U754">x_1</span> - <span class="var type1" id="S40T3U755">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T3:U615"><span class="mxinfo " id="T3:U616"><span class="mxinfo " id="T3:U617"><span class="mxinfo " id="T3:U618"><span class="mxinfo " id="T3:U619"><span class="mxinfo " id="T3:U620">36</span>*<span class="var type1" id="S28T3U762">d_p2</span></span>*<span class="var type1" id="S23T3U763">l_2</span></span>*<span class="var type1" id="S25T3U764">m_2</span></span>*<span class="var type1" id="S39T3U765">x_2</span></span>*<span class="mxinfo " id="T3:U625">cos(<span class="mxinfo " id="T3:U626"><span class="var type1" id="S38T3U769">x_1</span> - <span class="var type1" id="S40T3U770">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U629"><span class="mxinfo " id="T3:U630"><span class="mxinfo " id="T3:U631"><span class="mxinfo " id="T3:U632"><span class="mxinfo " id="T3:U633"><span class="mxinfo " id="T3:U634">36</span>*<span class="var type1" id="S28T3U777">d_p2</span></span>*<span class="var type1" id="S23T3U778">l_2</span></span>*<span class="var type1" id="S25T3U779">m_2</span></span>*<span class="var type1" id="S41T3U780">x_4</span></span>*<span class="mxinfo " id="T3:U639">cos(<span class="mxinfo " id="T3:U640"><span class="var type1" id="S38T3U784">x_1</span> - <span class="var type1" id="S40T3U785">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T3:U643"><span class="mxinfo " id="T3:U644"><span class="mxinfo " id="T3:U645"><span class="mxinfo " id="T3:U646"><span class="mxinfo " id="T3:U647"><span class="mxinfo " id="T3:U648">18</span>*<span class="var type1" id="S22T3U792">l_1</span></span>*<span class="var type1" id="S23T3U793">l_2</span></span>*<span class="mxinfo " id="T3:U651"><span class="var type1" id="S25T3U795">m_2</span>^2</span></span>*<span class="var type1" id="S13T3U797">u</span></span>*<span class="mxinfo " id="T3:U654">cos(<span class="var type1" id="S40T3U800">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U656"><span class="mxinfo " id="T3:U657"><span class="mxinfo " id="T3:U658"><span class="mxinfo " id="T3:U659"><span class="mxinfo " id="T3:U660"><span class="mxinfo " id="T3:U661">18</span>*<span class="var type1" id="S21T3U807">g</span></span>*<span class="var type1" id="S22T3U808">l_1</span></span>*<span class="var type1" id="S23T3U809">l_2</span></span>*<span class="mxinfo " id="T3:U665"><span class="var type1" id="S25T3U811">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U667">sin(<span class="var type1" id="S40T3U815">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U669"><span class="mxinfo " id="T3:U670"><span class="mxinfo " id="T3:U671"><span class="mxinfo " id="T3:U672"><span class="mxinfo " id="T3:U673"><span class="mxinfo " id="T3:U674">9</span>*<span class="var type1" id="S22T3U822">l_1</span></span>*<span class="mxinfo " id="T3:U676"><span class="var type1" id="S23T3U824">l_2</span>^2</span></span>*<span class="mxinfo " id="T3:U678"><span class="var type1" id="S25T3U827">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U680"><span class="var type1" id="S41T3U830">x_4</span>^2</span></span>*<span class="mxinfo " id="T3:U682">sin(<span class="mxinfo " id="T3:U683"><span class="mxinfo " id="T3:U684"><span class="mxinfo " id="T3:U685">2</span>*<span class="var type1" id="S38T3U837">x_1</span></span> - <span class="mxinfo " id="T3:U687"><span class="mxinfo " id="T3:U688">2</span>*<span class="var type1" id="S40T3U840">x_3</span></span></span>)</span></span></span> - <span class="mxinfo " id="T3:U690"><span class="mxinfo " id="T3:U691"><span class="mxinfo " id="T3:U692"><span class="mxinfo " id="T3:U693"><span class="mxinfo " id="T3:U694"><span class="mxinfo " id="T3:U695">18</span>*<span class="var type1" id="S22T3U847">l_1</span></span>*<span class="var type1" id="S23T3U848">l_2</span></span>*<span class="mxinfo " id="T3:U698"><span class="var type1" id="S25T3U850">m_2</span>^2</span></span>*<span class="var type1" id="S13T3U852">u</span></span>*<span class="mxinfo " id="T3:U701">cos(<span class="mxinfo " id="T3:U702"><span class="mxinfo " id="T3:U703"><span class="mxinfo " id="T3:U704">2</span>*<span class="var type1" id="S38T3U858">x_1</span></span> - <span class="var type1" id="S40T3U859">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U707"><span class="mxinfo " id="T3:U708"><span class="mxinfo " id="T3:U709"><span class="mxinfo " id="T3:U710"><span class="mxinfo " id="T3:U711"><span class="mxinfo " id="T3:U712">18</span>*<span class="var type1" id="S21T3U866">g</span></span>*<span class="var type1" id="S22T3U867">l_1</span></span>*<span class="var type1" id="S23T3U868">l_2</span></span>*<span class="mxinfo " id="T3:U716"><span class="var type1" id="S25T3U870">m_2</span>^2</span></span>*<span class="mxinfo " id="T3:U718">sin(<span class="mxinfo " id="T3:U719"><span class="mxinfo " id="T3:U720"><span class="mxinfo " id="T3:U721">2</span>*<span class="var type1" id="S38T3U877">x_1</span></span> - <span class="var type1" id="S40T3U878">x_3</span></span>)</span></span></span> + <span class="mxinfo " id="T3:U724"><span class="mxinfo " id="T3:U725"><span class="mxinfo " id="T3:U726"><span class="mxinfo " id="T3:U727"><span class="mxinfo " id="T3:U728"><span class="mxinfo " id="T3:U729"><span class="mxinfo " id="T3:U730">3</span>*<span class="var type1" id="S22T3U886">l_1</span></span>*<span class="var type1" id="S23T3U887">l_2</span></span>*<span class="var type1" id="S24T3U888">m_1</span></span>*<span class="var type1" id="S25T3U889">m_2</span></span>*<span class="var type1" id="S13T3U890">u</span></span>*<span class="mxinfo " id="T3:U736">cos(<span class="var type1" id="S40T3U893">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U738"><span class="mxinfo " id="T3:U739"><span class="mxinfo " id="T3:U740"><span class="mxinfo " id="T3:U741"><span class="mxinfo " id="T3:U742"><span class="mxinfo " id="T3:U743"><span class="mxinfo " id="T3:U744">18</span>*<span class="var type1" id="S22T3U901">l_1</span></span>*<span class="var type1" id="S23T3U902">l_2</span></span>*<span class="var type1" id="S25T3U903">m_2</span></span>*<span class="var type1" id="S26T3U904">m_3</span></span>*<span class="var type1" id="S13T3U905">u</span></span>*<span class="mxinfo " id="T3:U750">cos(<span class="var type1" id="S40T3U908">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U752"><span class="mxinfo " id="T3:U753"><span class="mxinfo " id="T3:U754"><span class="mxinfo " id="T3:U755"><span class="mxinfo " id="T3:U756"><span class="mxinfo " id="T3:U757"><span class="mxinfo " id="T3:U758">3</span>*<span class="var type1" id="S21T3U916">g</span></span>*<span class="var type1" id="S22T3U917">l_1</span></span>*<span class="var type1" id="S23T3U918">l_2</span></span>*<span class="var type1" id="S24T3U919">m_1</span></span>*<span class="var type1" id="S25T3U920">m_2</span></span>*<span class="mxinfo " id="T3:U764">sin(<span class="var type1" id="S40T3U923">x_3</span>)</span></span></span> + <span class="mxinfo " id="T3:U766"><span class="mxinfo " id="T3:U767"><span class="mxinfo " id="T3:U768"><span class="mxinfo " id="T3:U769"><span class="mxinfo " id="T3:U770"><span class="mxinfo " id="T3:U771"><span class="mxinfo " id="T3:U772">18</span>*<span class="var type1" id="S21T3U931">g</span></span>*<span class="var type1" id="S22T3U932">l_1</span></span>*<span class="var type1" id="S23T3U933">l_2</span></span>*<span class="var type1" id="S25T3U934">m_2</span></span>*<span class="var type1" id="S26T3U935">m_3</span></span>*<span class="mxinfo " id="T3:U778">sin(<span class="var type1" id="S40T3U938">x_3</span>)</span></span></span> - <span class="mxinfo " id="T3:U780"><span class="mxinfo " id="T3:U781"><span class="mxinfo " id="T3:U782"><span class="mxinfo " id="T3:U783"><span class="mxinfo " id="T3:U784"><span class="mxinfo " id="T3:U785"><span class="mxinfo " id="T3:U786">9</span>*<span class="var type1" id="S22T3U946">l_1</span></span>*<span class="var type1" id="S23T3U947">l_2</span></span>*<span class="var type1" id="S24T3U948">m_1</span></span>*<span class="var type1" id="S25T3U949">m_2</span></span>*<span class="var type1" id="S13T3U950">u</span></span>*<span class="mxinfo " id="T3:U792">cos(<span class="mxinfo " id="T3:U793"><span class="mxinfo " id="T3:U794"><span class="mxinfo " id="T3:U795">2</span>*<span class="var type1" id="S38T3U956">x_1</span></span> - <span class="var type1" id="S40T3U957">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U798"><span class="mxinfo " id="T3:U799"><span class="mxinfo " id="T3:U800"><span class="mxinfo " id="T3:U801"><span class="mxinfo " id="T3:U802"><span class="mxinfo " id="T3:U803"><span class="mxinfo " id="T3:U804">18</span>*<span class="var type1" id="S22T3U965">l_1</span></span>*<span class="var type1" id="S23T3U966">l_2</span></span>*<span class="var type1" id="S25T3U967">m_2</span></span>*<span class="var type1" id="S26T3U968">m_3</span></span>*<span class="var type1" id="S13T3U969">u</span></span>*<span class="mxinfo " id="T3:U810">cos(<span class="mxinfo " id="T3:U811"><span class="mxinfo " id="T3:U812"><span class="mxinfo " id="T3:U813">2</span>*<span class="var type1" id="S38T3U975">x_1</span></span> - <span class="var type1" id="S40T3U976">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U816"><span class="mxinfo " id="T3:U817"><span class="mxinfo " id="T3:U818"><span class="mxinfo " id="T3:U819"><span class="mxinfo " id="T3:U820"><span class="mxinfo " id="T3:U821"><span class="mxinfo " id="T3:U822">9</span>*<span class="var type1" id="S21T3U984">g</span></span>*<span class="var type1" id="S22T3U985">l_1</span></span>*<span class="var type1" id="S23T3U986">l_2</span></span>*<span class="var type1" id="S24T3U987">m_1</span></span>*<span class="var type1" id="S25T3U988">m_2</span></span>*<span class="mxinfo " id="T3:U828">sin(<span class="mxinfo " id="T3:U829"><span class="mxinfo " id="T3:U830"><span class="mxinfo " id="T3:U831">2</span>*<span class="var type1" id="S38T3U994">x_1</span></span> - <span class="var type1" id="S40T3U995">x_3</span></span>)</span></span></span> - <span class="mxinfo " id="T3:U834"><span class="mxinfo " id="T3:U835"><span class="mxinfo " id="T3:U836"><span class="mxinfo " id="T3:U837"><span class="mxinfo " id="T3:U838"><span class="mxinfo " id="T3:U839"><span class="mxinfo " id="T3:U840">18</span>*<span class="var type1" id="S21T3U1003">g</span></span>*<span class="var type1" id="S22T3U1004">l_1</span></span>*<span class="var type1" id="S23T3U1005">l_2</span></span>*<span class="var type1" id="S25T3U1006">m_2</span></span>*<span class="var type1" id="S26T3U1007">m_3</span></span>*<span class="mxinfo " id="T3:U846">sin(<span class="mxinfo " id="T3:U847"><span class="mxinfo " id="T3:U848"><span class="mxinfo " id="T3:U849">2</span>*<span class="var type1" id="S38T3U1013">x_1</span></span> - <span class="var type1" id="S40T3U1014">x_3</span></span>)</span></span></span>)</span>)/(<span class="mxinfo " id="T3:U852"><span class="mxinfo " id="T3:U853"><span class="mxinfo " id="T3:U854"><span class="var type1" id="S22T3U1019">l_1</span>*<span class="mxinfo " id="T3:U856"><span class="var type1" id="S23T3U1021">l_2</span>^2</span></span>*<span class="var type1" id="S25T3U1023">m_2</span></span>*(<span class="mxinfo " id="T3:U859"><span class="mxinfo " id="T3:U860"><span class="mxinfo " id="T3:U861"><span class="mxinfo " id="T3:U862"><span class="mxinfo " id="T3:U863">8</span>*<span class="var type1" id="S24T3U1030">m_1</span></span> + <span class="mxinfo " id="T3:U865"><span class="mxinfo " id="T3:U866">15</span>*<span class="var type1" id="S25T3U1033">m_2</span></span></span> + <span class="mxinfo " id="T3:U868"><span class="mxinfo " id="T3:U869">24</span>*<span class="var type1" id="S26T3U1036">m_3</span></span></span> - <span class="mxinfo " id="T3:U871"><span class="mxinfo " id="T3:U872"><span class="mxinfo " id="T3:U873">9</span>*<span class="var type1" id="S25T3U1040">m_2</span></span>*<span class="mxinfo " id="T3:U875">cos(<span class="mxinfo " id="T3:U876"><span class="mxinfo " id="T3:U877"><span class="mxinfo " id="T3:U878">2</span>*<span class="var type1" id="S38T3U1046">x_1</span></span> - <span class="mxinfo " id="T3:U880"><span class="mxinfo " id="T3:U881">2</span>*<span class="var type1" id="S40T3U1049">x_3</span></span></span>)</span></span></span>)</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo " id="T6:U883"><span class="var type1" id="S44T6U1052">y_sig</span>= <span class="mxinfo " id="T6:U885"><span class="mxinfo " id="T11:U886">[1 0 0 0]</span> * <span class="var type1" id="S18T5U1060">x_sig</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">% Prediction, weighted sum</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo " id="T1:U888"><span class="var type1" id="S15T1U1063">x_p</span>  = <span class="mxinfo " id="T1:U890"><span class="var type1" id="S18T5U1065">x_sig</span> * <span class="mxinfo " id="T10:U892"><span class="var type1" id="S19T6U1067">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo " id="T3:U894"><span class="var type1" id="S45T3U1070">y_</span>  = <span class="mxinfo " id="T3:U896"><span class="var type1" id="S44T6U1072">y_sig</span> * <span class="mxinfo " id="T10:U898"><span class="var type1" id="S19T6U1074">W_m</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">%P_p calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo " id="T2:U900"><span class="var type1" id="S16T2U1077">P_p</span> = <span class="mxinfo " id="T2:U902"><span class="var type1" id="S16T2U1079">P_p</span> .* <span class="mxinfo " id="T3:U904">0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1083">i</span>=<span class="mxinfo " id="T10:U906"><span class="mxinfo " id="T3:U907">1</span>:(2*<span class="var type1" id="S29T3U1090">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">    <span class="mxinfo " id="T2:U909"><span class="var type1" id="S16T2U1094">P_p</span> = <span class="mxinfo " id="T2:U911"><span class="var type1" id="S16T2U1096">P_p</span> + (<span class="mxinfo " id="T2:U913"><span class="mxinfo " id="T2:U914">(<span class="mxinfo " id="T1:U915"><span class="mxinfo " id="T1:U916"><span class="var type1" id="S18T5U1103">x_sig</span>(<span class="mxinfo " id="T9:U918">:</span>,<span class="var type1" id="S34T3U1105">i</span>)</span> - <span class="var type1" id="S15T1U1106">x_p</span></span>) * <span class="mxinfo " id="T11:U921">(<span class="mxinfo " id="T1:U922"><span class="mxinfo " id="T1:U923"><span class="var type1" id="S18T5U1111">x_sig</span>(<span class="mxinfo " id="T9:U925">:</span>,<span class="var type1" id="S34T3U1113">i</span>)</span> - <span class="var type1" id="S15T1U1114">x_p</span></span>)'</span></span> .* <span class="mxinfo " id="T3:U928"><span class="var type1" id="S20T6U1116">W_c</span>(<span class="mxinfo " id="T3:U930">1</span>,<span class="var type1" id="S34T3U1118">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo " id="T2:U932"><span class="var type1" id="S16T2U1121">P_p</span>  = <span class="mxinfo " id="T2:U934"><span class="var type1" id="S16T2U1123">P_p</span> + <span class="var type1" id="S5T2U1124">Q</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">%% Unscented Kalman filter measurement update equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">% Pyy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="mxinfo " id="T3:U937"><span class="var type1" id="S46T3U1127">P_yy</span> = <span class="mxinfo " id="T3:U939">zeros(<span class="var type1" id="S30T3U1130">o_ukf</span>,<span class="var type1" id="S30T3U1131">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1134">i</span>=<span class="mxinfo " id="T10:U943"><span class="mxinfo " id="T3:U944">1</span>:(2*<span class="var type1" id="S29T3U1141">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo " id="T3:U946"><span class="var type1" id="S46T3U1145">P_yy</span> = <span class="mxinfo " id="T3:U948"><span class="var type1" id="S46T3U1147">P_yy</span> + (<span class="mxinfo " id="T3:U950"><span class="mxinfo " id="T3:U951">(<span class="mxinfo " id="T3:U952"><span class="mxinfo " id="T3:U953"><span class="var type1" id="S44T6U1154">y_sig</span>(<span class="mxinfo " id="T7:U955">:</span>,<span class="var type1" id="S34T3U1156">i</span>)</span> - <span class="var type1" id="S45T3U1157">y_</span></span>) * (<span class="mxinfo " id="T3:U958"><span class="mxinfo " id="T3:U959"><span class="var type1" id="S44T6U1162">y_sig</span>(<span class="mxinfo " id="T7:U961">:</span>,<span class="var type1" id="S34T3U1164">i</span>)</span> - <span class="var type1" id="S45T3U1165">y_</span></span>)'</span> .* <span class="mxinfo " id="T3:U964"><span class="var type1" id="S20T6U1167">W_c</span>(<span class="mxinfo " id="T3:U966">1</span>,<span class="var type1" id="S34T3U1169">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="mxinfo " id="T3:U968"><span class="var type1" id="S46T3U1172">P_yy</span> = <span class="mxinfo " id="T3:U970"><span class="var type1" id="S46T3U1174">P_yy</span> + <span class="var type1" id="S6T3U1175">R</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">% Pxy calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo " id="T1:U973"><span class="var type1" id="S47T1U1178">P_xy</span> = <span class="mxinfo " id="T1:U975">zeros(<span class="var type1" id="S29T3U1181">n_ukf</span>,<span class="var type1" id="S30T3U1182">o_ukf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S34T3U1185">i</span>=<span class="mxinfo " id="T10:U979"><span class="mxinfo " id="T3:U980">1</span>:(2*<span class="var type1" id="S29T3U1192">n_ukf</span>+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    <span class="mxinfo " id="T1:U982"><span class="var type1" id="S47T1U1196">P_xy</span> = <span class="mxinfo " id="T1:U984"><span class="var type1" id="S47T1U1198">P_xy</span>+(<span class="mxinfo " id="T1:U986"><span class="mxinfo " id="T1:U987">(<span class="mxinfo " id="T1:U988"><span class="mxinfo " id="T1:U989"><span class="var type1" id="S18T5U1205">x_sig</span>(<span class="mxinfo " id="T9:U991">:</span>,<span class="var type1" id="S34T3U1207">i</span>)</span>-<span class="var type1" id="S15T1U1208">x_p</span></span>)*(<span class="mxinfo " id="T3:U994"><span class="mxinfo " id="T3:U995"><span class="var type1" id="S44T6U1213">y_sig</span>(<span class="mxinfo " id="T7:U997">:</span>,<span class="var type1" id="S34T3U1215">i</span>)</span>-<span class="var type1" id="S45T3U1216">y_</span></span>)'</span>.*<span class="mxinfo " id="T3:U1000"><span class="var type1" id="S20T6U1218">W_c</span>(<span class="mxinfo " id="T3:U1002">1</span>,<span class="var type1" id="S34T3U1220">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="comment">% Kalman Gain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo " id="T1:U1004"><span class="var type1" id="S3T1U1223">K</span>  = <span class="mxinfo " id="T1:U1006"><span class="var type1" id="S47T1U1225">P_xy</span>/(<span class="var type1" id="S46T3U1227">P_yy</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo " id="T2:U1009"><span class="var type1" id="S16T2U1230">P_p</span> = <span class="mxinfo " id="T2:U1011"><span class="var type1" id="S16T2U1232">P_p</span> - (<span class="mxinfo " id="T2:U1013"><span class="mxinfo " id="T1:U1014"><span class="var type1" id="S3T1U1236">K</span> * <span class="var type1" id="S46T3U1237">P_yy</span></span> * <span class="mxinfo " id="T11:U1017"><span class="var type1" id="S3T1U1239">K</span>'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo " id="T1:U1019"><span class="var type1" id="S2T1U1242">x</span>  = <span class="mxinfo " id="T1:U1021"><span class="var type1" id="S15T1U1244">x_p</span> +  <span class="mxinfo " id="T1:U1023"><span class="var type1" id="S3T1U1246">K</span> * ( <span class="mxinfo " id="T3:U1025"><span class="var type1" id="S14T3U1249">y</span> - <span class="var type1" id="S45T3U1250">y_</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo " id="T1:U1028"><span class="var type1" id="S15T1U1253">x_p</span> = <span class="var type1" id="S2T1U1254">x</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
